/**
 * Bundled by jsDelivr using Rollup v2.79.1 and Terser v5.19.2.
 * Original file: /npm/@observablehq/plot@0.6.15/src/index.js
 *
 * Do NOT use SRI with dynamically generated files! More information: https://www.jsdelivr.com/using-sri-with-dynamic-files
 */
import{ascending as t,descending as n,timeSecond as e,timeMinute as r,timeHour as o,timeDay as i,timeMonday as a,timeTuesday as l,timeWednesday as s,timeThursday as c,timeFriday as u,timeSaturday as f,timeSunday as h,timeWeek as d,timeMonth as p,timeYear as m,utcSecond as y,utcMinute as g,utcHour as v,unixDay as x,utcMonday as w,utcTuesday as b,utcWednesday as k,utcThursday as $,utcFriday as M,utcSaturday as L,utcSunday as A,utcWeek as E,utcMonth as z,utcYear as O,bisector as S,max as N,pairs as C,timeFormat as T,utcFormat as R,range as I,quantile as W,symbolAsterisk as j,symbolCircle as B,symbolCross as F,symbolDiamond as D,symbolDiamond2 as q,symbolPlus as _,symbolSquare as P,symbolSquare2 as V,symbolStar as H,symbolTimes as Y,symbolTriangle as U,symbolTriangle2 as X,symbolWye as G,randomLcg as Z,group as J,sort as K,rollup as Q,sum as tt,InternSet as nt,mode as et,variance as rt,median as ot,mean as at,maxIndex as lt,minIndex as st,min as ct,deviation as ut,rollups as ft,quantize as ht,schemeAccent as dt,schemeCategory10 as pt,schemeDark2 as mt,schemeObservable10 as yt,schemePaired as gt,schemePastel1 as vt,schemePastel2 as xt,schemeSet1 as wt,schemeSet2 as bt,schemeSet3 as kt,schemeTableau10 as $t,interpolateBrBG as Mt,schemeBrBG as Lt,interpolatePRGn as At,schemePRGn as Et,interpolatePiYG as zt,schemePiYG as Ot,interpolatePuOr as St,schemePuOr as Nt,interpolateRdBu as Ct,schemeRdBu as Tt,interpolateRdGy as Rt,schemeRdGy as It,interpolateRdYlBu as Wt,schemeRdYlBu as jt,interpolateRdYlGn as Bt,schemeRdYlGn as Ft,interpolateSpectral as Dt,schemeSpectral as qt,interpolateBlues as _t,schemeBlues as Pt,interpolateGreens as Vt,schemeGreens as Ht,interpolateGreys as Yt,schemeGreys as Ut,interpolateOranges as Xt,schemeOranges as Gt,interpolatePurples as Zt,schemePurples as Jt,interpolateReds as Kt,schemeReds as Qt,interpolateTurbo as tn,interpolateViridis as nn,interpolateMagma as en,interpolateInferno as rn,interpolatePlasma as on,interpolateCividis as an,interpolateCubehelixDefault as ln,interpolateWarm as sn,interpolateCool as cn,interpolateBuGn as un,schemeBuGn as fn,interpolateBuPu as hn,schemeBuPu as dn,interpolateGnBu as pn,schemeGnBu as mn,interpolateOrRd as yn,schemeOrRd as gn,interpolatePuBu as vn,schemePuBu as xn,interpolatePuBuGn as wn,schemePuBuGn as bn,interpolatePuRd as kn,schemePuRd as $n,interpolateRdPu as Mn,schemeRdPu as Ln,interpolateYlGn as An,schemeYlGn as En,interpolateYlGnBu as zn,schemeYlGnBu as On,interpolateYlOrBr as Sn,schemeYlOrBr as Nn,interpolateYlOrRd as Cn,schemeYlOrRd as Tn,interpolateRainbow as Rn,interpolateSinebow as In,scaleLinear as Wn,scalePow as jn,scaleLog as Bn,scaleSymlog as Fn,scaleQuantile as Dn,extent as qn,ticks as _n,interpolateNumber as Pn,reverse as Vn,scaleThreshold as Hn,scaleIdentity as Yn,piecewise as Un,interpolateRgb as Xn,interpolateRound as Gn,interpolateHsl as Zn,interpolateHcl as Jn,interpolateLab as Kn,scaleDiverging as Qn,scaleDivergingPow as te,scaleDivergingLog as ne,scaleDivergingSymlog as ee,scaleTime as re,scaleUtc as oe,scaleImplicit as ie,scaleOrdinal as ae,scalePoint as le,scaleBand as se,symbolsStroke as ce,symbolsFill as ue,cross as fe,InternMap as he,geoTransform as de,geoPath as pe,geoClipRectangle as me,geoStream as ye,geoTransverseMercator as ge,geoStereographic as ve,geoOrthographic as xe,geoMercator as we,geoGnomonic as be,geoEquirectangular as ke,geoEqualEarth as $e,geoAzimuthalEquidistant as Me,geoAzimuthalEqualArea as Le,geoAlbersUsa as Ae,geoConicEquidistant as Ee,geoConicEqualArea as ze,geoConicConformal as Oe,geoAlbers as Se,select as Ne,creator as Ce,namespaces as Te,pointer as Re,format as Ie,axisBottom as We,pathRound as je,rgb as Be,curveLinear as Fe,curveBasis as De,curveBasisClosed as qe,curveBasisOpen as _e,curveBundle as Pe,curveBumpX as Ve,curveBumpY as He,curveCardinal as Ye,curveCardinalClosed as Ue,curveCardinalOpen as Xe,curveCatmullRom as Ge,curveCatmullRomClosed as Ze,curveCatmullRomOpen as Je,curveLinearClosed as Ke,curveMonotoneX as Qe,curveMonotoneY as tr,curveNatural as nr,curveStep as er,curveStepAfter as rr,curveStepBefore as or,thresholdSturges as ir,thresholdScott as ar,thresholdFreedmanDiaconis as lr,utcTickInterval as sr,tickIncrement as cr,bisect as ur,cumsum as fr,groupSort as hr,greatest as dr,area as pr,line as mr,rank as yr,count as gr,blurImage as vr,Delaunay as xr,blur2 as wr,contours as br,nice as kr,contourDensity as $r,geoGraticule10 as Mr,stratify as Lr,tree as Ar,cluster as Er,geoCentroid as zr,least as Or}from"../../d3@7.9.0/_esm.js";import{parse as Sr,format as Nr}from"../../isoformat@0.2.1/_esm.js";import Cr from"../../interval-tree-1d@1.0.4/_esm.js";function Tr(t){return null!=t&&!Number.isNaN(t)}function Rr(n,e){return+Tr(e)-+Tr(n)||t(n,e)}function Ir(t,e){return+Tr(e)-+Tr(t)||n(t,e)}function Wr(t){return null!=t&&""!=`${t}`}function jr(t){return isFinite(t)?t:NaN}function Br(t){return t>0&&isFinite(t)?t:NaN}function Fr(t){return t<0&&isFinite(t)?t:NaN}function Dr(t){if(null==t)return;const e=t[0],r=t[t.length-1];return n(e,r)}const qr=1e3,_r=6e4,Pr=36e5,Vr=864e5,Hr=7*Vr,Yr=30*Vr,Ur=365*Vr,Xr=[["millisecond",1],["2 milliseconds",2],["5 milliseconds",5],["10 milliseconds",10],["20 milliseconds",20],["50 milliseconds",50],["100 milliseconds",100],["200 milliseconds",200],["500 milliseconds",500],["second",qr],["5 seconds",5e3],["15 seconds",15e3],["30 seconds",3e4],["minute",_r],["5 minutes",3e5],["15 minutes",9e5],["30 minutes",18e5],["hour",Pr],["3 hours",108e5],["6 hours",216e5],["12 hours",432e5],["day",Vr],["2 days",2*Vr],["week",Hr],["2 weeks",2*Hr],["month",Yr],["3 months",3*Yr],["6 months",6*Yr],["year",Ur],["2 years",2*Ur],["5 years",5*Ur],["10 years",10*Ur],["20 years",20*Ur],["50 years",50*Ur],["100 years",100*Ur]],Gr=new Map([["second",qr],["minute",_r],["hour",Pr],["day",Vr],["monday",Hr],["tuesday",Hr],["wednesday",Hr],["thursday",Hr],["friday",Hr],["saturday",Hr],["sunday",Hr],["week",Hr],["month",Yr],["year",Ur]]),Zr=new Map([["second",e],["minute",r],["hour",o],["day",i],["monday",a],["tuesday",l],["wednesday",s],["thursday",c],["friday",u],["saturday",f],["sunday",h],["week",d],["month",p],["year",m]]),Jr=new Map([["second",y],["minute",g],["hour",v],["day",x],["monday",w],["tuesday",b],["wednesday",k],["thursday",$],["friday",M],["saturday",L],["sunday",A],["week",E],["month",z],["year",O]]),Kr=Symbol("intervalDuration"),Qr=Symbol("intervalType");for(const[t,n]of Zr)n[Kr]=Gr.get(t),n[Qr]="time";for(const[t,n]of Jr)n[Kr]=Gr.get(t),n[Qr]="utc";const to=[["year",O,"utc"],["month",z,"utc"],["day",x,"utc",6*Yr],["hour",v,"utc",3*Vr],["minute",g,"utc",216e5],["second",y,"utc",18e5]],no=[["year",m,"time"],["month",p,"time"],["day",i,"time",6*Yr],["hour",o,"time",3*Vr],["minute",r,"time",216e5],["second",e,"time",18e5]],eo=[to[0],no[0],to[1],no[1],to[2],no[2],...to.slice(3)];function ro(t){let n=`${t}`.toLowerCase();n.endsWith("s")&&(n=n.slice(0,-1));let e=1;const r=/^(?:(\d+)\s+)/.exec(n);switch(r&&(n=n.slice(r[0].length),e=+r[1]),n){case"quarter":n="month",e*=3;break;case"half":n="month",e*=6}let o=Jr.get(n);if(!o)throw new Error(`unknown interval: ${t}`);if(e>1&&!o.every)throw new Error(`non-periodic interval: ${n}`);return[n,e]}function oo(t){return ao(ro(t),"time")}function io(t){return ao(ro(t),"utc")}function ao([t,n],e){let r=("time"===e?Zr:Jr).get(t);return n>1&&(r=r.every(n),r[Kr]=Gr.get(t)*n,r[Qr]=e),r}function lo(t,n){if(!(n>1))return;const e=t[Kr];if(!Xr.some((([,t])=>t===e)))return;if(e%Vr==0&&Vr<e&&e<Yr)return;const[r]=Xr[S((([,t])=>Math.log(t))).center(Xr,Math.log(e*n))];return("time"===t[Qr]?oo:io)(r)}function so(t,n,e){const r="time"===n?T:R;if(null==e)return r("year"===t?"%Y":"month"===t?"%Y-%m":"day"===t?"%Y-%m-%d":"hour"===t||"minute"===t?"%Y-%m-%dT%H:%M":"second"===t?"%Y-%m-%dT%H:%M:%S":"%Y-%m-%dT%H:%M:%S.%L");const o=function(t){return"left"===t||"right"===t?(t,n)=>`\n${t}\n${n}`:"top"===t?(t,n)=>`${n}\n${t}`:(t,n)=>`${t}\n${n}`}(e);switch(t){case"millisecond":return uo(r(".%L"),r(":%M:%S"),o);case"second":return uo(r(":%S"),r("%-I:%M"),o);case"minute":return uo(r("%-I:%M"),r("%p"),o);case"hour":return uo(r("%-I %p"),r("%b %-d"),o);case"day":return uo(r("%-d"),r("%b"),o);case"month":return uo(r("%b"),r("%Y"),o);case"year":return r("%Y")}throw new Error("unable to format time ticks")}function co(t,n,e){const r=N(C(n,((t,n)=>Math.abs(n-t))));if(r<1e3)return so("millisecond","utc",e);for(const[o,i,a,l]of function(t){return"time"===t?no:"utc"===t?to:eo}(t)){if(r>l)break;if("hour"===o&&!r)break;if(n.every((t=>i.floor(t)>=t)))return so(o,a,e)}}function uo(t,n,e){return(r,o,i)=>{const a=t(r,o),l=n(r,o),s=o-Dr(i);return o!==s&&void 0!==i[s]&&l===n(i[s],s)?a:e(a,l)}}const fo=Object.getPrototypeOf(Uint8Array),ho=Object.prototype.toString,po=Symbol("reindex");function mo(t,n,e){const r=typeof n;return"string"===r?yo(t,xo(n),e):"function"===r?yo(t,n,e):"number"===r||n instanceof Date||"boolean"===r?Do(t,Oo(n),e):"function"==typeof n?.transform?go(n.transform(t),e):function(t,n){return null!=t&&n?Qo(t,n):t}(go(n,e),t?.[po])}function yo(t,n,e){return Do(t,e?.prototype instanceof fo?function(t){return(n,e)=>Co(t(n,e))}(n):n,e)}function go(t,n){return void 0===n?Fo(t):t instanceof n?t:n.prototype instanceof fo&&!(t instanceof fo)?n.from(t,Co):n.from(t)}const vo=[null],xo=t=>n=>n[t],wo={transform:Ko},bo={transform:t=>t},ko=()=>1,$o=()=>!0,Mo=t=>null==t?t:`${t}`,Lo=t=>null==t?t:+t,Ao=t=>t?t[0]:void 0,Eo=t=>t?t[1]:void 0,zo=t=>t?t[2]:void 0,Oo=t=>()=>t;function So(t){const n=+`${t}`.slice(1)/100;return(t,e)=>W(t,n,e)}function No(t){return t instanceof fo?t:Do(t,Co,Float64Array)}function Co(t){return null==t?NaN:Number(t)}function To(t){return Do(t,Ro)}function Ro(t){return t instanceof Date&&!isNaN(t)?t:"string"==typeof t?Sr(t):null==t||isNaN(t=+t)?void 0:new Date(t)}function Io(t,n){return void 0===t&&(t=n),null===t?[void 0,"none"]:Mi(t)?[void 0,t]:[t,void 0]}function Wo(t,n){return void 0===t&&(t=n),null===t||"number"==typeof t?[void 0,t]:[t,void 0]}function jo(t,n,e){if(null!=t)return Bo(t,n,e)}function Bo(t,n,e){const r=`${t}`.toLowerCase();if(!e.includes(r))throw new Error(`invalid ${n}: ${t}`);return r}function Fo(t){return null==t||t instanceof Array||t instanceof fo?t:Array.from(t)}function Do(t,n,e=Array){return null==t?t:t instanceof e?t.map(n):e.from(t,n)}function qo(t,n=Array){return t instanceof n?t.slice():n.from(t)}function _o({x:t,x1:n,x2:e}){return void 0!==t||void 0!==n||void 0!==e}function Po({y:t,y1:n,y2:e}){return void 0!==t||void 0!==n||void 0!==e}function Vo(t){return _o(t)||Po(t)||void 0!==t.interval}function Ho(t){return t?.toString===ho}function Yo(t){return Ho(t)&&(void 0!==t.type||void 0!==t.domain)}function Uo(t){return Ho(t)&&"function"!=typeof t.transform}function Xo(t){return Uo(t)&&void 0===t.value&&void 0===t.channel}function Go(t,n,e,r=bo){return void 0===n&&void 0===e?(n=0,e=void 0===t?r:t):void 0===n?n=void 0===t?0:t:void 0===e&&(e=void 0===t?0:t),[n,e]}function Zo(t,n){return void 0===t&&void 0===n?[Ao,Eo]:[t,n]}function Jo({z:t,fill:n,stroke:e}={}){return void 0===t&&([t]=Io(n)),void 0===t&&([t]=Io(e)),t}function Ko(t){const n=t.length,e=new Uint32Array(n);for(let t=0;t<n;++t)e[t]=t;return e}function Qo(t,n){return Do(n,(n=>t[n]),t.constructor)}function ti(t){return 1===t.length?(n,e)=>t(Qo(e,n)):t}function ni(t,n,e){return t.subarray?t.subarray(n,e):t.slice(n,e)}function ei(t){return null!==t&&"object"==typeof t?t.valueOf():t}function ri(t,n){if(void 0!==n[t])return n[t];switch(t){case"x1":case"x2":t="x";break;case"y1":case"y2":t="y"}return n[t]}function oi(t){let n;return[{transform:()=>n,label:ai(t)},t=>n=t]}function ii(t){return null==t?[t]:oi(t)}function ai(t,n){return"string"==typeof t?t:t&&void 0!==t.label?t.label:n}function li(t,n){return{transform(e){const r=t.transform(e),o=n.transform(e);return vi(r)||vi(o)?Do(r,((t,n)=>new Date((+r[n]+ +o[n])/2))):Do(r,((t,n)=>(+r[n]+ +o[n])/2),Float64Array)},label:t.label}}function si(t,n){const e=ci(n?.interval,n?.type);return e?Do(t,e):t}function ci(t,n){const e=ui(t,n);return e&&(t=>Tr(t)?e.floor(t):t)}function ui(t,n){if(null!=t){if("number"==typeof t)return fi(t);if("string"==typeof t)return("time"===n?oo:io)(t);if("function"!=typeof t.floor)throw new Error("invalid interval; missing floor method");if("function"!=typeof t.offset)throw new Error("invalid interval; missing offset method");return t}}function fi(t){0<(t=+t)&&t<1&&Number.isInteger(1/t)&&(t=-1/t);const n=Math.abs(t);return t<0?{floor:t=>Math.floor(t*n)/n,offset:(t,e=1)=>(t*n+Math.floor(e))/n,range:(t,e)=>I(Math.ceil(t*n),e*n).map((t=>t/n))}:{floor:t=>Math.floor(t/n)*n,offset:(t,e=1)=>t+n*Math.floor(e),range:(t,e)=>I(Math.ceil(t/n),e/n).map((t=>t*n))}}function hi(t,n){if((t=ui(t,n))&&"function"!=typeof t.range)throw new Error("invalid interval: missing range method");return t}function di(t){return"function"==typeof t?.range}function pi(t){return void 0===t||Uo(t)?t:{value:t}}function mi(t){return t&&"function"==typeof t[Symbol.iterator]}function yi(t){for(const n of t)if(null!=n)return"object"!=typeof n||n instanceof Date}function gi(t){for(const n of t){if(null==n)continue;const t=typeof n;return"string"===t||"boolean"===t}}function vi(t){for(const n of t)if(null!=n)return n instanceof Date}function xi(t){for(const n of t)if(null!=n)return"string"==typeof n&&isNaN(n)&&Sr(n)}function wi(t){for(const n of t)if(null!=n){if("string"!=typeof n)return!1;if(n.trim())return!isNaN(n)}}function bi(t){for(const n of t)if(null!=n)return"number"==typeof n}function ki(t,n){let e;for(const r of t)if(null!=r){if(!n(r))return!1;e=!0}return e}const $i=new Set("none,currentcolor,transparent,aliceblue,antiquewhite,aqua,aquamarine,azure,beige,bisque,black,blanchedalmond,blue,blueviolet,brown,burlywood,cadetblue,chartreuse,chocolate,coral,cornflowerblue,cornsilk,crimson,cyan,darkblue,darkcyan,darkgoldenrod,darkgray,darkgreen,darkgrey,darkkhaki,darkmagenta,darkolivegreen,darkorange,darkorchid,darkred,darksalmon,darkseagreen,darkslateblue,darkslategray,darkslategrey,darkturquoise,darkviolet,deeppink,deepskyblue,dimgray,dimgrey,dodgerblue,firebrick,floralwhite,forestgreen,fuchsia,gainsboro,ghostwhite,gold,goldenrod,gray,green,greenyellow,grey,honeydew,hotpink,indianred,indigo,ivory,khaki,lavender,lavenderblush,lawngreen,lemonchiffon,lightblue,lightcoral,lightcyan,lightgoldenrodyellow,lightgray,lightgreen,lightgrey,lightpink,lightsalmon,lightseagreen,lightskyblue,lightslategray,lightslategrey,lightsteelblue,lightyellow,lime,limegreen,linen,magenta,maroon,mediumaquamarine,mediumblue,mediumorchid,mediumpurple,mediumseagreen,mediumslateblue,mediumspringgreen,mediumturquoise,mediumvioletred,midnightblue,mintcream,mistyrose,moccasin,navajowhite,navy,oldlace,olive,olivedrab,orange,orangered,orchid,palegoldenrod,palegreen,paleturquoise,palevioletred,papayawhip,peachpuff,peru,pink,plum,powderblue,purple,rebeccapurple,red,rosybrown,royalblue,saddlebrown,salmon,sandybrown,seagreen,seashell,sienna,silver,skyblue,slateblue,slategray,slategrey,snow,springgreen,steelblue,tan,teal,thistle,tomato,turquoise,violet,wheat,white,whitesmoke,yellow".split(","));function Mi(t){return"string"==typeof t&&(t=t.toLowerCase().trim(),/^#[0-9a-f]{3,8}$/.test(t)||/^(?:url|var|rgb|rgba|hsl|hsla|hwb|lab|lch|oklab|oklch|color|color-mix)\(.*\)$/.test(t)||$i.has(t))}function Li(t){return"number"==typeof t&&(0<=t&&t<=1||isNaN(t))}function Ai(t){return null==t||Ei(t)}function Ei(t){return/^\s*none\s*$/i.test(t)}function zi(t,n){return jo(t,n,["middle","top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"])}function Oi(t="middle"){return zi(t,"frameAnchor")}function Si(t){return mi(t)?function(t){console.warn("named iterables are deprecated; please use an object instead");const n=new Set;return Object.fromEntries(Array.from(t,(t=>{const{name:e}=t;if(null==e)throw new Error("missing name");const r=`${e}`;if("__proto__"===r)throw new Error(`illegal name: ${r}`);if(n.has(r))throw new Error(`duplicate name: ${r}`);return n.add(r),[e,t]})))}(t):t}function Ni(t){return!0===t?t="frame":!1===t?t=null:null!=t&&(t=Bo(t,"clip",["frame","sphere"])),t}const Ci=Symbol("position"),Ti=Symbol("color"),Ri=Symbol("radius"),Ii=Symbol("length"),Wi=Symbol("opacity"),ji=Symbol("symbol"),Bi=Symbol("projection"),Fi=new Map([["x",Ci],["y",Ci],["fx",Ci],["fy",Ci],["r",Ri],["color",Ti],["opacity",Wi],["symbol",ji],["length",Ii],["projection",Bi]]);const Di=Math.sqrt(3),qi=2/Di,_i=new Map([["asterisk",j],["circle",B],["cross",F],["diamond",D],["diamond2",q],["hexagon",{draw(t,n){const e=Math.sqrt(n/Math.PI),r=e*qi,o=r/2;t.moveTo(0,r),t.lineTo(e,o),t.lineTo(e,-o),t.lineTo(0,-r),t.lineTo(-e,-o),t.lineTo(-e,o),t.closePath()}}],["plus",_],["square",P],["square2",V],["star",H],["times",Y],["triangle",U],["triangle2",X],["wye",G]]);function Pi(t){return t&&"function"==typeof t.draw}function Vi(t){return!!Pi(t)||"string"==typeof t&&_i.has(t.toLowerCase())}function Hi(t){if(null==t||Pi(t))return t;const n=_i.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid symbol: ${t}`)}function Yi({filter:t,sort:n,reverse:e,transform:r,initializer:o,...i}={},a){if(void 0===r&&(null!=t&&(r=Ki(t)),null==n||Xo(n)||(r=Xi(r,ra(n))),e&&(r=Xi(r,ta))),null!=a&&null!=o)throw new Error("transforms cannot be applied after initializers");return{...i,...(null===n||Xo(n))&&{sort:n},transform:Xi(r,a)}}function Ui({filter:t,sort:n,reverse:e,initializer:r,...o}={},i){return void 0===r&&(null!=t&&(r=Ki(t)),null==n||Xo(n)||(r=Gi(r,ra(n))),e&&(r=Gi(r,ta))),{...o,...(null===n||Xo(n))&&{sort:n},initializer:Gi(r,i)}}function Xi(t,n){return null==t?null===n?void 0:n:null==n?null===t?void 0:t:function(e,r,o){return({data:e,facets:r}=t.call(this,e,r,o)),n.call(this,Fo(e),r,o)}}function Gi(t,n){return null==t?null===n?void 0:n:null==n?null===t?void 0:t:function(e,r,o,...i){let a,l,s,c,u,f;return({data:l=e,facets:s=r,channels:a}=t.call(this,e,r,o,...i)),({data:u=l,facets:f=s,channels:c}=n.call(this,l,s,{...o,...a},...i)),{data:u,facets:f,channels:{...a,...c}}}}function Zi(t,n){return(null!=t.initializer?Ui:Yi)(t,n)}function Ji(t,n){return Zi(n,Ki(t))}function Ki(t){return(n,e)=>{const r=mo(n,t);return{data:n,facets:e.map((t=>t.filter((t=>r[t]))))}}}function Qi({sort:t,...n}={}){return{...Zi(n,ta),sort:Xo(t)?t:null}}function ta(t,n){return{data:t,facets:n.map((t=>t.slice().reverse()))}}function na({seed:t,sort:n,...e}={}){return{...Zi(e,ia(null==t?Math.random:Z(t))),sort:Xo(n)?n:null}}function ea(t,{sort:n,...e}={}){return{...(Uo(t)&&void 0!==t.channel?Ui:Zi)(e,ra(t)),sort:Xo(n)?n:null}}function ra(t){return("function"==typeof t&&1!==t.length?oa:ia)(t)}function oa(t){return(n,e)=>{const r=(e,r)=>t(n[e],n[r]);return{data:n,facets:e.map((t=>t.slice().sort(r)))}}}function ia(t){let n,e;({channel:n,value:t,order:e}={...pi(t)});const r=n?.startsWith("-");if(r&&(n=n.slice(1)),void 0===e&&(e=r?Ir:Rr),"function"!=typeof e)switch(`${e}`.toLowerCase()){case"ascending":e=Rr;break;case"descending":e=Ir;break;default:throw new Error(`invalid order: ${e}`)}return(r,o,i)=>{let a;if(void 0===n)a=mo(r,t);else{if(void 0===i)throw new Error("channel sort requires an initializer");if(a=i[n],!a)return{};a=a.value}const l=(t,n)=>e(a[t],a[n]);return{data:r,facets:o.map((t=>t.slice().sort(l)))}}}function aa(t,n){return ua(null,null,t,n)}function la(t={y:"count"},n={}){const{x:e=bo}=n;if(null==e)throw new Error("missing channel: x");return ua(e,null,t,n)}function sa(t={x:"count"},n={}){const{y:e=bo}=n;if(null==e)throw new Error("missing channel: y");return ua(null,e,t,n)}function ca(t={fill:"count"},n={}){let{x:e,y:r}=n;if([e,r]=Zo(e,r),null==e)throw new Error("missing channel: x");if(null==r)throw new Error("missing channel: y");return ua(e,r,t,n)}function ua(t,n,{data:e=Ea,filter:r,sort:o,reverse:i,...a}={},l={}){a=va(a,l),e=ba(e,bo),o=null==o?void 0:xa("sort",o,l),r=null==r?void 0:wa("filter",r,l);const[s,c]=ii(t),[u,f]=ii(n),{z:h,fill:d,stroke:p,x1:m,x2:y,y1:g,y2:v,...x}=l,[w,b]=ii(h),[k]=Io(d),[$]=Io(p),[M,L]=ii(k),[A,E]=ii($);return{..."z"in l&&{z:w||h},..."fill"in l&&{fill:M||d},..."stroke"in l&&{stroke:A||p},...Yi(x,((l,s,u)=>{const d=si(mo(l,t),u?.x),p=si(mo(l,n),u?.y),m=mo(l,h),y=mo(l,k),g=mo(l,$),v=$a(a,{z:m,fill:y,stroke:g}),x=[],w=[],M=d&&c([]),A=p&&f([]),z=m&&b([]),O=y&&L([]),S=g&&E([]);let N=0;for(const t of a)t.initialize(l);o&&o.initialize(l),r&&r.initialize(l);for(const t of s){const n=[];for(const n of a)n.scope("facet",t);o&&o.scope("facet",t),r&&r.scope("facet",t);for(const[i,s]of ma(t,v))for(const[t,c]of ma(s,p))for(const[s,u]of ma(c,d)){const c={data:l};if(d&&(c.x=s),p&&(c.y=t),v&&(c.z=i),!r||r.reduce(u,c)){n.push(N++),w.push(e.reduceIndex(u,l,c)),d&&M.push(s),p&&A.push(t),m&&z.push(v===m?i:m[u[0]]),y&&O.push(v===y?i:y[u[0]]),g&&S.push(v===g?i:g[u[0]]);for(const t of a)t.reduce(u,c);o&&o.reduce(u,c)}}x.push(n)}return Ma(x,o,i),{data:w,facets:x}})),...!fa(a,"x")&&(s?{x:s}:{x1:m,x2:y}),...!fa(a,"y")&&(u?{y:u}:{y1:g,y2:v}),...Object.fromEntries(a.map((({name:t,output:n})=>[t,n])))}}function fa(t,...n){for(const{name:e}of t)if(n.includes(e))return!0;return!1}function ha(t,n,e=da){const r=Object.entries(t);return null!=n.title&&void 0===t.title&&r.push(["title",Oa]),null!=n.href&&void 0===t.href&&r.push(["href",za]),r.filter((([,t])=>void 0!==t)).map((([t,r])=>null===r?function(t){return{name:t,initialize(){},scope(){},reduce(){}}}(t):e(t,r,n)))}function da(t,n,e,r=pa){let o;Ho(n)&&"reduce"in n&&(o=n.scale,n=n.reduce);const i=r(t,n,e),[a,l]=oi(i.label);let s;return{name:t,output:void 0===o?a:{value:a,scale:o},initialize(t){i.initialize(t),s=l([])},scope(t,n){i.scope(t,n)},reduce(t,n){s.push(i.reduce(t,n))}}}function pa(t,n,e,r=ya){const o=ri(t,e),i=r(n,o);let a,l;return{label:ai(i===Na?null:o,i.label),initialize(t){a=void 0===o?t:mo(t,o),"data"===i.scope&&(l=i.reduceIndex(Ko(t),a))},scope(t,n){i.scope===t&&(l=i.reduceIndex(n,a))},reduce:(t,n)=>null==i.scope?i.reduceIndex(t,a,n):i.reduceIndex(t,a,l,n)}}function ma(t,n){return n?J(t,(t=>n[t])):[[,t]]}function ya(t,n,e=ga){if(null==t)return e(t);if("function"==typeof t.reduceIndex)return t;if("function"==typeof t.reduce&&Ho(t))return function(t){return console.warn("deprecated reduce interface; implement reduceIndex instead."),{...t,reduceIndex:t.reduce.bind(t)}}(t);if("function"==typeof t)return r=t,{reduceIndex:(t,n,e)=>r(Qo(n,t),e)};var r;if(/^p\d{2}$/i.test(t))return La(So(t));switch(`${t}`.toLowerCase()){case"first":return za;case"last":return Sa;case"identity":return Ea;case"count":return Na;case"distinct":return Ca;case"sum":return null==n?Na:Ta;case"proportion":return Ra(n,"data");case"proportion-facet":return Ra(n,"facet");case"deviation":return La(ut);case"min":return La(ct);case"min-index":return La(st);case"max":return La(N);case"max-index":return La(lt);case"mean":return Aa(at);case"median":return Aa(ot);case"variance":return La(rt);case"mode":return La(et)}return e(t)}function ga(t){throw new Error(`invalid reduce: ${t}`)}function va(t,n){return ha(t,n,xa)}function xa(t,n,e){return da(t,n,e,wa)}function wa(t,n,e){return pa(t,n,e,ba)}function ba(t,n){return ya(t,n,ka)}function ka(t){switch(`${t}`.toLowerCase()){case"x":return Ia;case"y":return Wa;case"z":return ja}throw new Error(`invalid group reduce: ${t}`)}function $a(t,n){for(const e in n){const r=n[e];if(void 0!==r&&!t.some((t=>t.name===e)))return r}}function Ma(t,n,e){if(n){const e=n.output.transform(),r=(t,n)=>Rr(e[t],e[n]);t.forEach((t=>t.sort(r)))}e&&t.forEach((t=>t.reverse()))}function La(t){return{reduceIndex:(n,e)=>t(n,(t=>e[t]))}}function Aa(t){return{reduceIndex(n,e){const r=t(n,(t=>e[t]));return vi(e)?new Date(r):r}}}const Ea={reduceIndex:(t,n)=>Qo(n,t)},za={reduceIndex:(t,n)=>n[t[0]]},Oa={reduceIndex(t,n){const e=K(Q(t,(t=>t.length),(t=>n[t])),Eo),r=e.slice(-5).reverse();if(r.length<e.length){const t=e.slice(0,-4);r[4]=[`… ${t.length.toLocaleString("en-US")} more`,tt(t,Eo)]}return r.map((([t,n])=>`${t} (${n.toLocaleString("en-US")})`)).join("\n")}},Sa={reduceIndex:(t,n)=>n[t[t.length-1]]},Na={label:"Frequency",reduceIndex:t=>t.length},Ca={label:"Distinct",reduceIndex(t,n){const e=new nt;for(const r of t)e.add(n[r]);return e.size}},Ta=La(tt);function Ra(t,n){return null==t?{scope:n,label:"Frequency",reduceIndex:(t,n,e=1)=>t.length/e}:{scope:n,reduceIndex:(t,n,e=1)=>tt(t,(t=>n[t]))/e}}const Ia={reduceIndex:(t,n,{x:e})=>e},Wa={reduceIndex:(t,n,{y:e})=>e},ja={reduceIndex:(t,n,{z:e})=>e};function Ba(t){if("function"!=typeof t)throw new Error(`invalid test function: ${t}`);return{reduceIndex:(n,e,{data:r})=>e[n.find((n=>t(r[n],n,r)))]}}function Fa(t,{scale:n,type:e,value:r,filter:o,hint:i,label:a=ai(r)},l){return void 0===i&&"function"==typeof r?.transform&&(i=r.hint),_a(l,{scale:n,type:e,value:mo(t,r),label:a,filter:o,hint:i})}function Da(t,n){return Object.fromEntries(Object.entries(t).map((([t,e])=>[t,Fa(n,e,t)])))}function qa(t,n){const e=Object.fromEntries(Object.entries(t).map((([t,{scale:e,value:r}])=>{const o=null==e?null:n[e];return[t,null==o?r:Do(r,o)]})));return e.channels=t,e}function _a(t,n){const{scale:e,value:r}=n;if(!0===e||"auto"===e)switch(t){case"fill":case"stroke":case"color":n.scale=!0!==e&&ki(r,Mi)?null:"color";break;case"fillOpacity":case"strokeOpacity":case"opacity":n.scale=!0!==e&&ki(r,Li)?null:"opacity";break;case"symbol":!0!==e&&ki(r,Vi)?(n.scale=null,n.value=Do(r,Hi)):n.scale="symbol";break;default:n.scale=Fi.has(t)?t:null}else if(!1===e)n.scale=null;else if(null!=e&&!Fi.has(e))throw new Error(`unknown scale: ${e}`);return n}function Pa(t,n){for(const e in t){const r=t[e];if(r.scale===n)return r}}function Va(t,n){const e=t.original;if(e===t)return n;const r=n.value,o=n.value=[];for(let n=0;n<e.length;++n){const i=r[e[n][0]];for(const e of t[n])o[e]=i}return n}function Ha(t,n,e){const r=Ya(t,n);return Do(Ya(t,e),((t,n)=>Math.abs(t-r[n])),Float64Array)}function Ya(t,n,e){let r=t[n];if(r||void 0===e||(r=t[e]),r)return r.value;throw new Error(`missing channel: ${n}`)}function Ua(t){if(null==t||"function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"ascending":return Xa;case"descending":return Ga}throw new Error(`invalid order: ${t}`)}function Xa([t,n],[e,r]){return Rr(n,r)||Rr(t,e)}function Ga([t,n],[e,r]){return Ir(n,r)||Rr(t,e)}function Za(t,n){let e=t[n];if(e){for(;e.source;)e=e.source;return null===e.source?null:e}}const Ja=new Map([["accent",dt],["category10",pt],["dark2",mt],["observable10",yt],["paired",gt],["pastel1",vt],["pastel2",xt],["set1",wt],["set2",bt],["set3",kt],["tableau10",$t]]);const Ka=new Map([...Ja,["brbg",tl(Lt,Mt)],["prgn",tl(Et,At)],["piyg",tl(Ot,zt)],["puor",tl(Nt,St)],["rdbu",tl(Tt,Ct)],["rdgy",tl(It,Rt)],["rdylbu",tl(jt,Wt)],["rdylgn",tl(Ft,Bt)],["spectral",tl(qt,Dt)],["burd",nl(Tt,Ct)],["buylrd",nl(jt,Wt)],["blues",Qa(Pt,_t)],["greens",Qa(Ht,Vt)],["greys",Qa(Ut,Yt)],["oranges",Qa(Gt,Xt)],["purples",Qa(Jt,Zt)],["reds",Qa(Qt,Kt)],["turbo",el(tn)],["viridis",el(nn)],["magma",el(en)],["inferno",el(rn)],["plasma",el(on)],["cividis",el(an)],["cubehelix",el(ln)],["warm",el(sn)],["cool",el(cn)],["bugn",Qa(fn,un)],["bupu",Qa(dn,hn)],["gnbu",Qa(mn,pn)],["orrd",Qa(gn,yn)],["pubu",Qa(xn,vn)],["pubugn",Qa(bn,wn)],["purd",Qa($n,kn)],["rdpu",Qa(Ln,Mn)],["ylgn",Qa(En,An)],["ylgnbu",Qa(On,zn)],["ylorbr",Qa(Nn,Sn)],["ylorrd",Qa(Tn,Cn)],["rainbow",rl(Rn)],["sinebow",rl(In)]]);function Qa(t,n){return({length:e})=>1===e?[t[3][1]]:2===e?[t[3][1],t[3][2]]:(e=Math.max(3,Math.floor(e)))>9?ht(n,e):t[e]}function tl(t,n){return({length:e})=>2===e?[t[3][0],t[3][2]]:(e=Math.max(3,Math.floor(e)))>11?ht(n,e):t[e]}function nl(t,n){return({length:e})=>2===e?[t[3][2],t[3][0]]:(e=Math.max(3,Math.floor(e)))>11?ht((t=>n(1-t)),e):t[e].slice().reverse()}function el(t){return({length:n})=>ht(t,Math.max(2,Math.floor(n)))}function rl(t){return({length:n})=>ht(t,Math.floor(n)+1).slice(0,-1)}function ol(t){const n=`${t}`.toLowerCase();if(!Ka.has(n))throw new Error(`unknown ordinal scheme: ${n}`);return Ka.get(n)}function il(t,n){const e=ol(t),r="function"==typeof e?e({length:n}):e;return r.length!==n?r.slice(0,n):r}const al=new Map([["brbg",Mt],["prgn",At],["piyg",zt],["puor",St],["rdbu",Ct],["rdgy",Rt],["rdylbu",Wt],["rdylgn",Bt],["spectral",Dt],["burd",t=>Ct(1-t)],["buylrd",t=>Wt(1-t)],["blues",_t],["greens",Vt],["greys",Yt],["purples",Zt],["reds",Kt],["oranges",Xt],["turbo",tn],["viridis",nn],["magma",en],["inferno",rn],["plasma",on],["cividis",an],["cubehelix",ln],["warm",sn],["cool",cn],["bugn",un],["bupu",hn],["gnbu",pn],["orrd",yn],["pubugn",wn],["pubu",vn],["purd",kn],["rdpu",Mn],["ylgnbu",zn],["ylgn",An],["ylorbr",Sn],["ylorrd",Cn],["rainbow",Rn],["sinebow",In]]);function ll(t){const n=`${t}`.toLowerCase();if(!al.has(n))throw new Error(`unknown quantitative scheme: ${n}`);return al.get(n)}const sl=new Set(["brbg","prgn","piyg","puor","rdbu","rdgy","rdylbu","rdylgn","spectral","burd","buylrd"]);const cl=t=>n=>t(1-n),ul=[0,1],fl=new Map([["number",Pn],["rgb",Xn],["hsl",Zn],["hcl",Jn],["lab",Kn]]);function hl(t){const n=`${t}`.toLowerCase();if(!fl.has(n))throw new Error(`unknown interpolator: ${n}`);return fl.get(n)}function dl(t,n,e,{type:r,nice:o,clamp:i,zero:a,domain:l=gl(t,e),unknown:s,round:c,scheme:u,interval:f,range:h=(Fi.get(t)===Ri?xl(e,l):Fi.get(t)===Ii?wl(e,l):Fi.get(t)===Wi?ul:void 0),interpolate:d=(Fi.get(t)===Ti?null==u&&void 0!==h?Xn:ll(void 0!==u?u:"cyclical"===r?"rainbow":"turbo"):c?Gn:Pn),reverse:p}){if(f=hi(f,r),"cyclical"!==r&&"sequential"!==r||(r="linear"),"function"!=typeof d&&(d=hl(d)),p=!!p,void 0!==h){if((l=Fo(l)).length!==(h=Fo(h)).length){if(1===d.length)throw new Error("invalid piecewise interpolator");d=Un(d,h),h=void 0}}if(1===d.length?(p&&(d=cl(d),p=!1),void 0===h&&2===(h=Float64Array.from(l,((t,n)=>n/(l.length-1)))).length&&(h=ul),n.interpolate((h===ul?Oo:$l)(d))):n.interpolate(d),a){const[t,n]=qn(l);if(t>0||n<0){(Dr(l=qo(l))||1)===Math.sign(t)?l[0]=0:l[l.length-1]=0}}return p&&(l=Vn(l)),n.domain(l).unknown(s),o&&(n.nice(function(t,n){return!0===t?void 0:"number"==typeof t?t:function(t,n){if((t=hi(t,n))&&"function"!=typeof t.ceil)throw new Error("invalid interval: missing ceil method");return t}(t,n)}(o,r)),l=n.domain()),void 0!==h&&n.range(h),i&&n.clamp(i),{type:r,domain:l,range:h,scale:n,interpolate:d,interval:f}}function pl(t,n,{exponent:e=1,...r}){return dl(t,jn().exponent(e),n,{...r,type:"pow"})}function ml(t,e,{domain:r=[0],unknown:o,scheme:i="rdylbu",interpolate:a,range:l=(void 0!==a?ht(a,r.length+1):Fi.get(t)===Ti?il(i,r.length+1):void 0),reverse:s}){const c=Dr(r=Fo(r));if(!isNaN(c)&&!function(t,e){for(let r=1,o=t.length,i=t[0];r<o;++r){const o=n(i,i=t[r]);if(0!==o&&o!==e)return!1}return!0}(r,c))throw new Error(`the ${t} scale has a non-monotonic domain`);return s&&(l=Vn(l)),{type:"threshold",scale:Hn(c<0?Vn(r):r,void 0===l?[]:l).unknown(o),domain:r,range:l}}function yl(t,n=jr){return t.length?[ct(t,(({value:t})=>void 0===t?t:ct(t,n))),N(t,(({value:t})=>void 0===t?t:N(t,n)))]:[0,1]}function gl(t,n){const e=Fi.get(t);return(e===Ri||e===Wi||e===Ii?vl:yl)(n)}function vl(t){return[0,t.length?N(t,(({value:t})=>void 0===t?t:N(t,jr))):1]}function xl(t,n){const e=t.find((({radius:t})=>void 0!==t));if(void 0!==e)return[0,e.radius];const r=W(t,.5,(({value:t})=>void 0===t?NaN:W(t,.25,Br))),o=n.map((t=>3*Math.sqrt(t/r))),i=30/N(o);return i<1?o.map((t=>t*i)):o}function wl(t,n){const e=ot(t,(({value:t})=>void 0===t?NaN:ot(t,Math.abs))),r=n.map((t=>12*t/e)),o=60/N(r);return o<1?r.map((t=>t*o)):r}function bl(t){for(const{value:n}of t)if(void 0!==n)for(let e of n){if(e>0)return yl(t,Br);if(e<0)return yl(t,Fr)}return[1,10]}function kl(t){const n=[];for(const{value:e}of t)if(void 0!==e)for(const t of e)n.push(t);return n}function $l(t){return(n,e)=>r=>t(n+r*(e-n))}let Ml,Ll=0;function Al(t){t!==Ml&&(Ml=t,console.warn(t),++Ll)}function El(t,e,r,o,{type:i,nice:a,clamp:l,domain:s=yl(o),unknown:c,pivot:u=0,scheme:f,range:h,symmetric:d=!0,interpolate:p=(Fi.get(t)===Ti?null==f&&void 0!==h?Xn:ll(void 0!==f?f:"rdbu"):Pn),reverse:m}){u=+u,s=Fo(s);let[y,g]=s;if(s.length>2&&Al(`Warning: the diverging ${t} scale domain contains extra elements.`),n(y,g)<0&&([y,g]=[g,y],m=!m),y=Math.min(y,u),g=Math.max(g,u),"function"!=typeof p&&(p=hl(p)),void 0!==h&&(p=1===p.length?$l(p)(...h):Un(p,h)),m&&(p=cl(p)),d){const t=r.apply(u),n=t-r.apply(y),e=r.apply(g)-t;n<e?y=r.invert(t-e):n>e&&(g=r.invert(t+n))}return e.domain([y,u,g]).unknown(c).interpolator(p),l&&e.clamp(l),a&&e.nice(a),{type:i,domain:[y,g],pivot:u,interpolate:p,scale:e}}function zl(t,n,{exponent:e=1,...r}){return El(t,te().exponent(e=+e),function(t){return.5===t?Cl:{apply:n=>Math.sign(n)*Math.pow(Math.abs(n),t),invert:n=>Math.sign(n)*Math.pow(Math.abs(n),1/t)}}(e),n,{...r,type:"diverging-pow"})}function Ol(t,n,{constant:e=1,...r}){return El(t,ee().constant(e=+e),function(t){return{apply:n=>Math.sign(n)*Math.log1p(Math.abs(n/t)),invert:n=>Math.sign(n)*Math.expm1(Math.abs(n))*t}}(e),n,r)}const Sl={apply:t=>t,invert:t=>t},Nl={apply:Math.log,invert:Math.exp},Cl={apply:t=>Math.sign(t)*Math.sqrt(Math.abs(t)),invert:t=>Math.sign(t)*(t*t)};function Tl(t,n,e,r){return dl(t,n,e,r)}const Rl=Symbol("ordinal");function Il(t,n,e,{type:r,interval:o,domain:i,range:a,reverse:l,hint:s}){return o=hi(o,r),void 0===i&&(i=Bl(e,o,t)),"categorical"!==r&&r!==Rl||(r="ordinal"),l&&(i=Vn(i)),i=n.domain(i).domain(),void 0!==a&&("function"==typeof a&&(a=a(i)),n.range(a)),{type:r,domain:i,range:a,scale:n,hint:s,interval:o}}function Wl(t,n,{type:e,interval:r,domain:o,range:i,scheme:a,unknown:l,...s}){let c;if(r=hi(r,e),void 0===o&&(o=Bl(n,r,t)),Fi.get(t)===ji)c=function(t){return{fill:Fl(t,"fill"),stroke:Fl(t,"stroke")}}(n),i=void 0===i?function(t){return Ai(t.fill)?ce:ue}(c):Do(i,Hi);else if(Fi.get(t)===Ti&&(void 0!==i||"ordinal"!==e&&e!==Rl||(i=function(t,n="greys"){const e=new Set,[r,o]=il(n,2);for(const n of t)if(null!=n)if(!0===n)e.add(o);else{if(!1!==n)return;e.add(r)}return[...e]}(o,a),void 0!==i&&(a=void 0)),void 0===a&&void 0===i&&(a="ordinal"===e?"turbo":"observable10"),void 0!==a))if(void 0!==i){const t=ll(a),n=i[0],e=i[1]-i[0];i=({length:r})=>ht((r=>t(n+e*r)),r)}else i=ol(a);if(l===ie)throw new Error(`implicit unknown on ${t} scale is not supported`);return Il(t,ae().unknown(l),n,{...s,type:e,domain:o,range:i,hint:c})}function jl(t,n,e,r){let{round:o}=e;return void 0!==o&&t.round(o=!!o),(t=Il(r,t,n,e)).round=o,t}function Bl(t,n,e){const r=new nt;for(const{value:n,domain:e}of t){if(void 0!==e)return e();if(void 0!==n)for(const t of n)r.add(t)}if(void 0!==n){const[t,e]=qn(r).map(n.floor,n);return n.range(t,n.offset(e))}if(r.size>1e4&&Fi.get(e)===Ci)throw new Error(`implicit ordinal domain of ${e} scale has more than 10,000 values`);return K(r,Rr)}function Fl(t,n){let e;for(const{hint:r}of t){const t=r?.[n];if(void 0!==t)if(void 0===e)e=t;else if(e!==t)return}return e}function Dl(t,{label:n,inset:e=0,insetTop:r=e,insetRight:o=e,insetBottom:i=e,insetLeft:a=e,round:l,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,facet:{label:p=n}={},...m}={}){const y={};for(const[e,g]of t){const t=m[e],v=Jl(e,g,{round:Fi.get(e)===Ci?l:void 0,nice:s,clamp:c,zero:u,align:f,padding:h,projection:d,...t});if(v){let{label:l=("fx"===e||"fy"===e?p:n),percent:s,transform:c,inset:u,insetTop:f=(void 0!==u?u:"y"===e?r:0),insetRight:h=(void 0!==u?u:"x"===e?o:0),insetBottom:d=(void 0!==u?u:"y"===e?i:0),insetLeft:m=(void 0!==u?u:"x"===e?a:0)}=t||{};if(null==c)c=void 0;else if("function"!=typeof c)throw new Error("invalid scale transform; not a function");v.percent=!!s,v.label=void 0===l?_l(g,v):l,v.transform=c,"x"===e||"fx"===e?(v.insetLeft=+m,v.insetRight=+h):"y"!==e&&"fy"!==e||(v.insetTop=+f,v.insetBottom=+d),y[e]=v}}return y}function ql(t){const n={},e={scales:n};for(const[r,o]of Object.entries(t)){const{scale:t,type:i,interval:a,label:l}=o;n[r]=ss(o),e[r]=t,t.type=i,null!=a&&(t.interval=a),null!=l&&(t.label=l)}return e}function _l(t=[],n){let e;for(const{label:n}of t)if(void 0!==n)if(void 0===e)e=n;else if(e!==n)return;if(void 0!==e)return!es(n)&&n.percent&&(e=`${e} (%)`),{inferred:!0,toString:()=>e}}function Pl(t){return Math.sign(Dr(t.domain()))*Math.sign(Dr(t.range()))}function Vl(t){const{marginTop:n,marginRight:e,marginBottom:r,marginLeft:o,width:i,height:a,facet:{marginTop:l,marginRight:s,marginBottom:c,marginLeft:u}}=t;return{marginTop:Math.max(n,l),marginRight:Math.max(e,s),marginBottom:Math.max(r,c),marginLeft:Math.max(o,u),width:i,height:a}}function Hl({fx:t,fy:n},e){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Vl(e);return{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:t?t.scale.bandwidth()+a+o:l,height:n?n.scale.bandwidth()+r+i:s,facet:{width:l,height:s}}}function Yl(t,n){if(void 0===t.range){const{insetLeft:e,insetRight:r}=t,{width:o,marginLeft:i=0,marginRight:a=0}=n,l=i+e,s=o-a-r;t.range=[l,Math.max(l,s)],es(t)||(t.range=Gl(t)),t.scale.range(t.range)}Xl(t)}function Ul(t,n){if(void 0===t.range){const{insetTop:e,insetBottom:r}=t,{height:o,marginTop:i=0,marginBottom:a=0}=n,l=i+e,s=o-a-r;t.range=[Math.max(l,s),l],es(t)?t.range.reverse():t.range=Gl(t),t.scale.range(t.range)}Xl(t)}function Xl(t){void 0===t.round&&function({type:t}){return"point"===t||"band"===t}(t)&&function({scale:t}){const n=t.domain().length,[e,r]=t.range(),o=t.paddingInner?t.paddingInner():1,i=t.paddingOuter?t.paddingOuter():t.padding(),a=n-o,l=Math.abs(r-e)/Math.max(1,a+2*i);return(l-Math.floor(l))*a}(t)<=30&&t.scale.round(!0)}function Gl(t){const n=t.scale.domain().length+rs(t);if(!(n>2))return t.range;const[e,r]=t.range;return Array.from({length:n},((t,o)=>e+o/(n-1)*(r-e)))}function Zl(t,n,e){return Jl(t,void 0===e?void 0:[{hint:e}],{...n})}function Jl(t,n=[],e={}){const r=function(t,n,{type:e,domain:r,range:o,scheme:i,pivot:a,projection:l}){if(e=Ql(e),"fx"===t||"fy"===t)return"band";"x"!==t&&"y"!==t||null==l||(e=ts);for(const t of n){const n=Ql(t.type);if(void 0!==n)if(void 0===e)e=n;else if(e!==n)throw new Error(`scale incompatible with channel: ${e} !== ${n}`)}if(e===ts)return;if(void 0!==e)return e;if(void 0===r&&!n.some((({value:t})=>void 0!==t)))return;const s=Fi.get(t);if(s===Ri)return"sqrt";if(s===Wi||s===Ii)return"linear";if(s===ji)return"ordinal";if((r||o||[]).length>2)return ns(s);if(void 0!==r){if(gi(r))return ns(s);if(vi(r))return"utc"}else{const t=n.map((({value:t})=>t)).filter((t=>void 0!==t));if(t.some(gi))return ns(s);if(t.some(vi))return"utc"}if(s===Ti){if(null!=a||function(t){return null!=t&&sl.has(`${t}`.toLowerCase())}(i))return"diverging";if(function(t){return null!=t&&Ja.has(`${t}`.toLowerCase())}(i))return"categorical"}return"linear"}(t,n,e);if(void 0===e.type&&void 0===e.domain&&void 0===e.range&&null==e.interval&&"fx"!==t&&"fy"!==t&&es({type:r})){const e=n.map((({value:t})=>t)).filter((t=>void 0!==t));e.some(vi)?Al(`Warning: some data associated with the ${t} scale are dates. Dates are typically associated with a "utc" or "time" scale rather than a "${Kl(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., d3.utcDay), or you can suppress this warning by setting the type of the ${t} scale to "${Kl(r)}".`):e.some(xi)?Al(`Warning: some data associated with the ${t} scale are strings that appear to be dates (e.g., YYYY-MM-DD). If these strings represent dates, you should parse them to Date objects. Dates are typically associated with a "utc" or "time" scale rather than a "${Kl(r)}" scale. If you are using a bar mark, you probably want a rect mark with the interval option instead; if you are using a group transform, you probably want a bin transform instead. If you want to treat this data as ordinal, you can suppress this warning by setting the type of the ${t} scale to "${Kl(r)}".`):e.some(wi)&&Al(`Warning: some data associated with the ${t} scale are strings that appear to be numbers. If these strings represent numbers, you should parse or coerce them to numbers. Numbers are typically associated with a "linear" scale rather than a "${Kl(r)}" scale. If you want to treat this data as ordinal, you can specify the interval of the ${t} scale (e.g., 1 for integers), or you can suppress this warning by setting the type of the ${t} scale to "${Kl(r)}".`)}switch(e.type=r,r){case"diverging":case"diverging-sqrt":case"diverging-pow":case"diverging-log":case"diverging-symlog":case"cyclical":case"sequential":case"linear":case"sqrt":case"threshold":case"quantile":case"pow":case"log":case"symlog":e=is(n,e,No);break;case"identity":switch(Fi.get(t)){case Ci:e=is(n,e,No);break;case ji:e=is(n,e,as)}break;case"utc":case"time":e=is(n,e,To)}switch(r){case"diverging":return function(t,n,e){return El(t,Qn(),Sl,n,e)}(t,n,e);case"diverging-sqrt":return function(t,n,e){return zl(t,n,{...e,exponent:.5})}(t,n,e);case"diverging-pow":return zl(t,n,e);case"diverging-log":return function(t,n,{base:e=10,pivot:r=1,domain:o=yl(n,r<0?Fr:Br),...i}){return El(t,ne().base(e=+e),Nl,n,{domain:o,pivot:r,...i})}(t,n,e);case"diverging-symlog":return Ol(t,n,e);case"categorical":case"ordinal":case Rl:return Wl(t,n,e);case"cyclical":case"sequential":case"linear":return function(t,n,e){return dl(t,Wn(),n,e)}(t,n,e);case"sqrt":return function(t,n,e){return pl(t,n,{...e,exponent:.5})}(t,n,e);case"threshold":return ml(t,0,e);case"quantile":return function(t,n,{range:e,quantiles:r=(void 0===e?5:(e=[...e]).length),n:o=r,scheme:i="rdylbu",domain:a=kl(n),unknown:l,interpolate:s,reverse:c}){return void 0===e&&(e=void 0!==s?ht(s,o):Fi.get(t)===Ti?il(i,o):void 0),a.length>0&&(a=Dn(a,void 0===e?{length:o}:e).quantiles()),ml(t,0,{domain:a,range:e,reverse:c,unknown:l})}(t,n,e);case"quantize":return function(t,n,{range:e,n:r=(void 0===e?5:(e=[...e]).length),scheme:o="rdylbu",domain:i=gl(t,n),unknown:a,interpolate:l,reverse:s}){const[c,u]=qn(i);let f;return void 0===e?(f=_n(c,u,r),f[0]<=c&&f.splice(0,1),f[f.length-1]>=u&&f.pop(),r=f.length+1,e=void 0!==l?ht(l,r):Fi.get(t)===Ti?il(o,r):void 0):(f=ht(Pn(c,u),r+1).slice(1,-1),c instanceof Date&&(f=f.map((t=>new Date(t))))),Dr(Fo(i))<0&&f.reverse(),ml(t,0,{domain:f,range:e,reverse:s,unknown:a})}(t,n,e);case"pow":return pl(t,n,e);case"log":return function(t,n,{base:e=10,domain:r=bl(n),...o}){return dl(t,Bn().base(e),n,{...o,domain:r})}(t,n,e);case"symlog":return function(t,n,{constant:e=1,...r}){return dl(t,Fn().constant(e),n,r)}(t,n,e);case"utc":return function(t,n,e){return Tl(t,oe(),n,e)}(t,n,e);case"time":return function(t,n,e){return Tl(t,re(),n,e)}(t,n,e);case"point":return function(t,n,{align:e=.5,padding:r=.5,...o}){return jl(le().align(e).padding(r),n,o,t)}(t,n,e);case"band":return function(t,n,{align:e=.5,padding:r=.1,paddingInner:o=r,paddingOuter:i=("fx"===t||"fy"===t?0:r),...a}){return jl(se().align(e).paddingInner(o).paddingOuter(i),n,a,t)}(t,n,e);case"identity":return function(t){return{type:"identity",scale:(n=Fi.get(t),n===Ci||n===Ri||n===Ii||n===Wi?Yn():t=>t)};var n}(t);case void 0:return;default:throw new Error(`unknown scale type: ${r}`)}}function Kl(t){return"symbol"==typeof t?t.description:t}function Ql(t){return"string"==typeof t?`${t}`.toLowerCase():t}const ts={toString:()=>"projection"};function ns(t){switch(t){case Ci:return"point";case Ti:return Rl;default:return"ordinal"}}function es({type:t}){return"ordinal"===t||"point"===t||"band"===t||t===Rl}function rs({type:t}){return"threshold"===t}function os(t){if(void 0===t)return!0;const n=t.domain(),e=t(n[0]);for(let r=1,o=n.length;r<o;++r)if(t(n[r])-e)return!1;return!0}function is(t,{domain:n,...e},r){for(const e of t)void 0!==e.value&&(void 0===n&&(n=e.value?.domain),e.value=r(e.value));return{domain:void 0===n?n:r(n),...e}}function as(t){return Do(t,Hi)}function ls(t={}){let n;for(const e in t)if(Fi.has(e)&&Yo(t[e])){if(void 0!==n)throw new Error("ambiguous scale definition; multiple scales found");n=ss(Zl(e,t[e]))}if(void 0===n)throw new Error("invalid scale definition; no scale found");return n}function ss({scale:t,type:n,domain:e,range:r,interpolate:o,interval:i,transform:a,percent:l,pivot:s}){if("identity"===n)return{type:"identity",apply:t=>t,invert:t=>t};const c=t.unknown?t.unknown():void 0;return{type:n,domain:qo(e),...void 0!==r&&{range:qo(r)},...void 0!==a&&{transform:a},...l&&{percent:l},...void 0!==c&&{unknown:c},...void 0!==i&&{interval:i},...void 0!==o&&{interpolate:o},...t.clamp&&{clamp:t.clamp()},...void 0!==s&&{pivot:s,symmetric:!1},...t.base&&{base:t.base()},...t.exponent&&{exponent:t.exponent()},...t.constant&&{constant:t.constant()},...t.align&&{align:t.align(),round:t.round()},...t.padding&&(t.paddingInner?{paddingInner:t.paddingInner(),paddingOuter:t.paddingOuter()}:{padding:t.padding()}),...t.bandwidth&&{bandwidth:t.bandwidth(),step:t.step()},apply:n=>t(n),...t.invert&&{invert:n=>t.invert(n)}}}function cs(t,{fx:n,fy:e}){const r=Ko(t),o=n?.value,i=e?.value;return n&&e?Q(r,(t=>(t.fx=o[t[0]],t.fy=i[t[0]],t)),(t=>o[t]),(t=>i[t])):n?Q(r,(t=>(t.fx=o[t[0]],t)),(t=>o[t])):Q(r,(t=>(t.fy=i[t[0]],t)),(t=>i[t]))}function us(t){const n=[],e=new Uint32Array(tt(t,(t=>t.length)));for(const r of t){let o=0;for(const n of t)r!==n&&(e.set(n,o),o+=n.length);n.push(e.slice(0,o))}return n}const fs=new Map([["top",ys],["right",xs],["bottom",gs],["left",vs],["top-left",ws(ys,vs)],["top-right",ws(ys,xs)],["bottom-left",ws(gs,vs)],["bottom-right",ws(gs,xs)],["top-empty",function(t,{y:n},{x:e,y:r,empty:o}){if(o)return!1;if(!n)return;const i=ps(n,r);if(i>0)return ms(t,e,n[i-1])}],["right-empty",function(t,{x:n},{x:e,y:r,empty:o}){if(o)return!1;if(!n)return;const i=ps(n,e);if(i<n.length-1)return ms(t,n[i+1],r)}],["bottom-empty",function(t,{y:n},{x:e,y:r,empty:o}){if(o)return!1;if(!n)return;const i=ps(n,r);if(i<n.length-1)return ms(t,e,n[i+1])}],["left-empty",function(t,{x:n},{x:e,y:r,empty:o}){if(o)return!1;if(!n)return;const i=ps(n,e);if(i>0)return ms(t,n[i-1],r)}],["empty",function(t,n,{empty:e}){return e}]]);const hs=new WeakMap;function ds(t){let n=hs.get(t);return n||hs.set(t,n=new he(Do(t,((t,n)=>[t,n])))),n}function ps(t,n){return ds(t).get(n)}function ms(t,n,e){return function(t,n,e){return n=ei(n),e=ei(e),t.find((t=>Object.is(ei(t.x),n)&&Object.is(ei(t.y),e)))}(t,n,e)?.empty}function ys(t,{y:n},{y:e}){return!n||0===ps(n,e)}function gs(t,{y:n},{y:e}){return!n||ps(n,e)===n.length-1}function vs(t,{x:n},{x:e}){return!n||0===ps(n,e)}function xs(t,{x:n},{x:e}){return!n||ps(n,e)===n.length-1}function ws(t,n){return function(){return t.apply(null,arguments)&&n.apply(null,arguments)}}function bs(t,{channels:{fx:n,fy:e},groups:r}){return n&&e?t.map((({x:t,y:n})=>r.get(t)?.get(n)??[])):n?t.map((({x:t})=>r.get(t)??[])):t.map((({y:t})=>r.get(t)??[]))}const ks=Math.PI,$s=2*ks,Ms=.618;function Ls({projection:t,inset:n=0,insetTop:e=n,insetRight:r=n,insetBottom:o=n,insetLeft:i=n}={},a){if(null==t)return;if("function"==typeof t.stream)return t;let l,s,c="frame";if(Ho(t)){let n;if(({type:t,domain:s,inset:n,insetTop:e=(void 0!==n?n:e),insetRight:r=(void 0!==n?n:r),insetBottom:o=(void 0!==n?n:o),insetLeft:i=(void 0!==n?n:i),clip:c=c,...l}=t),null==t)return}"function"!=typeof t&&({type:t}=As(t));const{width:u,height:f,marginLeft:h,marginRight:d,marginTop:p,marginBottom:m}=a,y=u-h-d-i-r,g=f-p-m-e-o;if(t=t?.({width:y,height:g,clip:c,...l}),null==t)return;c=function(t,n,e,r,o){if(!1===t||null==t||"number"==typeof t)return t=>t;!0===t&&(t="frame");if("frame"===`${t}`.toLowerCase())return me(n,e,r,o);throw new Error(`unknown projection clip type: ${t}`)}(c,h,p,u-d,f-m);let v,x=h+i,w=p+e;if(null!=s){const[[n,e],[r,o]]=pe(t).bounds(s),i=Math.min(y/(r-n),g/(o-e));i>0?(x-=(i*(n+r)-y)/2,w-=(i*(e+o)-g)/2,v=de({point(t,n){this.stream.point(t*i+x,n*i+w)}})):Al("Warning: the projection could not be fit to the specified domain; using the default scale.")}return v??=0===x&&0===w?Os():de({point(t,n){this.stream.point(t+x,n+w)}}),{stream:n=>t.stream(v.stream(c(n)))}}function As(t){switch(`${t}`.toLowerCase()){case"albers-usa":return Es(Ae,.7463,.4673);case"albers":return zs(Se,.7463,.4673);case"azimuthal-equal-area":return Es(Le,4,4);case"azimuthal-equidistant":return Es(Me,$s,$s);case"conic-conformal":return zs(Oe,$s,$s);case"conic-equal-area":return zs(ze,6.1702,2.9781);case"conic-equidistant":return zs(Ee,7.312,3.6282);case"equal-earth":return Es($e,5.4133,2.6347);case"equirectangular":return Es(ke,$s,ks);case"gnomonic":return Es(be,3.4641,3.4641);case"identity":return{type:Os};case"reflect-y":return{type:Ss};case"mercator":return Es(we,$s,$s);case"orthographic":return Es(xe,2,2);case"stereographic":return Es(ve,2,2);case"transverse-mercator":return Es(ge,$s,$s);default:throw new Error(`unknown projection type: ${t}`)}}function Es(t,n,e){return{type:({width:r,height:o,rotate:i,precision:a=.15,clip:l})=>{const s=t();return null!=a&&s.precision?.(a),null!=i&&s.rotate?.(i),"number"==typeof l&&s.clipAngle?.(l),s.scale(Math.min(r/n,o/e)),s.translate([r/2,o/2]),s},aspectRatio:e/n}}function zs(t,n,e){const{type:r,aspectRatio:o}=Es(t,n,e);return{type:t=>{const{parallels:n,domain:e,width:o,height:i}=t,a=r(t);return null!=n&&(a.parallels(n),void 0===e&&a.fitSize([o,i],{type:"Sphere"})),a},aspectRatio:o}}const Os=Oo({stream:t=>t}),Ss=Oo(de({point(t,n){this.stream.point(t,-n)}}));function Ns(t,n,e,r){const o=e[t],i=e[n],a=o.length,l=e[t]=new Float64Array(a).fill(NaN),s=e[n]=new Float64Array(a).fill(NaN);let c;const u=r.stream({point(t,n){l[c]=t,s[c]=n}});for(c=0;c<a;++c)u.point(o[c],i[c])}function Cs({projection:t}={}){return null!=t&&("function"==typeof t.stream||(Ho(t)&&(t=t.type),null!=t))}function Ts(t,n,{projection:e}){const{x:r,y:o}=t;let i={};return r&&(i.x=r),o&&(i.y=o),i=qa(i,n),e&&"x"===r?.scale&&"y"===o?.scale&&Ns("x","y",i,e),r&&(i.x=No(i.x)),o&&(i.y=No(i.y)),i}function Rs(t){const n=[],e=[],r={scale:"x",value:n},o={scale:"y",value:e},i={point(t,r){n.push(t),e.push(r)},lineStart(){},lineEnd(){},polygonStart(){},polygonEnd(){},sphere(){}};for(const n of t.value)ye(n,i);return[r,o]}function Is(t={}){const{document:n=("undefined"!=typeof window?window.document:void 0),clip:e}=t;return{document:n,clip:Ni(e)}}function Ws(t,{document:n}){return Ne(Ce(t).call(n.documentElement))}function js(t){let n,e;return(...r)=>((e?.length!==r.length||e.some(((t,n)=>t!==r[n])))&&(e=r,n=t(...r)),n)}const Bs=js((t=>new Intl.NumberFormat(t))),Fs=js(((t,n)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...n&&{month:n}}))),Ds=js(((t,n)=>new Intl.DateTimeFormat(t,{timeZone:"UTC",...n&&{weekday:n}})));function qs(t="en-US"){const n=Bs(t);return t=>null==t||isNaN(t)?void 0:n.format(t)}function _s(t="en-US",n="short"){const e=Fs(t,n);return t=>null==t||isNaN(t=+new Date(Date.UTC(2e3,+t)))?void 0:e.format(t)}function Ps(t="en-US",n="short"){const e=Ds(t,n);return t=>null==t||isNaN(t=+new Date(Date.UTC(2001,0,+t)))?void 0:e.format(t)}function Vs(t){return Nr(t,"Invalid Date")}const Hs=function(t="en-US"){const n=qs(t);return t=>(t instanceof Date?Vs:"number"==typeof t?n:Mo)(t)}(),Ys=("undefined"!=typeof window?window.devicePixelRatio>1:"undefined"==typeof it)?0:.5;let Us=0;function Xs(){return"plot-clip-"+ ++Us}function Gs(t,{title:n,href:e,ariaLabel:r,ariaDescription:o,ariaHidden:i,target:a,fill:l,fillOpacity:s,stroke:c,strokeWidth:u,strokeOpacity:f,strokeLinejoin:h,strokeLinecap:d,strokeMiterlimit:p,strokeDasharray:m,strokeDashoffset:y,opacity:g,mixBlendMode:v,imageFilter:x,paintOrder:w,pointerEvents:b,shapeRendering:k,channels:$},{ariaLabel:M,fill:L="currentColor",fillOpacity:A,stroke:E="none",strokeOpacity:z,strokeWidth:O,strokeLinecap:S,strokeLinejoin:N,strokeMiterlimit:C,paintOrder:T}){null===L&&(l=null,s=null),null===E&&(c=null,f=null),Ai(L)?Ai(E)||Ai(l)&&!$?.fill||(E="none"):!Ai(E)||Ai(c)&&!$?.stroke||(L="none");const[R,I]=Io(l,L),[W,j]=Wo(s,A),[B,F]=Io(c,E),[D,q]=Wo(f,z),[_,P]=Wo(g);Ei(F)||(void 0===u&&(u=O),void 0===d&&(d=S),void 0===h&&(h=N),void 0!==p||/^\s*round\s*$/i.test(h)||(p=C),Ei(I)||void 0!==w||(w=T));const[V,H]=Wo(u);return null!==L&&(t.fill=lc(I,"currentColor"),t.fillOpacity=sc(j,1)),null!==E&&(t.stroke=lc(F,"none"),t.strokeWidth=sc(H,1),t.strokeOpacity=sc(q,1),t.strokeLinejoin=lc(h,"miter"),t.strokeLinecap=lc(d,"butt"),t.strokeMiterlimit=sc(p,4),t.strokeDasharray=lc(m,"none"),t.strokeDashoffset=lc(y,"0")),t.target=Mo(a),t.ariaLabel=Mo(M),t.ariaDescription=Mo(o),t.ariaHidden=Mo(i),t.opacity=sc(P,1),t.mixBlendMode=lc(v,"normal"),t.imageFilter=lc(x,"none"),t.paintOrder=lc(w,"normal"),t.pointerEvents=lc(b,"auto"),t.shapeRendering=lc(k,"auto"),{title:{value:n,optional:!0,filter:null},href:{value:e,optional:!0,filter:null},ariaLabel:{value:r,optional:!0,filter:null},fill:{value:R,scale:"auto",optional:!0},fillOpacity:{value:W,scale:"auto",optional:!0},stroke:{value:B,scale:"auto",optional:!0},strokeOpacity:{value:D,scale:"auto",optional:!0},strokeWidth:{value:V,optional:!0},opacity:{value:_,scale:"auto",optional:!0}}}function Zs(t,n){n&&t.text((t=>Hs(n[t])))}function Js(t,n){n&&t.text((([t])=>Hs(n[t])))}function Ks(t,{target:n,tip:e},{ariaLabel:r,title:o,fill:i,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:c,opacity:u,href:f}){r&&ic(t,"aria-label",(t=>r[t])),i&&ic(t,"fill",(t=>i[t])),a&&ic(t,"fill-opacity",(t=>a[t])),l&&ic(t,"stroke",(t=>l[t])),s&&ic(t,"stroke-opacity",(t=>s[t])),c&&ic(t,"stroke-width",(t=>c[t])),u&&ic(t,"opacity",(t=>u[t])),f&&oc(t,(t=>f[t]),n),e||function(t,n){n&&t.filter((t=>Wr(n[t]))).append("title").call(Zs,n)}(t,o)}function Qs(t,{target:n,tip:e},{ariaLabel:r,title:o,fill:i,fillOpacity:a,stroke:l,strokeOpacity:s,strokeWidth:c,opacity:u,href:f}){r&&ic(t,"aria-label",(([t])=>r[t])),i&&ic(t,"fill",(([t])=>i[t])),a&&ic(t,"fill-opacity",(([t])=>a[t])),l&&ic(t,"stroke",(([t])=>l[t])),s&&ic(t,"stroke-opacity",(([t])=>s[t])),c&&ic(t,"stroke-width",(([t])=>c[t])),u&&ic(t,"opacity",(([t])=>u[t])),f&&oc(t,(([t])=>f[t]),n),e||function(t,n){n&&t.filter((([t])=>Wr(n[t]))).append("title").call(Js,n)}(t,o)}function tc(t,n,e){const r=J(t,(t=>n[t]));return void 0===e&&r.size>1+t.length>>1&&Al("Warning: the implicit z channel has high cardinality. This may occur when the fill or stroke channel is associated with quantitative data rather than ordinal or categorical data. You can suppress this warning by setting the z option explicitly; if this data represents a single series, set z to null."),r.values()}function*nc(t,n,e,r){const{z:o}=e,{z:i}=r,a=function({ariaLabel:t,title:n,fill:e,fillOpacity:r,stroke:o,strokeOpacity:i,strokeWidth:a,opacity:l,href:s},{tip:c}){return[t,c?void 0:n,e,r,o,i,a,l,s].filter((t=>void 0!==t))}(r,e),l=[...n,...a];for(const n of i?tc(t,i,o):[t]){let t,e;t:for(const r of n){for(const t of l)if(!Tr(t[r])){e&&e.push(-1);continue t}if(void 0!==t){e.push(r);for(let n=0;n<a.length;++n){if(ei(a[n][r])!==t[n]){yield e,t=a.map((t=>ei(t[r]))),e=[r];continue t}}}else e&&(yield e),t=a.map((t=>ei(t[r]))),e=[r]}e&&(yield e)}}function ec(t,n,e,r){!function(t,n,e,r){let o;const{clip:i=r.clip}=n;switch(i){case"frame":{const{width:n,height:i,marginLeft:a,marginRight:l,marginTop:s,marginBottom:c}=e,u=Xs();o=`url(#${u})`,t=Ws("svg:g",r).call((t=>t.append("svg:clipPath").attr("id",u).append("rect").attr("x",a).attr("y",s).attr("width",n-l-a).attr("height",i-s-c))).each((function(){this.appendChild(t.node()),t.node=()=>this}));break}case"sphere":{const{projection:n}=r;if(!n)throw new Error('the "sphere" clip option requires a projection');const e=Xs();o=`url(#${e})`,t.append("clipPath").attr("id",e).append("path").attr("d",pe(n)({type:"Sphere"}));break}}ic(t,"aria-label",n.ariaLabel),ic(t,"aria-description",n.ariaDescription),ic(t,"aria-hidden",n.ariaHidden),ic(t,"clip-path",o)}(t,n,e,r),ic(t,"fill",n.fill),ic(t,"fill-opacity",n.fillOpacity),ic(t,"stroke",n.stroke),ic(t,"stroke-width",n.strokeWidth),ic(t,"stroke-opacity",n.strokeOpacity),ic(t,"stroke-linejoin",n.strokeLinejoin),ic(t,"stroke-linecap",n.strokeLinecap),ic(t,"stroke-miterlimit",n.strokeMiterlimit),ic(t,"stroke-dasharray",n.strokeDasharray),ic(t,"stroke-dashoffset",n.strokeDashoffset),ic(t,"shape-rendering",n.shapeRendering),ic(t,"filter",n.imageFilter),ic(t,"paint-order",n.paintOrder);const{pointerEvents:o=(!1===r.pointerSticky?"none":void 0)}=n;ic(t,"pointer-events",o)}function rc(t,n){!function(t,n,e){null!=e&&t.style(n,e)}(t,"mix-blend-mode",n.mixBlendMode),ic(t,"opacity",n.opacity)}function oc(t,n,e){t.each((function(t){const r=n(t);if(null!=r){const t=this.ownerDocument.createElementNS(Te.svg,"a");t.setAttribute("fill","inherit"),t.setAttributeNS(Te.xlink,"href",r),null!=e&&t.setAttribute("target",e),this.parentNode.insertBefore(t,this).appendChild(this)}}))}function ic(t,n,e){null!=e&&t.attr(n,e)}function ac(t,n,{x:e,y:r},o=Ys,i=Ys){o+=n.dx,i+=n.dy,e?.bandwidth&&(o+=e.bandwidth()/2),r?.bandwidth&&(i+=r.bandwidth()/2),(o||i)&&t.attr("transform",`translate(${o},${i})`)}function lc(t,n){if((t=Mo(t))!==n)return t}function sc(t,n){if((t=Lo(t))!==n)return t}const cc=/^-?([_a-z]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])([_a-z0-9-]|[\240-\377]|\\[0-9a-f]{1,6}(\r\n|[ \t\r\n\f])?|\\[^\r\n\f0-9a-f])*$/i;function uc(t){if(void 0===t)return"plot-d6a7b5";if(t=`${t}`,!cc.test(t))throw new Error(`invalid class name: ${t}`);return t}function fc(t,n){if("string"==typeof n)t.property("style",n);else if(null!=n)for(const e of t)Object.assign(e.style,n)}function hc({frameAnchor:t},{width:n,height:e,marginTop:r,marginRight:o,marginBottom:i,marginLeft:a}){return[/left$/.test(t)?a:/right$/.test(t)?n-o:(a+n-o)/2,/^top/.test(t)?r:/^bottom/.test(t)?e-i:(r+e-i)/2]}class dc{constructor(t,n={},e={},r){const{facet:o="auto",facetAnchor:i,fx:a,fy:l,sort:s,dx:c=0,dy:u=0,margin:f=0,marginTop:h=f,marginRight:d=f,marginBottom:p=f,marginLeft:m=f,clip:y=r?.clip,channels:g,tip:v,render:x}=e;if(this.data=t,this.sort=Xo(s)?s:null,this.initializer=Ui(e).initializer,this.transform=this.initializer?e.transform:Yi(e).transform,null===o||!1===o?this.facet=null:(this.facet=Bo(!0===o?"include":o,"facet",["auto","include","exclude","super"]),this.fx=t===vo&&"string"==typeof a?[a]:a,this.fy=t===vo&&"string"==typeof l?[l]:l),this.facetAnchor=function(t){if(null==t)return null;const n=fs.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid facet anchor: ${t}`)}(i),n=Si(n),void 0!==g&&(n={...yc(g),...n}),void 0!==r&&(n={...Gs(this,e,r),...n}),this.channels=Object.fromEntries(Object.entries(n).map((([n,e])=>{if(Uo(e.value)){const{value:t,label:n=e.label,scale:r=e.scale}=e.value;e={...e,label:n,scale:r,value:t}}if(t===vo&&"string"==typeof e.value){const{value:t}=e;e={...e,value:[t]}}return[n,e]})).filter((([t,{value:n,optional:e}])=>{if(null!=n)return!0;if(e)return!1;throw new Error(`missing channel value: ${t}`)}))),this.dx=+c,this.dy=+u,this.marginTop=+h,this.marginRight=+d,this.marginBottom=+p,this.marginLeft=+m,this.clip=Ni(y),this.tip=function(t){return!0===t?"xy":!1===t||null==t?null:"string"==typeof t?Bo(t,"tip",["x","y","xy"]):t}(v),"super"===this.facet){if(a||l)throw new Error("super-faceting cannot use fx or fy");for(const t in this.channels){const{scale:e}=n[t];if("x"===e||"y"===e)throw new Error("super-faceting cannot use x or y")}}null!=x&&(this.render=mc(x,this.render))}initialize(t,n,e){let r=Fo(this.data);void 0===t&&null!=r&&(t=[Ko(r)]);const o=t;null!=this.transform&&(({facets:t,data:r}=this.transform(r,t,e)),r=Fo(r)),void 0!==t&&(t.original=o);const i=Da(this.channels,r);return null!=this.sort&&function(t,n,e,r,o){const{order:i,reverse:a,reduce:l=!0,limit:s}=o;for(const c in o){if(!Fi.has(c))continue;let{value:u,order:f=i,reverse:h=a,reduce:d=l,limit:p=s}=pi(o[c]);const m=u?.startsWith("-");if(m&&(u=u.slice(1)),f=void 0===f?m!==("width"===u||"height"===u)?Ga:Xa:Ua(f),null==d||!1===d)continue;const y="fx"===c||"fy"===c?Va(n,r[c]):Pa(e,c);if(!y)throw new Error(`missing channel for scale: ${c}`);const g=y.value,[v=0,x=1/0]=mi(p)?p:p<0?[p]:[0,p];if(null==u)y.domain=()=>{let t=Array.from(new nt(g));return h&&(t=t.reverse()),0===v&&x===1/0||(t=t.slice(v,x)),t};else{const n="data"===u?t:"height"===u?Ha(e,"y1","y2"):"width"===u?Ha(e,"x1","x2"):Ya(e,u,"y"===u?"y2":"x"===u?"x2":void 0),r=ya(!0===d?"max":d,n);y.domain=()=>{let t=ft(Ko(g),(t=>r.reduceIndex(t,n)),(t=>g[t]));return f&&t.sort(f),h&&t.reverse(),0===v&&x===1/0||(t=t.slice(v,x)),t.map(Ao)}}}}(r,t,i,n,this.sort),{data:r,facets:t,channels:i}}filter(t,n,e){for(const r in n){const{filter:o=Tr}=n[r];if(null!==o){const n=e[r];t=t.filter((t=>o(n[t])))}}return t}project(t,n,e){for(const r in t)if("x"===t[r].scale&&/^x|x$/.test(r)){const o=r.replace(/^x|x$/,"y");o in t&&"y"===t[o].scale&&Ns(r,o,n,e.projection)}}scale(t,n,e){const r=qa(t,n);return e.projection&&this.project(t,r,e),r}}function pc(...t){return t.plot=dc.prototype.plot,t}function mc(t,n){if(null==t)return null===n?void 0:n;if(null==n)return null===t?void 0:t;if("function"!=typeof t)throw new TypeError(`invalid render transform: ${t}`);if("function"!=typeof n)throw new TypeError(`invalid render transform: ${n}`);return function(e,r,o,i,a,l){return t.call(this,e,r,o,i,a,((t,e,r,o,i)=>n.call(this,t,e,r,o,i,l)))}}function yc(t){return Object.fromEntries(Object.entries(Si(t)).map((([t,n])=>(void 0===(n="string"==typeof n?{value:n,label:t}:pi(n)).filter&&null==n.scale&&(n={...n,filter:null}),[t,n]))))}function gc(t,n){return!0===t?.tip?{...t,tip:n}:Ho(t?.tip)&&void 0===t.tip.pointer?{...t,tip:{...t.tip,pointer:n}}:t}function vc({x:t,y:n,fy:e,fx:r},{projection:o,aspectRatio:i},{width:a,marginTopDefault:l,marginRightDefault:s,marginBottomDefault:c,marginLeftDefault:u}){const f=e?e.scale.domain().length:1,h=function(t){if("function"==typeof t?.stream)return Ms;if(Ho(t)&&(t=t.type),null!=t){if("function"!=typeof t){const{aspectRatio:n}=As(t);if(n)return n}return Ms}}(o);if(h){const t=(1.1*f-.1)/(1.1*(r?r.scale.domain().length:1)-.1)*h,n=Math.max(.1,Math.min(10,t));return Math.round((a-u-s)*n+l+c)}const d=n?es(n)?n.scale.domain().length:Math.max(7,17/f):1;if(null!=i){if(i=+i,!(isFinite(i)&&i>0))throw new Error(`invalid aspectRatio: ${i}`);const o=xc("y",n)/(xc("x",t)*i),f=r?r.scale.bandwidth():1,h=e?e.scale.bandwidth():1;return(o*(f*(a-u-s)-t.insetLeft-t.insetRight)+n.insetTop+n.insetBottom)/h+l+c}return!(!n&&!e)*Math.max(1,Math.min(60,d*f))*20+30*!!r+60}function xc(t,n){if(!n)throw new Error(`aspectRatio requires ${t} scale`);const{type:e,domain:r}=n;let o;switch(e){case"linear":case"utc":case"time":o=Number;break;case"pow":{const t=n.scale.exponent();o=n=>Math.pow(n,t);break}case"log":o=Math.log;break;case"point":case"band":return r.length;default:throw new Error(`unsupported ${t} scale for aspectRatio: ${e}`)}const[i,a]=qn(r);return Math.abs(o(a)-o(i))}const wc=new WeakMap;function bc(t,n,{x:e,y:r,px:o,py:i,maxRadius:a=40,channels:l,render:s,...c}={}){return a=+a,null!=o&&(e??=null,l={...l,px:{value:o,scale:"x"}}),null!=i&&(r??=null,l={...l,py:{value:i,scale:"y"}}),{x:e,y:r,channels:l,...c,render:mc((function(e,r,o,i,l,s){const c=(l={...l,pointerSticky:!1}).ownerSVGElement,{data:u}=l.getMarkState(this);let f=wc.get(c);f||wc.set(c,f={sticky:!1,roots:[],renders:[]});let h=f.renders.push(C)-1;const{x:d,y:p,fx:m,fy:y}=r;let g=m?m(e.fx)-i.marginLeft:0,v=y?y(e.fy)-i.marginTop:0;d?.bandwidth&&(g+=d.bandwidth()/2),p?.bandwidth&&(v+=p.bandwidth()/2);const x=null!=e.fi;let w;if(x){let t=f.facetStates;t||(f.facetStates=t=new Map),w=t.get(this),w||t.set(this,w=new Map)}const[b,k]=hc(this,i),{px:$,py:M}=o,L=$?t=>$[t]:Lc(o,b),A=M?t=>M[t]:Ac(o,k);let E,z,O,S;function N(t,n){if(x){if(S&&(S=cancelAnimationFrame(S)),null!=t)return w.set(e.fi,n),void(S=requestAnimationFrame((()=>{S=null;for(const[r,o]of w)if(o<n||o===n&&r<e.fi){t=null;break}C(t)})));w.delete(e.fi)}C(t)}function C(t){if(E===t&&O===f.sticky)return;E=t,O=l.pointerSticky=f.sticky;const n=null==E?[]:[E];x&&(n.fx=e.fx,n.fy=e.fy,n.fi=e.fi);const a=s(n,r,o,i,l);if(z){if(x){const t=z.parentNode,n=z.getAttribute("transform"),e=a.getAttribute("transform");n?a.setAttribute("transform",n):a.removeAttribute("transform"),e?t.setAttribute("transform",e):t.removeAttribute("transform"),a.removeAttribute("aria-label"),a.removeAttribute("aria-description"),a.removeAttribute("aria-hidden")}z.replaceWith(a)}return f.roots[h]=z=a,null==E&&w?.size>1||l.dispatchValue(null==E?null:u[E]),a}function T(r){if(f.sticky||"mouse"===r.pointerType&&1===r.buttons)return;let[o,l]=Re(r);o-=g,l-=v;const s=o<i.marginLeft||o>i.width-i.marginRight?1:t,c=l<i.marginTop||l>i.height-i.marginBottom?1:n;let u=null,h=a*a;for(const t of e){const n=s*(L(t)-o),e=c*(A(t)-l),r=n*n+e*e;r<=h&&(u=t,h=r)}if(null!=u&&(1!==t||1!==n)){const t=L(u)-o,n=A(u)-l;h=t*t+n*n}N(u,h)}return c.addEventListener("pointerenter",T),c.addEventListener("pointermove",T),c.addEventListener("pointerdown",(function(t){"mouse"===t.pointerType&&null!=E&&(f.sticky&&f.roots.some((n=>n?.contains(t.target)))||(f.sticky?(f.sticky=!1,f.renders.forEach((t=>t(null)))):(f.sticky=!0,C(E)),t.stopImmediatePropagation()))})),c.addEventListener("pointerleave",(function(t){"mouse"===t.pointerType&&(f.sticky||N(null))})),C(null)}),s)}}function kc(t){return bc(1,1,t)}function $c(t){return bc(1,.01,t)}function Mc(t){return bc(.01,1,t)}function Lc({x1:t,x2:n,x:e=t},r){return t&&n?e=>(t[e]+n[e])/2:e?t=>e[t]:()=>r}function Ac({y1:t,y2:n,y:e=t},r){return t&&n?e=>(t[e]+n[e])/2:e?t=>e[t]:()=>r}function Ec(t){return es(t)&&void 0===t.interval?void 0:"tabular-nums"}const zc=Math.PI/180;function Oc(t,{marker:n,markerStart:e=n,markerMid:r=n,markerEnd:o=n}={}){t.markerStart=Sc(e),t.markerMid=Sc(r),t.markerEnd=Sc(o)}function Sc(t){if(null==t||!1===t)return null;if(!0===t)return Tc;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"none":return null;case"arrow":return Nc("auto");case"arrow-reverse":return Nc("auto-start-reverse");case"dot":return Cc;case"circle":case"circle-fill":return Tc;case"circle-stroke":return Rc;case"tick":return Ic("auto");case"tick-x":return Ic(90);case"tick-y":return Ic(0)}throw new Error(`invalid marker: ${t}`)}function Nc(t){return(n,e)=>Ws("svg:marker",e).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("orient",t).attr("fill","none").attr("stroke",n).attr("stroke-width",1.5).attr("stroke-linecap","round").attr("stroke-linejoin","round").call((t=>t.append("path").attr("d","M-1.5,-3l3,3l-3,3"))).node()}function Cc(t,n){return Ws("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","none").call((t=>t.append("circle").attr("r",2.5))).node()}function Tc(t,n){return Ws("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill",t).attr("stroke","var(--plot-background)").attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function Rc(t,n){return Ws("svg:marker",n).attr("viewBox","-5 -5 10 10").attr("markerWidth",6.67).attr("markerHeight",6.67).attr("fill","var(--plot-background)").attr("stroke",t).attr("stroke-width",1.5).call((t=>t.append("circle").attr("r",3))).node()}function Ic(t){return(n,e)=>Ws("svg:marker",e).attr("viewBox","-3 -3 6 6").attr("markerWidth",6).attr("markerHeight",6).attr("orient",t).attr("stroke",n).call((t=>t.append("path").attr("d","M0,-3v6"))).node()}let Wc=0;function jc(t,n,{stroke:e},r){return Fc(t,n,e&&(t=>e[t]),r)}function Bc(t,n,{stroke:e},r){return Fc(t,n,e&&(([t])=>e[t]),r)}function Fc(t,{markerStart:n,markerMid:e,markerEnd:r,stroke:o},i=(()=>o),a){const l=new Map;function s(t){return function(n){const e=i(n);let r=l.get(t);r||l.set(t,r=new Map);let o=r.get(e);if(!o){const n=this.parentNode.insertBefore(t(e,a),this),i="plot-marker-"+ ++Wc;n.setAttribute("id",i),r.set(e,o=`url(#${i})`)}return o}}n&&t.attr("marker-start",s(n)),e&&t.attr("marker-mid",s(e)),r&&t.attr("marker-end",s(r))}function Dc({inset:t,insetLeft:n,insetRight:e,...r}={}){return[n,e]=_c(t,n,e),{inset:t,insetLeft:n,insetRight:e,...r}}function qc({inset:t,insetTop:n,insetBottom:e,...r}={}){return[n,e]=_c(t,n,e),{inset:t,insetTop:n,insetBottom:e,...r}}function _c(t,n,e){return void 0===t&&void 0===n&&void 0===e?Ys?[1,0]:[.5,.5]:[n,e]}function Pc(t,{interval:n}){return(t={...pi(t)}).interval=ui(void 0===t.interval?n:t.interval),t}function Vc(t,n,e,r){const{[t]:o,[`${t}1`]:i,[`${t}2`]:a}=e,{value:l,interval:s}=Pc(o,e);if(null==l||null==s&&!r)return e;const c=ai(o);if(null==s){let n;const o={transform:t=>n||(n=mo(t,l)),label:c};return{...e,[t]:void 0,[`${t}1`]:void 0===i?o:i,[`${t}2`]:void 0!==a||i===a&&r?a:o}}let u,f;function h(t){return void 0!==f&&t===u?f:f=Do(mo(u=t,l),(t=>s.floor(t)))}return n({...e,[t]:void 0,[`${t}1`]:void 0===i?{transform:h,label:c}:i,[`${t}2`]:void 0===a?{transform:t=>h(t).map((t=>s.offset(t))),label:c}:a})}function Hc(t,n,e){const{[t]:r}=e,{value:o,interval:i}=Pc(r,e);return null==o||null==i?e:n({...e,[t]:{label:ai(r),transform:t=>{const n=Do(mo(t,o),(t=>i.floor(t))),e=n.map((t=>i.offset(t)));return n.map(vi(n)?(t,n)=>null==t||isNaN(t=+t)||null==(n=e[n])||isNaN(n=+n)?void 0:new Date((t+n)/2):(t,n)=>null==t||null==(n=e[n])?NaN:(+t+ +n)/2)}}})}function Yc(t={}){return Vc("x",Dc,t,!0)}function Uc(t={}){return Vc("y",qc,t,!0)}function Xc(t={}){return Vc("x",Dc,t)}function Gc(t={}){return Vc("y",qc,t)}function Zc(t={}){return Hc("x",Dc,t)}function Jc(t={}){return Hc("y",qc,t)}const Kc={ariaLabel:"rule",fill:null,stroke:"currentColor"};class Qc extends dc{constructor(t,n={}){const{x:e,y1:r,y2:o,inset:i=0,insetTop:a=i,insetBottom:l=i}=n;super(t,{x:{value:e,scale:"x",optional:!0},y1:{value:r,scale:"y",optional:!0},y2:{value:o,scale:"y",optional:!0}},gc(n,"x"),Kc),this.insetTop=Lo(a),this.insetBottom=Lo(l),Oc(this,n)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y1:s,y2:c}=e,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetTop:y,insetBottom:g}=this;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i},Ys,0).call((n=>n.selectAll().data(t).enter().append("line").call(rc,this).attr("x1",l?t=>l[t]:(p+u-d)/2).attr("x2",l?t=>l[t]:(p+u-d)/2).attr("y1",s&&!os(a)?t=>s[t]+y:h+y).attr("y2",c&&!os(a)?a.bandwidth?t=>c[t]+a.bandwidth()-g:t=>c[t]-g:f-m-g).call(Ks,this,e).call(jc,this,e,o))).node()}}class tu extends dc{constructor(t,n={}){const{x1:e,x2:r,y:o,inset:i=0,insetRight:a=i,insetLeft:l=i}=n;super(t,{y:{value:o,scale:"y",optional:!0},x1:{value:e,scale:"x",optional:!0},x2:{value:r,scale:"x",optional:!0}},gc(n,"y"),Kc),this.insetRight=Lo(a),this.insetLeft=Lo(l),Oc(this,n)}render(t,n,e,r,o){const{x:i,y:a}=n,{y:l,x1:s,x2:c}=e,{width:u,height:f,marginTop:h,marginRight:d,marginLeft:p,marginBottom:m}=r,{insetLeft:y,insetRight:g}=this;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{y:l&&a},0,Ys).call((n=>n.selectAll().data(t).enter().append("line").call(rc,this).attr("x1",s&&!os(i)?t=>s[t]+y:p+y).attr("x2",c&&!os(i)?i.bandwidth?t=>c[t]+i.bandwidth()-g:t=>c[t]-g:u-d-g).attr("y1",l?t=>l[t]:(h+f-m)/2).attr("y2",l?t=>l[t]:(h+f-m)/2).call(Ks,this,e).call(jc,this,e,o))).node()}}function nu(t,n){let{x:e=bo,y:r,y1:o,y2:i,...a}=Gc(n);return[o,i]=ru(r,o,i),new Qc(t,{...a,x:e,y1:o,y2:i})}function eu(t,n){let{y:e=bo,x:r,x1:o,x2:i,...a}=Xc(n);return[o,i]=ru(r,o,i),new tu(t,{...a,y:e,x1:o,x2:i})}function ru(t,n,e){if(null==t){if(void 0===n){if(void 0!==e)return[0,e]}else if(void 0===e)return[0,n]}else{if(void 0===n)return void 0===e?[0,t]:[t,e];if(void 0===e)return[t,n]}return[n,e]}function ou(t,...n){let e=n.length;for(let r=0,o=!0;r<e;++r)"function"!=typeof n[r]&&(o&&(t=t.slice(),o=!1),t.splice(r,2,t[r]+n[r]+t[r+1]),n.splice(r,1),--r,--e);return r=>{let o=t[0];for(let i=0;i<e;++i)o+=n[i](r)+t[i+1];return o}}const iu={ariaLabel:"text",strokeLinejoin:"round",strokeWidth:3,paintOrder:"stroke"},au="­";class lu extends dc{constructor(t,n={}){const{x:e,y:r,text:o=(mi(t)&&yi(t)?bo:wo),frameAnchor:i,textAnchor:a=(/right$/i.test(i)?"end":/left$/i.test(i)?"start":"middle"),lineAnchor:l=(/^top/i.test(i)?"top":/^bottom/i.test(i)?"bottom":"middle"),lineHeight:s=1,lineWidth:c=1/0,textOverflow:u,monospace:f,fontFamily:h=(f?"ui-monospace, monospace":void 0),fontSize:d,fontStyle:p,fontVariant:m,fontWeight:y,rotate:g}=n,[v,x]=Wo(g,0),[w,b]=function(t){return null==t||"number"==typeof t?[void 0,t]:"string"!=typeof t?[t,void 0]:(t=t.trim().toLowerCase(),pu.has(t)||/^[+-]?\d*\.?\d+(e[+-]?\d+)?(\w*|%)$/.test(t)?[void 0,t]:[t,void 0])}(d);var k;if(super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},fontSize:{value:w,optional:!0},rotate:{value:(k=v,null==k?null:{transform:t=>mo(t,k,Float64Array),label:ai(k)}),optional:!0},text:{value:o,filter:Wr,optional:!0}},n,iu),this.rotate=x,this.textAnchor=lc(a,"middle"),this.lineAnchor=Bo(l,"lineAnchor",["top","middle","bottom"]),this.lineHeight=+s,this.lineWidth=+c,this.textOverflow=su(u),this.monospace=!!f,this.fontFamily=Mo(h),this.fontSize=b,this.fontStyle=Mo(p),this.fontVariant=Mo(m),this.fontWeight=Mo(y),this.frameAnchor=Oi(i),!(this.lineWidth>=0))throw new Error(`invalid lineWidth: ${c}`);this.splitLines=xu(this),this.clipLine=wu(this)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,rotate:c,text:u,title:f,fontSize:h}=e,{rotate:d}=this,[p,m]=hc(this,r);return Ws("svg:g",o).call(ec,this,r,o).call(du,this,u,r).call(ac,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("text").call(rc,this).call(cu,this,u,f).attr("transform",ou`translate(${l?t=>l[t]:p},${s?t=>s[t]:m})${c?t=>` rotate(${c[t]})`:d?` rotate(${d})`:""}`).call(ic,"font-size",h&&(t=>h[t])).call(Ks,this,e))).node()}}function su(t){return null==t?null:Bo(t,"textOverflow",["clip","ellipsis","clip-start","clip-end","ellipsis-start","ellipsis-middle","ellipsis-end"]).replace(/^(clip|ellipsis)$/,"$1-end")}function cu(t,n,e,r){if(!e)return;const{lineAnchor:o,lineHeight:i,textOverflow:a,splitLines:l,clipLine:s}=n;t.each((function(t){const n=l(Hs(e[t])??"").map(s),c=n.length,u="top"===o?.71:"bottom"===o?1-c:(164-100*c)/200;if(c>1){let t=0;for(let e=0;e<c;++e){if(++t,!n[e])continue;const r=this.ownerDocument.createElementNS(Te.svg,"tspan");r.setAttribute("x",0),e===t-1?r.setAttribute("y",(u+e)*i+"em"):r.setAttribute("dy",t*i+"em"),r.textContent=n[e],this.appendChild(r),t=0}}else u&&this.setAttribute("y",u*i+"em"),this.textContent=n[0];if(a&&!r&&n[0]!==e[t]){const n=this.ownerDocument.createElementNS(Te.svg,"title");n.textContent=e[t],this.appendChild(n)}}))}function uu(t,{x:n,y:e,...r}={}){return void 0===r.frameAnchor&&([n,e]=Zo(n,e)),new lu(t,{...r,x:n,y:e})}function fu(t,{x:n=bo,...e}={}){return new lu(t,Jc({...e,x:n}))}function hu(t,{y:n=bo,...e}={}){return new lu(t,Zc({...e,y:n}))}function du(t,n,e){ic(t,"text-anchor",n.textAnchor),ic(t,"font-family",n.fontFamily),ic(t,"font-size",n.fontSize),ic(t,"font-style",n.fontStyle),ic(t,"font-variant",void 0===n.fontVariant?function(t){return t&&(bi(t)||vi(t))?"tabular-nums":void 0}(e):n.fontVariant),ic(t,"font-weight",n.fontWeight)}const pu=new Set(["inherit","initial","revert","unset","xx-small","x-small","small","medium","large","x-large","xx-large","xxx-large","larger","smaller"]);function mu(t,n,e){const r=[];let o,i=0;for(const[a,l,s]of function*(t){let n=0,e=0;const r=t.length;for(;e<r;){let r=1;switch(t[e]){case au:case"-":++e,yield[n,e,!1],n=e;break;case" ":for(yield[n,e,!1];" "===t[++e];);n=e;break;case"\r":"\n"===t[e+1]&&++r;case"\n":yield[n,e,!0],e+=r,n=e;break;default:++e}}yield[n,e,!0]}(t))void 0===o&&(o=a),i>o&&e(t,o,l)>n&&(r.push(t.slice(o,i)+(t[i-1]===au?"-":"")),o=a),s?(r.push(t.slice(o,l)),o=void 0):i=l;return r}const yu={a:56,b:63,c:57,d:63,e:58,f:37,g:62,h:60,i:26,j:26,k:55,l:26,m:88,n:60,o:60,p:62,q:62,r:39,s:54,t:38,u:60,v:55,w:79,x:54,y:55,z:55,A:69,B:67,C:73,D:74,E:61,F:58,G:76,H:75,I:28,J:55,K:67,L:58,M:89,N:75,O:78,P:65,Q:78,R:67,S:65,T:65,U:75,V:69,W:98,X:69,Y:67,Z:67,0:64,1:48,2:62,3:64,4:66,5:63,6:65,7:58,8:65,9:65," ":29,"!":32,'"':49,"'":31,"(":39,")":39,",":31,"-":48,".":31,"/":32,":":31,";":31,"?":52,"‘":31,"’":31,"“":47,"”":47,"…":82};function gu(t,n=0,e=t.length){let r=0;for(let o=n;o<e;o=Eu(t,o))r+=yu[t[o]]??(Ou(t,o)?120:yu.e);return r}function vu(t,n=0,e=t.length){let r=0;for(let o=n;o<e;o=Eu(t,o))r+=Ou(t,o)?126:63;return r}function xu({monospace:t,lineWidth:n,textOverflow:e}){if(null!=e||n==1/0)return t=>t.split(/\r\n?|\n/g);const r=t?vu:gu,o=100*n;return t=>mu(t,o,r)}function wu({monospace:t,lineWidth:n,textOverflow:e}){if(null==e||n==1/0)return t=>t;const r=t?vu:gu,o=100*n;switch(e){case"clip-start":return t=>Mu(t,o,r,"");case"clip-end":return t=>$u(t,o,r,"");case"ellipsis-start":return t=>Mu(t,o,r,bu);case"ellipsis-middle":return t=>function(t,n,e,r){t=t.trim();const o=e(t);if(o<=n)return t;const i=e(r)/2,[a,l]=ku(t,n/2,e,i),[s]=ku(t,o-n/2-l+i,e,-i);return s<0?r:t.slice(0,a).trimEnd()+r+t.slice(Eu(t,s)).trimStart()}(t,o,r,bu);case"ellipsis-end":return t=>$u(t,o,r,bu)}}const bu="…";function ku(t,n,e,r){const o=[];let i=0;for(let a=0,l=0,s=t.length;a<s;a=l){l=Eu(t,a);const s=e(t,a,l);if(i+s>n){for(i+=r;i>n&&a>0;)l=a,a=o.pop(),i-=e(t,a,l);return[a,n-i]}i+=s,o.push(a)}return[-1,0]}function $u(t,n,e,r){t=t.trim();const o=e(r),[i]=ku(t,n,e,o);return i<0?t:t.slice(0,i).trimEnd()+r}function Mu(t,n,e,r){const o=e(t=t.trim());if(o<=n)return t;const i=e(r),[a]=ku(t,o-n+i,e,-i);return a<0?r:r+t.slice(Eu(t,a)).trimStart()}const Lu=/[\p{Combining_Mark}\p{Emoji_Modifier}]+/uy,Au=/\p{Extended_Pictographic}/uy;function Eu(t,n){return n+=function(t,n){const e=t.charCodeAt(n);if(e>=55296&&e<56320){const e=t.charCodeAt(n+1);return e>=56320&&e<57344}return!1}(t,n)?2:1,function(t,n){return!zu(t,n)&&(Lu.lastIndex=n,Lu.test(t))}(t,n)&&(n=Lu.lastIndex),function(t,n){return 8205===t.charCodeAt(n)}(t,n)?Eu(t,n+1):n}function zu(t,n){return t.charCodeAt(n)<128}function Ou(t,n){return!zu(t,n)&&(Au.lastIndex=n,Au.test(t))}const Su={ariaLabel:"vector",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinejoin:"round",strokeLinecap:"round"},Nu=3.5,Cu=5*Nu,Tu={draw(t,n,e){const r=n*e/Cu;t.moveTo(0,0),t.lineTo(0,-n),t.moveTo(-r,r-n),t.lineTo(0,-n),t.lineTo(r,r-n)}},Ru={draw(t,n,e){t.moveTo(-e,0),t.lineTo(0,-n),t.lineTo(e,0)}},Iu=new Map([["arrow",Tu],["spike",Ru]]);class Wu extends dc{constructor(t,n={}){const{x:e,y:r,r:o=Nu,length:i,rotate:a,shape:l=Tu,anchor:s="middle",frameAnchor:c}=n,[u,f]=Wo(i,12),[h,d]=Wo(a,0);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},length:{value:u,scale:"length",optional:!0},rotate:{value:h,optional:!0}},n,Su),this.r=+o,this.length=f,this.rotate=d,this.shape=function(t){if(function(t){return t&&"function"==typeof t.draw}(t))return t;const n=Iu.get(`${t}`.toLowerCase());if(n)return n;throw new Error(`invalid shape: ${t}`)}(l),this.anchor=Bo(s,"anchor",["start","middle","end"]),this.frameAnchor=Oi(c)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,length:c,rotate:u}=e,{length:f,rotate:h,anchor:d,shape:p,r:m}=this,[y,g]=hc(this,r);return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("path").call(rc,this).attr("transform",ou`translate(${l?t=>l[t]:y},${s?t=>s[t]:g})${u?t=>` rotate(${u[t]})`:h?` rotate(${h})`:""}${"start"===d?"":"end"===d?c?t=>` translate(0,${c[t]})`:` translate(0,${f})`:c?t=>` translate(0,${c[t]/2})`:` translate(0,${f/2})`}`).attr("d",c?t=>{const n=je();return p.draw(n,c[t],m),n}:(()=>{const t=je();return p.draw(t,f,m),t})()).call(Ks,this,e))).node()}}function ju(t,n={}){let{x:e,y:r,...o}=n;return void 0===n.frameAnchor&&([e,r]=Zo(e,r)),new Wu(t,{...o,x:e,y:r})}function Bu(t,n={}){const{x:e=bo,...r}=n;return new Wu(t,{...r,x:e})}function Fu(t,n={}){const{y:e=bo,...r}=n;return new Wu(t,{...r,y:e})}function Du(t,n={}){const{shape:e=Ru,stroke:r=Su.stroke,strokeWidth:o=1,fill:i=r,fillOpacity:a=.3,anchor:l="start",...s}=n;return ju(t,{...s,shape:e,stroke:r,strokeWidth:o,fill:i,fillOpacity:a,anchor:l})}function qu(t,n){return arguments.length<2&&!mi(t)&&(n=t,t=null),void 0===n&&(n={}),[t,n]}function _u({anchor:t}={},n){return void 0===t?n[0]:Bo(t,"anchor",n)}function Pu(t){return _u(t,["left","right"])}function Vu(t){return _u(t,["right","left"])}function Hu(t){return _u(t,["bottom","top"])}function Yu(t){return _u(t,["top","bottom"])}function Uu(){const[t,n]=qu(...arguments);return Ju("y",Pu(n),t,n)}function Xu(){const[t,n]=qu(...arguments);return Ju("fy",Vu(n),t,n)}function Gu(){const[t,n]=qu(...arguments);return Ku("x",Hu(n),t,n)}function Zu(){const[t,n]=qu(...arguments);return Ku("fx",Yu(n),t,n)}function Ju(t,n,e,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("y"===t?6:0),tickPadding:m,tickRotate:y,x:g,margin:v,marginTop:x=(void 0===v?20:v),marginRight:w=(void 0===v?"right"===n?40:0:v),marginBottom:b=(void 0===v?20:v),marginLeft:k=(void 0===v?"left"===n?40:0:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...E}){return p=Lo(p),m=Lo(m),y=Lo(y),void 0!==M&&(M=Bo(M,"labelAnchor",["center","top","bottom"])),L=vf(L),pc(p&&!Ai(i)?function(t,n,e,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=n+("y"===t?"-empty":""),frameAnchor:l=n,tickSize:s,inset:c=0,insetLeft:u=c,insetRight:f=c,dx:h=0,y:d=("y"===t?void 0:null),...p}){return sf(Fu,t,e,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinecap:o,strokeLinejoin:i,facetAnchor:a,frameAnchor:l,y:d,...p,dx:"left"===n?+h-Ys+ +u:+h+Ys-f,anchor:"start",length:s,shape:"left"===n?pf:mf})}(t,n,e,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,x:g,...E}):null,Ai(s)?null:function(t,n,e,{facetAnchor:r=n+("y"===t?"-empty":""),frameAnchor:o=n,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>60?4*Math.cos(a*zc):0),text:s,textAnchor:c=(Math.abs(a)>60?"middle":"left"===n?"end":"start"),lineAnchor:u=(a>60?"top":a<-60?"bottom":"middle"),fontVariant:f,inset:h=0,insetLeft:d=h,insetRight:p=h,dx:m=0,y:y=("y"===t?void 0:null),...g}){return sf(hu,t,e,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,y:y,...g,dx:"left"===n?+m-i-l+ +d:+m+ +i+ +l-p},(function(t,e,r,o,i){void 0===f&&(this.fontVariant=yf(t)),void 0===s&&(i.text=cf(t,e,r,o,n))}))}(t,n,e,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,x:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...E}),Ai(s)||null===$?null:uu([],lf({fill:s,fillOpacity:c,...E},(function(e,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="y"===t&&a.inset||a,h=M??(l.bandwidth?"center":"top"),d=A??("right"===n?c:f)-3;return"center"===h?(this.textAnchor=void 0,this.lineAnchor="right"===n?"bottom":"top",this.frameAnchor=n,this.rotate=-90):(this.textAnchor="right"===n?"end":"start",this.lineAnchor=h,this.frameAnchor=`${h}-${n}`,this.rotate=0),this.dy="top"===h?3-s:"bottom"===h?u-3:0,this.dx="right"===n?d:-d,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[gf(t,l,{anchor:n,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function Ku(t,n,e,{color:r="currentColor",opacity:o=1,stroke:i=r,strokeOpacity:a=o,strokeWidth:l=1,fill:s=r,fillOpacity:c=o,textAnchor:u,textStroke:f,textStrokeOpacity:h,textStrokeWidth:d,tickSize:p=("x"===t?6:0),tickPadding:m,tickRotate:y,y:g,margin:v,marginTop:x=(void 0===v?"top"===n?30:0:v),marginRight:w=(void 0===v?20:v),marginBottom:b=(void 0===v?"bottom"===n?30:0:v),marginLeft:k=(void 0===v?20:v),label:$,labelAnchor:M,labelArrow:L,labelOffset:A,...E}){return p=Lo(p),m=Lo(m),y=Lo(y),void 0!==M&&(M=Bo(M,"labelAnchor",["center","left","right"])),L=vf(L),pc(p&&!Ai(i)?function(t,n,e,{strokeWidth:r=1,strokeLinecap:o=null,strokeLinejoin:i=null,facetAnchor:a=n+("x"===t?"-empty":""),frameAnchor:l=n,tickSize:s,inset:c=0,insetTop:u=c,insetBottom:f=c,dy:h=0,x:d=("x"===t?void 0:null),...p}){return sf(Bu,t,e,{ariaLabel:`${t}-axis tick`,ariaHidden:!0},{strokeWidth:r,strokeLinejoin:i,strokeLinecap:o,facetAnchor:a,frameAnchor:l,x:d,...p,dy:"bottom"===n?+h-Ys-f:+h+Ys+ +u,anchor:"start",length:s,shape:"bottom"===n?hf:df})}(t,n,e,{stroke:i,strokeOpacity:a,strokeWidth:l,tickSize:p,tickPadding:m,tickRotate:y,y:g,...E}):null,Ai(s)?null:function(t,n,e,{facetAnchor:r=n+("x"===t?"-empty":""),frameAnchor:o=n,tickSize:i,tickRotate:a=0,tickPadding:l=Math.max(3,9-i)+(Math.abs(a)>=10?4*Math.cos(a*zc):0),text:s,textAnchor:c=(Math.abs(a)>=10?a<0^"bottom"===n?"start":"end":"middle"),lineAnchor:u=(Math.abs(a)>=10?"middle":"bottom"===n?"top":"bottom"),fontVariant:f,inset:h=0,insetTop:d=h,insetBottom:p=h,dy:m=0,x:y=("x"===t?void 0:null),...g}){return sf(fu,t,e,{ariaLabel:`${t}-axis tick label`},{facetAnchor:r,frameAnchor:o,text:void 0===s?null:s,textAnchor:c,lineAnchor:u,fontVariant:f,rotate:a,x:y,...g,dy:"bottom"===n?+m+ +i+ +l-p:+m-i-l+ +d},(function(t,e,r,o,i){void 0===f&&(this.fontVariant=yf(t)),void 0===s&&(i.text=cf(t,e,r,o,n))}))}(t,n,e,{fill:s,fillOpacity:c,stroke:f,strokeOpacity:h,strokeWidth:d,textAnchor:u,tickSize:p,tickPadding:m,tickRotate:y,y:g,marginTop:x,marginRight:w,marginBottom:b,marginLeft:k,...E}),Ai(s)||null===$?null:uu([],lf({fill:s,fillOpacity:c,...E},(function(e,r,o,i,a){const l=i[t],{marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}="x"===t&&a.inset||a,h=M??(l.bandwidth?"center":"right"),d=A??("top"===n?s:u)-3;return"center"===h?(this.frameAnchor=n,this.textAnchor=void 0):(this.frameAnchor=`${n}-${h}`,this.textAnchor="right"===h?"end":"start"),this.lineAnchor=n,this.dy="top"===n?-d:d,this.dx="right"===h?c-3:"left"===h?3-f:0,this.ariaLabel=`${t}-axis label`,{facets:[[0]],channels:{text:{value:[gf(t,l,{anchor:n,label:$,labelAnchor:h,labelArrow:L})]}}}}))))}function Qu(){const[t,n]=qu(...arguments);return rf("y",Pu(n),t,n)}function tf(){const[t,n]=qu(...arguments);return rf("fy",Vu(n),t,n)}function nf(){const[t,n]=qu(...arguments);return of("x",Hu(n),t,n)}function ef(){const[t,n]=qu(...arguments);return of("fx",Yu(n),t,n)}function rf(t,n,e,{y:r=("y"===t?void 0:null),x:o=null,x1:i=("left"===n?o:null),x2:a=("right"===n?o:null),...l}){return sf(eu,t,e,{ariaLabel:`${t}-grid`,ariaHidden:!0},{y:r,x1:i,x2:a,...af(l)})}function of(t,n,e,{x:r=("x"===t?void 0:null),y:o=null,y1:i=("top"===n?o:null),y2:a=("bottom"===n?o:null),...l}){return sf(nu,t,e,{ariaLabel:`${t}-grid`,ariaHidden:!0},{x:r,y1:i,y2:a,...af(l)})}function af({color:t="currentColor",opacity:n=.1,stroke:e=t,strokeOpacity:r=n,strokeWidth:o=1,...i}){return{stroke:e,strokeOpacity:r,strokeWidth:o,...i}}function lf({fill:t,fillOpacity:n,fontFamily:e,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u=!1},f){return[,t]=Io(t),[,n]=Wo(n),{facet:"super",x:null,y:null,fill:t,fillOpacity:n,fontFamily:e,fontSize:r,fontStyle:o,fontVariant:i,fontWeight:a,monospace:l,pointerEvents:s,shapeRendering:c,clip:u,initializer:f}}function sf(t,n,e,r,o,i){let a;const l=Ui(o).initializer,s=t(e,Ui({...o,initializer:function(t,e,r,l,s,c){const u=null==t&&("fx"===n||"fy"===n),{[n]:f}=l;if(!f)throw new Error(`missing scale: ${n}`);const h=f.domain();let{interval:d,ticks:p,tickFormat:m,tickSpacing:y=("x"===n?80:35)}=o;if("string"==typeof p&&xf(f)&&(d=p,p=void 0),void 0===p&&(p=hi(d,f.type)??function(t,n){const[e,r]=qn(t.range());return(r-e)/n}(f,y)),null==t){if(mi(p))t=Fo(p);else if(di(p))t=ff(p,...qn(h));else if(f.interval){let n=f.interval;if(f.ticks){const[e,r]=qn(h);n=lo(n,(r-e)/n[Kr]/p)??n,t=ff(n,e,r)}else{n=lo(n,(t=h).length/p)??n,n!==f.interval&&(t=ff(n,...qn(t)))}if(n===f.interval){const n=Math.round(t.length/p);n>1&&(t=t.filter(((t,e)=>e%n==0)))}}else t=f.ticks?f.ticks(p):h;if(!f.ticks&&t.length&&t!==h){const e=new nt(h);(t=t.filter((t=>e.has(t)))).length||Al(`Warning: the ${n}-axis ticks appear to not align with the scale domain, resulting in no ticks. Try different ticks?`)}"y"===n||"x"===n?e=[Ko(t)]:a[n]={scale:n,value:bo}}i?.call(this,f,t,p,m,a);const g=Object.fromEntries(Object.entries(a).map((([n,e])=>[n,{...e,value:mo(t,e.value)}])));return u&&(e=c.filterFacets(t,g)),{data:t,facets:e,channels:g}}},l));return null==e?(a=s.channels,s.channels={}):a={},void 0!==r&&Object.assign(s,r),void 0===s.clip&&(s.clip=!1),s}function cf(t,n,e,r,o){return{value:uf(t,n,e,r,o)}}function uf(t,n,e,r,o){return"function"!=typeof r||"log"===t.type&&t.tickFormat?void 0===r&&n&&vi(n)?co(t.type,n,o)??Hs:t.tickFormat?t.tickFormat("number"==typeof e?e:null,r):void 0===r?Hs:"string"==typeof r?(vi(t.domain())?R:Ie)(r):Oo(r):r}function ff(t,n,e){return t.range(n,t.offset(t.floor(e)))}const hf={draw(t,n){t.moveTo(0,0),t.lineTo(0,n)}},df={draw(t,n){t.moveTo(0,0),t.lineTo(0,-n)}},pf={draw(t,n){t.moveTo(0,0),t.lineTo(-n,0)}},mf={draw(t,n){t.moveTo(0,0),t.lineTo(n,0)}};function yf(t){return t.bandwidth&&!t.interval?void 0:"tabular-nums"}function gf(t,n,{anchor:e,label:r=n.label,labelAnchor:o,labelArrow:i}={}){if(!(null==r||r.inferred&&xf(n)&&/^(date|time|year)$/i.test(r))){if(r=String(r),"auto"===i&&(i=(!n.bandwidth||n.interval)&&!/[↑↓→←]/.test(r)),!i)return r;if(!0===i){const e=Pl(n);e&&(i=/x$/.test(t)||"center"===o?/x$/.test(t)===e<0?"left":"right":e<0?"up":"down")}switch(i){case"left":return`← ${r}`;case"right":return`${r} →`;case"up":return"right"===e?`${r} ↑`:`↑ ${r}`;case"down":return"right"===e?`${r} ↓`:`↓ ${r}`}return r}}function vf(t="auto"){return!Ai(t)&&("boolean"==typeof t?t:Bo(t,"labelArrow",["auto","up","right","down","left"]))}function xf(t){return vi(t.domain())}function wf(t,n){if(null==n)return n;const e=t(n);if(!e)throw new Error(`scale not found: ${n}`);return e}function bf(t,n={},e){let{columns:r,tickFormat:o,fontVariant:i=Ec(t),swatchSize:a=15,swatchWidth:l=a,swatchHeight:s=a,marginLeft:c=0,className:u,style:f,width:h}=n;const d=Is(n);u=uc(u),o=uf(t.scale,t.domain,void 0,o);const p=Ws("div",d).attr("class",`${u}-swatches ${u}-swatches-${null!=r?"columns":"wrap"}`);let m;return null!=r?(m=`:where(.${u}-swatches-columns .${u}-swatch) {\n  display: flex;\n  align-items: center;\n  break-inside: avoid;\n  padding-bottom: 1px;\n}\n:where(.${u}-swatches-columns .${u}-swatch::before) {\n  flex-shrink: 0;\n}\n:where(.${u}-swatches-columns .${u}-swatch-label) {\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n}`,p.style("columns",r).selectAll().data(t.domain).enter().append("div").attr("class",`${u}-swatch`).call(e,t,l,s).call((t=>t.append("div").attr("class",`${u}-swatch-label`).attr("title",o).text(o)))):(m=`:where(.${u}-swatches-wrap) {\n  display: flex;\n  align-items: center;\n  min-height: 33px;\n  flex-wrap: wrap;\n}\n:where(.${u}-swatches-wrap .${u}-swatch) {\n  display: inline-flex;\n  align-items: center;\n  margin-right: 1em;\n}`,p.selectAll().data(t.domain).enter().append("span").attr("class",`${u}-swatch`).call(e,t,l,s).append((function(){return this.ownerDocument.createTextNode(o.apply(this,arguments))}))),p.call((t=>t.insert("style","*").text(`:where(.${u}-swatches) {\n  font-family: system-ui, sans-serif;\n  font-size: 10px;\n  margin-bottom: 0.5em;\n}\n:where(.${u}-swatch > svg) {\n  margin-right: 0.5em;\n  overflow: visible;\n}\n${m}`))).style("margin-left",c?+c+"px":null).style("width",void 0===h?null:+h+"px").style("font-variant",lc(i,"normal")).call(fc,f).node()}const kf=new Map([["symbol",function(t,{fill:n=(void 0!==t.hint?.fill?t.hint.fill:"none"),fillOpacity:e=1,stroke:r=(void 0!==t.hint?.stroke?t.hint.stroke:Ai(n)?"currentColor":"none"),strokeOpacity:o=1,strokeWidth:i=1.5,r:a=4.5,...l}={},s){const[c,u]=Io(n),[f,h]=Io(r),d=wf(s,c),p=wf(s,f),m=a*a*Math.PI;return e=Wo(e)[1],o=Wo(o)[1],i=Wo(i)[1],bf(t,l,((n,r,a,l)=>n.append("svg").attr("viewBox","-8 -8 16 16").attr("width",a).attr("height",l).attr("fill","color"===c?t=>d.scale(t):u).attr("fill-opacity",e).attr("stroke","color"===f?t=>p.scale(t):h).attr("stroke-opacity",o).attr("stroke-width",i).append("path").attr("d",(n=>{const e=je();return t.scale(n).draw(e,m),e}))))}],["color",Lf],["opacity",function({type:t,interpolate:n,...e},{legend:r=!0,color:o=Be(0,0,0),...i}){if(!n)throw new Error(`${t} opacity scales are not supported`);!0===r&&(r="ramp");if("ramp"!==`${r}`.toLowerCase())throw new Error(`${r} opacity legends are not supported`);return Lf({type:t,...e,interpolate:Af(o)},{legend:r,...i})}]]);function $f(t={}){for(const[n,e]of kf){const r=t[n];if(Yo(r)){const o=Is(t);let i;if("symbol"===n){const{fill:n,stroke:e=(void 0===n&&Yo(t.color)?"color":void 0)}=t;i={fill:n,stroke:e}}return e(Zl(n,r,i),Mf(o,r,t),(n=>Yo(t[n])?Zl(n,t[n]):null))}}throw new Error("unknown legend type; no scale found")}function Mf({className:t,...n},{label:e,ticks:r,tickFormat:o}={},i){return function(t={},...n){let e=t;for(const r of n)for(const n in r)if(void 0===e[n]){const o=r[n];e===t?e={...e,[n]:o}:e[n]=o}return e}(i,{className:t,...n},{label:e,ticks:r,tickFormat:o})}function Lf(t,{legend:n=!0,...e}){if(!0===n&&(n="ordinal"===t.type?"swatches":"ramp"),void 0!==t.domain)switch(`${n}`.toLowerCase()){case"swatches":return function(t,{opacity:n,...e}={}){if(!es(t)&&!rs(t))throw new Error(`swatches legend requires ordinal or threshold color scale (not ${t.type})`);return bf(t,e,((t,e,r,o)=>t.append("svg").attr("width",r).attr("height",o).attr("fill",e.scale).attr("fill-opacity",Wo(n)[1]).append("rect").attr("width","100%").attr("height","100%")))}(t,e);case"ramp":return function(t,n){let{label:e=t.label,tickSize:r=6,width:o=240,height:i=44+r,marginTop:a=18,marginRight:l=0,marginBottom:s=16+r,marginLeft:c=0,style:u,ticks:f=(o-c-l)/64,tickFormat:h,fontVariant:d=Ec(t),round:p=!0,opacity:m,className:y}=n;const g=Is(n);y=uc(y),m=Wo(m)[1],null===h&&(h=()=>null);const v=Ws("svg",g).attr("class",`${y}-ramp`).attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("width",o).attr("height",i).attr("viewBox",`0 0 ${o} ${i}`).call((t=>t.append("style").text(`:where(.${y}-ramp) {\n  display: block;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n  overflow: visible;\n}\n:where(.${y}-ramp text) {\n  white-space: pre;\n}`))).call(fc,u);let x,w=t=>t.selectAll(".tick line").attr("y1",a+s-i);const b=p?(t,n)=>t.rangeRound(n):(t,n)=>t.range(n),{type:k,domain:$,range:M,interpolate:L,scale:A,pivot:E}=t;if(L){const t=void 0===M?L:Un(1===L.length?$l(L):L,M);x=b(A.copy(),ht(Pn(c,o-l),Math.min($.length+(void 0!==E),void 0===M?1/0:M.length)));const n=256,e=g.document.createElement("canvas");e.width=n,e.height=1;const r=e.getContext("2d");for(let e=0,o=n-1;e<n;++e)r.fillStyle=t(e/o),r.fillRect(e,0,1,1);v.append("image").attr("opacity",m).attr("x",c).attr("y",a).attr("width",o-c-l).attr("height",i-a-s).attr("preserveAspectRatio","none").attr("xlink:href",e.toDataURL())}else if("threshold"===k){const t=$,n=void 0===h?t=>t:"string"==typeof h?Ie(h):h;x=b(Wn().domain([-1,M.length-1]),[c,o-l]),v.append("g").attr("fill-opacity",m).selectAll().data(M).enter().append("rect").attr("x",((t,n)=>x(n-1))).attr("y",a).attr("width",((t,n)=>x(n)-x(n-1))).attr("height",i-a-s).attr("fill",(t=>t)),f=Do(t,((t,n)=>n)),h=e=>n(t[e],e)}else x=b(se().domain($),[c,o-l]),v.append("g").attr("fill-opacity",m).selectAll().data($).enter().append("rect").attr("x",x).attr("y",a).attr("width",Math.max(0,x.bandwidth()-1)).attr("height",i-a-s).attr("fill",A),w=()=>{};return v.append("g").attr("transform",`translate(0,${i-s})`).call(We(x).ticks(Array.isArray(f)?null:f,"string"==typeof h?h:void 0).tickFormat("function"==typeof h?h:void 0).tickSize(r).tickValues(Array.isArray(f)?f:null)).attr("font-size",null).attr("font-family",null).attr("font-variant",lc(d,"normal")).call(w).call((t=>t.select(".domain").remove())),void 0!==e&&v.append("text").attr("x",c).attr("y",a-6).attr("fill","currentColor").attr("font-weight","bold").text(e),v.node()}(t,e);default:throw new Error(`unknown legend type: ${n}`)}}function Af(t){const{r:n,g:e,b:r}=Be(t)||Be(0,0,0);return t=>`rgba(${n},${e},${r},${t})`}const Ef={ariaLabel:"frame",fill:"none",stroke:"currentColor",clip:!1},zf={ariaLabel:"frame",fill:null,stroke:"currentColor",strokeLinecap:"square",clip:!1};class Of extends dc{constructor(t={}){const{anchor:n=null,inset:e=0,insetTop:r=e,insetRight:o=e,insetBottom:i=e,insetLeft:a=e,rx:l,ry:s}=t;super(vo,void 0,t,null==n?Ef:zf),this.anchor=jo(n,"anchor",["top","right","bottom","left"]),this.insetTop=Lo(r),this.insetRight=Lo(o),this.insetBottom=Lo(i),this.insetLeft=Lo(a),this.rx=Lo(l),this.ry=Lo(s)}render(t,n,e,r,o){const{marginTop:i,marginRight:a,marginBottom:l,marginLeft:s,width:c,height:u}=r,{anchor:f,insetTop:h,insetRight:d,insetBottom:p,insetLeft:m,rx:y,ry:g}=this,v=s+m,x=c-a-d,w=i+h,b=u-l-p;return Ws(f?"svg:line":"svg:rect",o).datum(0).call(ec,this,r,o).call(rc,this).call(Ks,this,e).call(ac,this,{}).call("left"===f?t=>t.attr("x1",v).attr("x2",v).attr("y1",w).attr("y2",b):"right"===f?t=>t.attr("x1",x).attr("x2",x).attr("y1",w).attr("y2",b):"top"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",w).attr("y2",w):"bottom"===f?t=>t.attr("x1",v).attr("x2",x).attr("y1",b).attr("y2",b):t=>t.attr("x",v).attr("y",w).attr("width",x-v).attr("height",b-w).attr("rx",y).attr("ry",g)).node()}}function Sf(t){return new Of(t)}const Nf={ariaLabel:"tip",fill:"var(--plot-background)",stroke:"currentColor"},Cf=new Set(["geometry","href","src","ariaLabel","scales"]);class Tf extends dc{constructor(t,n={}){n.tip&&(n={...n,tip:!1}),void 0===n.title&&mi(t)&&yi(t)&&(n={...n,title:bo});const{x:e,y:r,x1:o,x2:i,y1:a,y2:l,anchor:s,preferredAnchor:c="bottom",monospace:u,fontFamily:f=(u?"ui-monospace, monospace":void 0),fontSize:h,fontStyle:d,fontVariant:p,fontWeight:m,lineHeight:y=1,lineWidth:g=20,frameAnchor:v,format:x,textAnchor:w="start",textOverflow:b,textPadding:k=8,title:$,pointerSize:M=12,pathFilter:L="drop-shadow(0 3px 4px rgba(0,0,0,0.2))"}=n;super(t,{x:{value:null!=o&&null!=i?null:e,scale:"x",optional:!0},y:{value:null!=a&&null!=l?null:r,scale:"y",optional:!0},x1:{value:o,scale:"x",optional:null==i},y1:{value:a,scale:"y",optional:null==l},x2:{value:i,scale:"x",optional:null==o},y2:{value:l,scale:"y",optional:null==a},title:{value:$,optional:!0}},n,Nf),this.anchor=zi(s,"anchor"),this.preferredAnchor=zi(c,"preferredAnchor"),this.frameAnchor=Oi(v),this.textAnchor=lc(w,"middle"),this.textPadding=+k,this.pointerSize=+M,this.pathFilter=Mo(L),this.lineHeight=+y,this.lineWidth=+g,this.textOverflow=su(b),this.monospace=!!u,this.fontFamily=Mo(f),this.fontSize=Lo(h),this.fontStyle=Mo(d),this.fontVariant=Mo(p),this.fontWeight=Mo(m);for(const t in Nf)t in this.channels&&(this[t]=Nf[t]);this.splitLines=xu(this),this.clipLine=wu(this),this.format="string"==typeof x||"function"==typeof x?{title:x}:{...x}}render(t,n,e,r,o){const i=this,{x:a,y:l,fx:s,fy:c}=n,{ownerSVGElement:u,document:f}=o,{anchor:h,monospace:d,lineHeight:p,lineWidth:m}=this,{textPadding:y,pointerSize:g,pathFilter:v}=this,{marginTop:x,marginLeft:w}=r,{x1:b,y1:k,x2:$,y2:M,x:L=b??$,y:A=k??M}=e,E=s?s(t.fx)-w:0,z=c?c(t.fy)-x:0,[O,S]=hc(this,r),N=Lc(e,O),C=Ac(e,S),T=d?vu:gu,R=T(bu);let I,W;"title"in e?(I=If.call(this,{title:e.channels.title},n),W=jf):(I=If.call(this,e.channels,n),W=Bf);const j=Ws("svg:g",o).call(ec,this,r,o).call(du,this).call(ac,this,{x:L&&a,y:A&&l}).call((r=>r.selectAll().data(t).enter().append("g").attr("transform",(t=>`translate(${Math.round(N(t))},${Math.round(C(t))})`)).call(rc,this).call((t=>t.append("path").attr("filter",v))).call((r=>r.append("text").each((function(r){const o=Ne(this);this.setAttribute("fill","currentColor"),this.setAttribute("fill-opacity",1),this.setAttribute("stroke","none");const a=W.call(i,r,t,I,n,e);if("string"==typeof a)for(const t of i.splitLines(a))B(o,{value:i.clipLine(t)});else{const t=new Set;for(const n of a){const{label:e=""}=n;e&&t.has(e)||(t.add(e),B(o,n))}}}))))));function B(t,{label:n,value:e,color:r,opacity:o}){n??="",e??="";const i=null!=r||null!=o;let a,l=100*m;const[s]=ku(n,l,T,R);if(s>=0)n=n.slice(0,s).trimEnd()+bu,a=e.trim(),e="";else{(n||!e&&!i)&&(e=" "+e);const[t]=ku(e,l-T(n),T,R);t>=0&&(a=e.trim(),e=e.slice(0,t).trimEnd()+bu)}const c=t.append("tspan").attr("x",0).attr("dy",`${p}em`).text("​");n&&c.append("tspan").attr("font-weight","bold").text(n),e&&c.append((()=>f.createTextNode(e))),i&&c.append("tspan").text(" ■").attr("fill",r).attr("fill-opacity",o).style("user-select","none"),a&&c.append("title").text(a)}function F(){const{width:t,height:n}=r.facet??r;j.selectChildren().each((function(e){let{x:r,width:o,height:a}=this.getBBox();o=Math.round(o),a=Math.round(a);let l=h;if(void 0===l){const r=N(e)+E,s=C(e)+z,c=r+o+g+2*y<t,u=r-o-g-2*y>0,f=s+a+g+2*y<n,h=s-a-g-2*y>0;l=c&&u?f&&h?i.preferredAnchor:h?"bottom":"top":f&&h?c?"left":"right":(c||u)&&(f||h)?`${h?"bottom":"top"}-${c?"left":"right"}`:i.preferredAnchor}const s=this.firstChild,c=this.lastChild;if(s.setAttribute("d",function(t,n,e,r,o){const i=r+2*e,a=o+2*e;switch(t){case"middle":return`M${-i/2},${-a/2}h${i}v${a}h${-i}z`;case"top-left":return`M0,0l${n},${n}h${i-n}v${a}h${-i}z`;case"top":return`M0,0l${n/2},${n/2}h${(i-n)/2}v${a}h${-i}v${-a}h${(i-n)/2}z`;case"top-right":return`M0,0l${-n},${n}h${n-i}v${a}h${i}z`;case"right":return`M0,0l${-n/2},${-n/2}v${n/2-a/2}h${-i}v${a}h${i}v${n/2-a/2}z`;case"bottom-left":return`M0,0l${n},${-n}h${i-n}v${-a}h${-i}z`;case"bottom":return`M0,0l${n/2},${-n/2}h${(i-n)/2}v${-a}h${-i}v${a}h${(i-n)/2}z`;case"bottom-right":return`M0,0l${-n},${-n}h${n-i}v${-a}h${i}z`;case"left":return`M0,0l${n/2},${-n/2}v${n/2-a/2}h${i}v${a}h${-i}v${n/2-a/2}z`}}(l,g,y,o,a)),r)for(const t of c.childNodes)t.setAttribute("x",-r);c.setAttribute("y",+function(t,n,e){return/^top(?:-|$)/.test(t)?.94-e:-.29-n*e}(l,c.childNodes.length,p).toFixed(6)+"em"),c.setAttribute("transform",`translate(${function(t,n,e,r,o){switch(t){case"middle":return[-r/2,o/2];case"top-left":return[e,n+e];case"top":return[-r/2,n/2+e];case"top-right":return[-r-e,n+e];case"right":return[-n/2-r-e,o/2];case"bottom-left":return[e,-n-e];case"bottom":return[-r/2,-n/2-e];case"bottom-right":return[-r-e,-n-e];case"left":return[e+n/2,o/2]}}(l,g,y,o,a)})`)})),j.attr("visibility",null)}return t.length&&(j.attr("visibility","hidden"),u.isConnected?Promise.resolve().then(F):"undefined"!=typeof requestAnimationFrame&&requestAnimationFrame(F)),j.node()}}function Rf(t,{x:n,y:e,...r}={}){return void 0===r.frameAnchor&&([n,e]=Zo(n,e)),new Tf(t,{...r,x:n,y:e})}function If(t,n){const e={};let r=this.format;r=Wf(r,t,"x"),r=Wf(r,t,"y"),this.format=r;for(const n in r){const o=r[n];if(null!==o&&!1!==o)if("fx"===n||"fy"===n)e[n]=!0;else{const r=Za(t,n);r&&(e[n]=r)}}for(const n in t){if(n in e||n in r||Cf.has(n))continue;const o=Za(t,n);o&&(e[n]=o)}this.facet&&(n.fx&&!("fx"in r)&&(e.fx=!0),n.fy&&!("fy"in r)&&(e.fy=!0));for(const t in e){const r=this.format[t];if("string"==typeof r){const o=e[t]?.value??n[t]?.domain()??[];this.format[t]=(vi(o)?R:Ie)(r)}else if(void 0===r||!0===r){const e=n[t];this.format[t]=e?.bandwidth?uf(e,e.domain()):Hs}}return e}function Wf(t,n,e){if(!(e in t))return t;const r=`${e}1`,o=`${e}2`;if(!(!(r in t)&&r in n||!(o in t)&&o in n))return t;const i=Object.entries(t),a=t[e];return i.splice(i.findIndex((([t])=>t===e))+1,0,[r,a],[o,a]),Object.fromEntries(i)}function jf(t,n,{title:e}){return this.format.title(e.value[t],t)}function*Bf(t,n,e,r,o){for(const i in e){if("fx"===i||"fy"===i){yield{label:qf(r,e,i),value:this.format[i](n[i],t)};continue}if("x1"===i&&"x2"in e)continue;if("y1"===i&&"y2"in e)continue;const a=e[i];if("x2"===i&&"x1"in e)yield{label:Df(r,e,"x"),value:Ff(this.format.x2,e.x1,a,t)};else if("y2"===i&&"y1"in e)yield{label:Df(r,e,"y"),value:Ff(this.format.y2,e.y1,a,t)};else{const n=a.value[t],l=a.scale;if(!Tr(n)&&null==l)continue;yield{label:qf(r,e,i),value:this.format[i](n,t),color:"color"===l?o[i][t]:null,opacity:"opacity"===l?o[i][t]:null}}}}function Ff(t,n,e,r){return e.hint?.length?`${t(e.value[r]-n.value[r],r)}`:`${t(n.value[r],r)}–${t(e.value[r],r)}`}function Df(t,n,e){const r=qf(t,n,`${e}1`,e),o=qf(t,n,`${e}2`,e);return r===o?r:`${r}–${o}`}function qf(t,n,e,r=e){const o=n[e],i=t[o?.scale??e];return String(i?.label??o?.label??r)}function _f(t={}){const{facet:n,style:e,title:r,subtitle:o,caption:i,ariaLabel:a,ariaDescription:l}=t,s=uc(t.className),c=void 0===t.marks?[]:Vf(t.marks);c.push(...function(t){const n=[];for(const e of t){let t=e.tip;if(t){!0===t?t={}:"string"==typeof t&&(t={pointer:t});let{pointer:r,preferredAnchor:o}=t;r=/^x$/i.test(r)?$c:/^y$/i.test(r)?Mc:kc,t=r(Qf(e,t)),t.title=null,void 0===o&&(t.preferredAnchor=r===Mc?"left":"bottom");const i=Rf(e.data,t);i.facet=e.facet,i.facetAnchor=e.facetAnchor,n.push(i)}}return n}(c));const u=function(t,n){if(null==t)return;const{x:e,y:r}=t;if(null==e&&null==r)return;const o=Fo(t.data);if(null==o)throw new Error("missing facet data");const i={};null!=e&&(i.fx=Fa(o,{value:e,scale:"fx"}));null!=r&&(i.fy=Fa(o,{value:r,scale:"fy"}));Uf(i,n);const a=cs(o,i);return{channels:i,groups:a,data:t.data}}(n,t),f=new Map;for(const n of c){const e=Kf(n,u,t);e&&f.set(n,e)}const h=new Map;u&&Zf(h,[u],t),Zf(h,f,t);const d=Vf(function(t,n,e){let{projection:r,x:o={},y:i={},fx:a={},fy:l={},axis:s,grid:c,facet:u={},facet:{axis:f=s,grid:h}=u,x:{axis:d=s,grid:p=(null===d?null:c)}=o,y:{axis:m=s,grid:y=(null===m?null:c)}=i,fx:{axis:g=f,grid:v=(null===g?null:h)}=a,fy:{axis:x=f,grid:w=(null===x?null:h)}=l}=e;(r||!Yo(o)&&!oh("x",t))&&(d=p=null);(r||!Yo(i)&&!oh("y",t))&&(m=y=null);n.has("fx")||(g=v=null);n.has("fy")||(x=w=null);void 0===d&&(d=!rh(t,"x"));void 0===m&&(m=!rh(t,"y"));void 0===g&&(g=!rh(t,"fx"));void 0===x&&(x=!rh(t,"fy"));!0===d&&(d="bottom");!0===m&&(m="left");!0===g&&(g="top"===d||null===d?"bottom":"top");!0===x&&(x="right"===m||null===m?"left":"right");const b=[];return nh(b,w,tf,l),th(b,x,Xu,"right","left",u,l),nh(b,v,ef,a),th(b,g,Zu,"top","bottom",u,a),nh(b,y,Qu,i),th(b,m,Uu,"left","right",e,i),nh(b,p,nf,o),th(b,d,Gu,"bottom","top",e,o),b}(c,h,t));for(const n of d){const e=Kf(n,u,t);e&&f.set(n,e)}c.unshift(...d);let p=function(t,n){const{fx:e,fy:r}=Dl(t,n),o=e?.scale.domain(),i=r?.scale.domain();return o&&i?fe(o,i).map((([t,n],e)=>({x:t,y:n,i:e}))):o?o.map(((t,n)=>({x:t,i:n}))):i?i.map(((t,n)=>({y:t,i:n}))):void 0}(h,t);if(void 0!==p){const t=u?bs(p,u):void 0;for(const n of c){if(null===n.facet||"super"===n.facet)continue;const e=f.get(n);void 0!==e&&(e.facetsIndex=null!=n.fx||null!=n.fy?bs(p,e):t)}const n=new Set;for(const{facetsIndex:t}of f.values())t?.forEach(((t,e)=>{t?.length>0&&n.add(e)}));p.forEach(0<n.size&&n.size<p.length?(t,e)=>t.empty=!n.has(e):t=>t.empty=!1);for(const t of c)if("exclude"===t.facet){const n=f.get(t);void 0!==n&&(n.facetsIndex=us(n.facetsIndex))}}for(const n of Fi.keys())Yo(t[n])&&"fx"!==n&&"fy"!==n&&h.set(n,[]);const m=new Map;for(const n of c){if(m.has(n))throw new Error("duplicate mark; each mark must be unique");const{facetsIndex:e,channels:r}=f.get(n)??{},{data:o,facets:i,channels:a}=n.initialize(e,r,t);Uf(a,t),m.set(n,{data:o,facets:i,channels:a})}const y=Dl(Zf(h,m,t),t),g=function(t,n,e={}){let r=.5-Ys,o=.5+Ys,i=.5+Ys,a=.5-Ys;for(const{marginTop:t,marginRight:e,marginBottom:l,marginLeft:s}of n)t>r&&(r=t),e>o&&(o=e),l>i&&(i=l),s>a&&(a=s);let{margin:l,marginTop:s=(void 0!==l?l:r),marginRight:c=(void 0!==l?l:o),marginBottom:u=(void 0!==l?l:i),marginLeft:f=(void 0!==l?l:a)}=e;s=+s,c=+c,u=+u,f=+f;let{width:h=640,height:d=vc(t,e,{width:h,marginTopDefault:r,marginRightDefault:o,marginBottomDefault:i,marginLeftDefault:a})+Math.max(0,s-r+u-i)}=e;h=+h,d=+d;const p={width:h,height:d,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f};if(t.fx||t.fy){let{margin:t,marginTop:n=(void 0!==t?t:s),marginRight:r=(void 0!==t?t:c),marginBottom:o=(void 0!==t?t:u),marginLeft:i=(void 0!==t?t:f)}=e.facet??{};n=+n,r=+r,o=+o,i=+i,p.facet={marginTop:n,marginRight:r,marginBottom:o,marginLeft:i}}return p}(y,c,t);!function(t,n){const{x:e,y:r,fx:o,fy:i}=t,a=o||i?Vl(n):n;o&&Yl(o,a),i&&Ul(i,a);const l=o||i?Hl(t,n):n;e&&Yl(e,l),r&&Ul(r,l)}(y,g);const v=ql(y),{fx:x,fy:w}=v,b=x||w?Hl(y,g):g,k=x||w?function({fx:t,fy:n},e){const{marginTop:r,marginRight:o,marginBottom:i,marginLeft:a,width:l,height:s}=Vl(e),c=t&&ih(t),u=n&&ih(n);return{marginTop:n?u[0]:r,marginRight:t?l-c[1]:o,marginBottom:n?s-u[1]:i,marginLeft:t?c[0]:a,inset:{marginTop:e.marginTop,marginRight:e.marginRight,marginBottom:e.marginBottom,marginLeft:e.marginLeft},width:l,height:s}}(v,g):g,$=Is(t),M=$.document,L=Ce("svg").call(M.documentElement);let A=L;$.ownerSVGElement=L,$.className=s,$.projection=Ls(t,b),$.filterFacets=(t,n)=>bs(p,{channels:n,groups:cs(t,n)}),$.getMarkState=t=>{const n=m.get(t),e=f.get(t);return{...n,channels:{...n.channels,...e?.channels}}},$.dispatchValue=t=>{A.value!==t&&(A.value=t,A.dispatchEvent(new Event("input",{bubbles:!0})))};const E=new Set;for(const[n,e]of m)if(null!=n.initializer){const r="super"===n.facet?k:b,o=n.initializer(e.data,e.facets,e.channels,v,r,$);if(void 0!==o.data&&(e.data=o.data),void 0!==o.facets&&(e.facets=o.facets),void 0!==o.channels){const{fx:r,fy:i,...a}=o.channels;Gf(a),Object.assign(e.channels,a);for(const n of Object.values(a)){const{scale:e}=n;null!=e&&((z=Fi.get(e))!==Ci&&z!==Bi)&&(Xf(n,t),E.add(e))}null==r&&null==i||f.set(n,!0)}}var z;if(E.size){const n=new Map;Zf(n,m,t,(t=>E.has(t))),Zf(h,m,t,(t=>E.has(t)));const e=function(t,n){for(const e in t){const r=t[e],o=n[e];void 0===r.label&&o&&(r.label=o.label)}return t}(Dl(n,t),y),{scales:r,...o}=ql(e);Object.assign(y,e),Object.assign(v,o),Object.assign(v.scales,r)}let O,S;void 0!==p&&(O={x:x?.domain(),y:w?.domain()},p=function(t,{x:n,y:e}){return n&&=ds(n),e&&=ds(e),t.filter(n&&e?t=>n.has(t.x)&&e.has(t.y):n?t=>n.has(t.x):t=>e.has(t.y)).sort(n&&e?(t,r)=>n.get(t.x)-n.get(r.x)||e.get(t.y)-e.get(r.y):n?(t,e)=>n.get(t.x)-n.get(e.x):(t,n)=>e.get(t.y)-e.get(n.y))}(p,O),S=function(t,n,{marginTop:e,marginLeft:r}){return t&&n?({x:o,y:i})=>`translate(${t(o)-r},${n(i)-e})`:t?({x:n})=>`translate(${t(n)-r},0)`:({y:t})=>`translate(0,${n(t)-e})`}(x,w,g));for(const[t,n]of m)n.values=t.scale(n.channels,v,$);const{width:N,height:C}=g;Ne(L).attr("class",s).attr("fill","currentColor").attr("font-family","system-ui, sans-serif").attr("font-size",10).attr("text-anchor","middle").attr("width",N).attr("height",C).attr("viewBox",`0 0 ${N} ${C}`).attr("aria-label",a).attr("aria-description",l).call((t=>t.append("style").text(`:where(.${s}) {\n  --plot-background: white;\n  display: block;\n  height: auto;\n  height: intrinsic;\n  max-width: 100%;\n}\n:where(.${s} text),\n:where(.${s} tspan) {\n  white-space: pre;\n}`))).call(fc,e);for(const t of c){const{channels:n,values:e,facets:r}=m.get(t);if(void 0===p||"super"===t.facet){let o=null;if(r&&(o=r[0],o=t.filter(o,n,e),0===o.length))continue;const i=t.render(o,v,e,k,$);if(null==i)continue;L.appendChild(i)}else{let o;for(const i of p){if(!(t.facetAnchor?.(p,O,i)??!i.empty))continue;let a=null;if(r){const o=f.has(t);if(a=r[o?i.i:0],a=t.filter(a,n,e),0===a.length)continue;o||a!==r[0]||(a=ni(a)),a.fx=i.x,a.fy=i.y,a.fi=i.i}const l=t.render(a,v,e,b,$);if(null!=l){(o??=Ne(L).append("g")).append((()=>l)).datum(i);for(const t of["aria-label","aria-description","aria-hidden","transform"])l.hasAttribute(t)&&(o.attr(t,l.getAttribute(t)),l.removeAttribute(t))}}o?.selectChildren().attr("transform",S)}}const T=function(t,n,e){const r=[];for(const[o,i]of kf){const a=e[o];if(a?.legend&&o in t){const e=i(t[o],Mf(n,t[o],a),(n=>t[n]));null!=e&&r.push(e)}}return r}(y,$,t),{figure:R=null!=r||null!=o||null!=i||T.length>0}=t;R&&(A=M.createElement("figure"),A.className=`${s}-figure`,A.style.maxWidth="initial",null!=r&&A.append(Pf(M,r,"h2")),null!=o&&A.append(Pf(M,o,"h3")),A.append(...T,L),null!=i&&A.append(function(t,n){const e=t.createElement("figcaption");return e.append(n),e}(M,i)),"value"in L&&(A.value=L.value,delete L.value)),A.scale=function(t){return n=>{if(!Fi.has(n=`${n}`))throw new Error(`unknown scale: ${n}`);return t[n]}}(v.scales),A.legend=function(t,n,e={}){return(r,o)=>{if(!kf.has(r))throw new Error(`unknown legend type: ${r}`);if(r in t)return kf.get(r)(t[r],Mf(n,e[r],o),(n=>t[n]))}}(y,$,t);const I=function(){const t=Ll;return Ll=0,Ml=void 0,t}();return I>0&&Ne(L).append("text").attr("x",N).attr("y",20).attr("dy","-1em").attr("text-anchor","end").attr("font-family","initial").text("⚠️").append("title").text(`${I.toLocaleString("en-US")} warning${1===I?"":"s"}. Please check the console.`),A}function Pf(t,n,e){if(n.ownerDocument)return n;const r=t.createElement(e);return r.append(n),r}function Vf(t){return t.flat(1/0).filter((t=>null!=t)).map(Hf)}function Hf(t){return"function"==typeof t.render?t:new Yf(t)}class Yf extends dc{constructor(t){if("function"!=typeof t)throw new TypeError("invalid mark; missing render function");super(),this.render=t}render(){}}function Uf(t,n){for(const e in t)Xf(t[e],n);return t}function Xf(t,n){const{scale:e,transform:r=!0}=t;if(null==e||!r)return;const{type:o,percent:i,interval:a,transform:l=(i?t=>null==t?NaN:100*t:ci(a,o))}=n[e]??{};null!=l&&(t.value=Do(t.value,l),t.transform=!1)}function Gf(t){for(const n in t)_a(n,t[n])}function Zf(t,n,e,r=$o){for(const{channels:o}of n.values())for(const n in o){const i=o[n],{scale:a}=i;if(null!=a&&r(a))if("projection"===a){if(!Cs(e)){const n=void 0===e.x?.domain,r=void 0===e.y?.domain;if(n||r){const[e,o]=Rs(i);n&&Jf(t,"x",e),r&&Jf(t,"y",o)}}}else Jf(t,a,i)}return t}function Jf(t,n,e){const r=t.get(n);void 0!==r?r.push(e):t.set(n,[e])}function Kf(t,n,e){if(null===t.facet||"super"===t.facet)return;const{fx:r,fy:o}=t;if(null!=r||null!=o){const n=Fo(t.data??r??o);if(void 0===n)throw new Error(`missing facet data in ${t.ariaLabel}`);if(null===n)return;const i={};return null!=r&&(i.fx=Fa(n,{value:r,scale:"fx"})),null!=o&&(i.fy=Fa(n,{value:o,scale:"fy"})),Uf(i,e),{channels:i,groups:cs(n,i)}}if(void 0===n)return;const{channels:i,groups:a,data:l}=n;if("auto"!==t.facet||t.data===l)return{channels:i,groups:a};l.length>0&&(a.size>1||1===a.size&&i.fx&&i.fy&&[...a][0][1].size>1)&&Fo(t.data)?.length===l.length&&Al(`Warning: the ${t.ariaLabel} mark appears to use faceted data, but isn’t faceted. The mark data has the same length as the facet data and the mark facet option is "auto", but the mark data and facet data are distinct. If this mark should be faceted, set the mark facet option to true; otherwise, suppress this warning by setting the mark facet option to false.`)}function Qf(t,n={}){return Ui({...n,x:null,y:null},((n,e,r,o,i,a)=>a.getMarkState(t)))}function th(t,n,e,r,o,i,a){if(!n)return;const l=/^\s*both\s*$/i.test(n);a=function(t,n,{line:e=n.line,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h=n.label,labelAnchor:d,labelArrow:p=n.labelArrow,labelOffset:m}){return{anchor:t,line:e,ticks:r,tickSize:o,tickSpacing:i,tickPadding:a,tickFormat:l,tickRotate:s,fontVariant:c,ariaLabel:u,ariaDescription:f,label:h,labelAnchor:d,labelArrow:p,labelOffset:m}}(l?r:n,i,a);const{line:s}=a;e!==Uu&&e!==Gu||!s||Ei(s)||t.push(Sf(function(t){const{anchor:n,line:e}=t;return{anchor:n,facetAnchor:n+"-empty",stroke:!0===e?void 0:e}}(a))),t.push(e(a)),l&&t.push(e({...a,anchor:o,label:null}))}function nh(t,n,e,r){n&&!Ei(n)&&t.push(e(function(t,{stroke:n=(Mi(t)?t:void 0),ticks:e=(eh(t)?t:void 0),tickSpacing:r,ariaLabel:o,ariaDescription:i}){return{stroke:n,ticks:e,tickSpacing:r,ariaLabel:o,ariaDescription:i}}(n,r)))}function eh(t){switch(typeof t){case"number":return!0;case"string":return!Mi(t)}return mi(t)||"function"==typeof t?.range}function rh(t,n){const e=`${n}-axis `;return t.some((t=>t.ariaLabel?.startsWith(e)))}function oh(t,n){for(const e of n)for(const n in e.channels){const{scale:r}=e.channels[n];if(r===t||"projection"===r)return!0}return!1}function ih(t){const n=t.domain();let e=t(n[0]),r=t(n[n.length-1]);return r<e&&([e,r]=[r,e]),[e,r+t.bandwidth()]}const ah=new Map([["basis",De],["basis-closed",qe],["basis-open",_e],["bundle",Pe],["bump-x",Ve],["bump-y",He],["cardinal",Ye],["cardinal-closed",Ue],["cardinal-open",Xe],["catmull-rom",Ge],["catmull-rom-closed",Ze],["catmull-rom-open",Je],["linear",Fe],["linear-closed",Ke],["monotone-x",Qe],["monotone-y",tr],["natural",nr],["step",er],["step-after",rr],["step-before",or]]);function lh(t=Fe,n){if("function"==typeof t)return t;const e=ah.get(`${t}`.toLowerCase());if(!e)throw new Error(`unknown curve: ${t}`);if(void 0!==n){if("beta"in e)return e.beta(n);if("tension"in e)return e.tension(n);if("alpha"in e)return e.alpha(n)}return e}function sh(t=ch,n){return"function"!=typeof t&&"auto"===`${t}`.toLowerCase()?ch:lh(t,n)}function ch(t){return Fe(t)}function uh(t={y:"count"},n={}){[t,n]=gh(t,n);const{x:e,y:r}=n;return yh(vh(e,n,bo),null,null,r,t,Dc(n))}function fh(t={x:"count"},n={}){[t,n]=gh(t,n);const{x:e,y:r}=n;return yh(null,vh(r,n,bo),e,null,t,qc(n))}function hh(t={fill:"count"},n={}){[t,n]=gh(t,n);const{x:e,y:r}=function(t){let{x:n,y:e}=t;return n=vh(n,t),e=vh(e,t),[n.value,e.value]=Zo(n.value,e.value),{x:n,y:e}}(n);return yh(e,r,null,null,t,Dc(qc(n)))}function dh(t,n,e={}){if(null==e?.interval)return e;const{reduce:r=za}=e,o={filter:null};return null!=e[n]&&(o[n]=r),null!=e[`${n}1`]&&(o[`${n}1`]=r),null!=e[`${n}2`]&&(o[`${n}2`]=r),t(o,e)}function ph(t={}){return dh(uh,"y",gc(t,"x"))}function mh(t={}){return dh(fh,"x",gc(t,"y"))}function yh(t,n,e,r,{data:o=Ea,filter:i=Na,sort:a,reverse:l,...s}={},c={}){t=xh(t),n=xh(n),s=function(t,n){return ha(t,n,bh)}(s,c),o=$h(o,bo),a=null==a?void 0:bh("sort",a,c),i=null==i?void 0:kh("filter",i,c),null!=e&&fa(s,"x","x1","x2")&&(e=null),null!=r&&fa(s,"y","y1","y2")&&(r=null);const[u,f]=ii(t),[h,d]=ii(t),[p,m]=ii(n),[y,g]=ii(n),[v,x]=null!=e?[e,"x"]:null!=r?[r,"y"]:[],[w,b]=ii(v),{x:k,y:$,z:M,fill:L,stroke:A,x1:E,x2:z,y1:O,y2:S,domain:N,cumulative:C,thresholds:T,interval:R,...I}=c,[W,j]=ii(M),[B]=Io(L),[F]=Io(A),[D,q]=ii(B),[_,P]=ii(F);return{..."z"in c&&{z:W||M},..."fill"in c&&{fill:D||L},..."stroke"in c&&{stroke:_||A},...Yi(I,((e,r,c)=>{const u=si(mo(e,v),c?.[x]),h=mo(e,M),p=mo(e,B),y=mo(e,F),w=$a(s,{z:h,fill:p,stroke:y}),k=[],$=[],L=u&&b([]),A=h&&j([]),E=p&&q([]),z=y&&P([]),O=t&&f([]),S=t&&d([]),N=n&&m([]),C=n&&g([]),T=function(t,n,e){const r=t?.(e),o=n?.(e);return r&&o?function*(t){const n=r.bin(t);for(const[t,[i,a]]of r.entries()){const r=o.bin(n[t]);for(const[t,[n,l]]of o.entries())yield[r[t],{data:e,x1:i,y1:n,x2:a,y2:l}]}}:r?function*(t){const n=r.bin(t);for(const[t,[o,i]]of r.entries())yield[n[t],{data:e,x1:o,x2:i}]}:function*(t){const n=o.bin(t);for(const[t,[r,i]]of o.entries())yield[n[t],{data:e,y1:r,y2:i}]}}(t,n,e);let R=0;for(const t of s)t.initialize(e);a&&a.initialize(e),i&&i.initialize(e);for(const t of r){const n=[];for(const n of s)n.scope("facet",t);a&&a.scope("facet",t),i&&i.scope("facet",t);for(const[r,l]of ma(t,w))for(const[t,c]of ma(l,u))for(const[l,f]of T(c))if(w&&(f.z=r),!i||i.reduce(l,f)){n.push(R++),$.push(o.reduceIndex(l,e,f)),u&&L.push(t),h&&A.push(w===h?r:h[(l.length>0?l:c)[0]]),p&&E.push(w===p?r:p[(l.length>0?l:c)[0]]),y&&z.push(w===y?r:y[(l.length>0?l:c)[0]]),O&&(O.push(f.x1),S.push(f.x2)),N&&(N.push(f.y1),C.push(f.y2));for(const t of s)t.reduce(l,f);a&&a.reduce(l,f)}k.push(n)}return Ma(k,a,l),{data:$,facets:k}})),...!fa(s,"x")&&(u?{x1:u,x2:h,x:li(u,h)}:{x:k,x1:E,x2:z}),...!fa(s,"y")&&(p?{y1:p,y2:y,y:li(p,y)}:{y:$,y1:O,y2:S}),...w&&{[x]:w},...Object.fromEntries(s.map((({name:t,output:n})=>[t,n])))}}function gh({cumulative:t,domain:n,thresholds:e,interval:r,...o},i){return[o,{cumulative:t,domain:n,thresholds:e,interval:r,...i}]}function vh(t,{cumulative:n,domain:e,thresholds:r,interval:o},i){return void 0===(t={...pi(t)}).domain&&(t.domain=e),void 0===t.cumulative&&(t.cumulative=n),void 0===t.thresholds&&(t.thresholds=r),void 0===t.interval&&(t.interval=o),void 0===t.value&&(t.value=i),t.thresholds=wh(t.thresholds,t.interval),t}function xh(t){if(null==t)return;const{value:n,cumulative:e,domain:r=qn,thresholds:o}=t,i=t=>{let i,a=mo(t,n);if(vi(a)||(function(t){return di(t)&&"function"==typeof t?.floor&&t.floor()instanceof Date}(l=o)||mi(l)&&vi(l))){a=Do(a,Ro,Float64Array);let[t,n]="function"==typeof r?r(a):r,e="function"!=typeof o||di(o)?o:o(a,t,n);"number"==typeof e&&(e=sr(t,n,e)),di(e)&&(r===qn&&(t=e.floor(t),n=e.offset(e.floor(n))),e=e.range(t,e.offset(n))),i=e}else{a=No(a);let[t,n]="function"==typeof r?r(a):r,e="function"!=typeof o||di(o)?o:o(a,t,n);if("number"==typeof e)if(r===qn){let r=cr(t,n,e);if(isFinite(r))if(r>0){let o=Math.round(t/r),i=Math.round(n/r);o*r<=t||--o,i*r>n||++i;let a=i-o+1;e=new Float64Array(a);for(let t=0;t<a;++t)e[t]=(o+t)*r}else if(r<0){r=-r;let o=Math.round(t*r),i=Math.round(n*r);o/r<=t||--o,i/r>n||++i;let a=i-o+1;e=new Float64Array(a);for(let t=0;t<a;++t)e[t]=(o+t)/r}else e=[t];else e=[t]}else e=_n(t,n,e);else di(e)&&(r===qn&&(t=e.floor(t),n=e.offset(e.floor(n))),e=e.range(t,e.offset(n)));i=e}var l;const s=[];if(1===i.length)s.push([i[0],i[0]]);else for(let t=1;t<i.length;++t)s.push([i[t-1],i[t]]);return s.bin=(e<0?zh:e>0?Eh:Ah)(s,i,a),s};return i.label=ai(n),i}function wh(t,n,e=Lh){if(void 0===t)return void 0===n?e:hi(n);if("string"==typeof t){switch(t.toLowerCase()){case"freedman-diaconis":return lr;case"scott":return ar;case"sturges":return ir;case"auto":return Lh}return io(t)}return t}function bh(t,n,e){return da(t,n,e,kh)}function kh(t,n,e){return pa(t,n,e,$h)}function $h(t,n){return ya(t,n,Mh)}function Mh(t){switch(`${t}`.toLowerCase()){case"x":return Sh;case"x1":return Ch;case"x2":return Th;case"y":return Nh;case"y1":return Rh;case"y2":return Ih;case"z":return ja}throw new Error(`invalid bin reduce: ${t}`)}function Lh(t,n,e){return Math.min(200,ar(t,n,e))}function Ah(t,n,e){return n=No(n),r=>{const o=t.map((()=>[]));for(const t of r)o[ur(n,e[t])-1]?.push(t);return o}}function Eh(t,n,e){const r=Ah(t,n,e);return t=>{const n=r(t);for(let t=1,e=n.length;t<e;++t){const e=n[t-1],r=n[t];for(const t of e)r.push(t)}return n}}function zh(t,n,e){const r=Ah(t,n,e);return t=>{const n=r(t);for(let t=n.length-2;t>=0;--t){const e=n[t+1],r=n[t];for(const t of e)r.push(t)}return n}}function Oh(t,n){const e=(+t+ +n)/2;return t instanceof Date?new Date(e):e}const Sh={reduceIndex:(t,n,{x1:e,x2:r})=>Oh(e,r)},Nh={reduceIndex:(t,n,{y1:e,y2:r})=>Oh(e,r)},Ch={reduceIndex:(t,n,{x1:e})=>e},Th={reduceIndex:(t,n,{x2:e})=>e},Rh={reduceIndex:(t,n,{y1:e})=>e},Ih={reduceIndex:(t,n,{y2:e})=>e};function Wh(t={}){return _o(t)?t:{...t,x:bo}}function jh(t={}){return Po(t)?t:{...t,y:bo}}function Bh(t={},n={}){1===arguments.length&&([t,n]=Yh(t));const{y1:e,y:r=e,x:o,...i}=n,[a,l,s,c]=Xh(r,o,"y","x",t,i);return{...a,y1:e,y:l,x1:s,x2:c,x:li(s,c)}}function Fh(t={},n={}){1===arguments.length&&([t,n]=Yh(t));const{y1:e,y:r=e,x:o}=n,[i,a,l]=Xh(r,o,"y","x",t,n);return{...i,y1:e,y:a,x:l}}function Dh(t={},n={}){1===arguments.length&&([t,n]=Yh(t));const{y1:e,y:r=e,x:o}=n,[i,a,,l]=Xh(r,o,"y","x",t,n);return{...i,y1:e,y:a,x:l}}function qh(t={},n={}){1===arguments.length&&([t,n]=Yh(t));const{x1:e,x:r=e,y:o,...i}=n,[a,l,s,c]=Xh(r,o,"x","y",t,i);return{...a,x1:e,x:l,y1:s,y2:c,y:li(s,c)}}function _h(t={},n={}){1===arguments.length&&([t,n]=Yh(t));const{x1:e,x:r=e,y:o}=n,[i,a,l]=Xh(r,o,"x","y",t,n);return{...i,x1:e,x:a,y:l}}function Ph(t={},n={}){1===arguments.length&&([t,n]=Yh(t));const{x1:e,x:r=e,y:o}=n,[i,a,,l]=Xh(r,o,"x","y",t,n);return{...i,x1:e,x:a,y:l}}function Vh({x:t,x1:n,x2:e,...r}={}){return r=gc(r,"y"),void 0===n&&void 0===e?Bh({x:t,...r}):([n,e]=Go(t,n,e),{...r,x1:n,x2:e})}function Hh({y:t,y1:n,y2:e,...r}={}){return r=gc(r,"x"),void 0===n&&void 0===e?qh({y:t,...r}):([n,e]=Go(t,n,e),{...r,y1:n,y2:e})}function Yh(t){const{offset:n,order:e,reverse:r,...o}=t;return[{offset:n,order:e,reverse:r},o]}const Uh={length:!0};function Xh(t,n=ko,e,r,{offset:o,order:i,reverse:a},l){if(null===n)throw new Error(`stack requires ${r}`);const s=Jo(l),[c,u]=ii(t),[f,h]=oi(n),[d,p]=oi(n);return f.hint=d.hint=Uh,o=function(t){if(null==t)return;if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"expand":case"normalize":return Zh;case"center":case"silhouette":return Jh;case"wiggle":return Kh}throw new Error(`unknown offset: ${t}`)}(o),i=function(t,n,e){if(void 0===t&&n===Kh)return nd(Rr);if(null==t)return;if("string"==typeof t){const n=t.startsWith("-"),r=n?Ir:Rr;switch((n?t.slice(1):t).toLowerCase()){case"value":case e:return function(t){return(n,e,r)=>(n,e)=>t(r[n],r[e])}(r);case"z":return function(t){return(n,e,r,o)=>(n,e)=>t(o[n],o[e])}(r);case"sum":return function(t){return od(t,((t,n,e,r)=>hr(Ko(t),(t=>tt(t,(t=>e[t]))),(t=>r[t]))))}(r);case"appearance":return function(t){return od(t,((t,n,e,r)=>hr(Ko(t),(t=>n[dr(t,(t=>e[t]))]),(t=>r[t]))))}(r);case"inside-out":return nd(r)}return ed(xo(t))}if("function"==typeof t)return(1===t.length?ed:rd)(t);if(Array.isArray(t))return r=t,od(Rr,(()=>r));var r;throw new Error(`invalid order: ${t}`)}(i,o,r),[Yi(l,((r,l,c)=>{({data:r,facets:l}=function(t,n){if(1===n.length)return{data:t,facets:n};const e=t.length,r=new Uint8Array(e);let o=0;for(const t of n)for(const n of t)r[n]&&++o,r[n]=1;if(0===o)return{data:t,facets:n};const i=(t=qo(t))[po]=new Uint32Array(e+o);n=n.map((t=>qo(t,Uint32Array)));let a=e;r.fill(0);for(const e of n)for(let n=0,o=e.length;n<o;++n){const o=e[n];r[o]?(e[n]=a,t[a]=t[o],i[a]=o,++a):i[o]=o,r[o]=1}return{data:t,facets:n}}(r,l));const f=null==t?void 0:u(si(mo(r,t),c?.[e])),d=mo(r,n,Float64Array),m=mo(r,s),y=i&&i(r,f,d,m),g=r.length,v=h(new Float64Array(g)),x=p(new Float64Array(g)),w=[];for(const t of l){const n=f?Array.from(J(t,(t=>f[t])).values()):[t];if(y)for(const t of n)t.sort(y);for(const t of n){let n=0,e=0;a&&t.reverse();for(const r of t){const t=d[r];t<0?n=x[r]=(v[r]=n)+t:t>0?e=x[r]=(v[r]=e)+t:x[r]=v[r]=e}}w.push(n)}return o&&o(w,v,x,m),{data:r,facets:l}})),c,f,d]}function Gh(t,n){let e=0,r=0;for(const o of t){const t=n[o];t<e&&(e=t),t>r&&(r=t)}return[e,r]}function Zh(t,n,e){for(const r of t)for(const t of r){const[r,o]=Gh(t,e);for(const i of t){const t=1/(o-r||1);n[i]=t*(n[i]-r),e[i]=t*(e[i]-r)}}}function Jh(t,n,e){for(const r of t){for(const t of r){const[r,o]=Gh(t,e);for(const i of t){const t=(o+r)/2;n[i]-=t,e[i]-=t}}Qh(r,n,e)}td(t,n,e)}function Kh(t,n,e,r){for(const o of t){const t=new he;let i=0;for(const a of o){let o=-1;const l=a.map((t=>Math.abs(e[t]-n[t]))),s=a.map((i=>{o=r?r[i]:++o;const a=e[i]-n[i],l=t.has(o)?a-t.get(o):0;return t.set(o,a),l})),c=[0,...fr(s)];for(const t of a)n[t]+=i,e[t]+=i;const u=tt(l);u&&(i-=tt(l,((t,n)=>(s[n]/2+c[n])*t))/u)}Qh(o,n,e)}td(t,n,e)}function Qh(t,n,e){const r=ct(t,(t=>ct(t,(t=>n[t]))));for(const o of t)for(const t of o)n[t]-=r,e[t]-=r}function td(t,n,e){const r=t.length;if(1===r)return;const o=t.map((t=>t.flat())),i=o.map((t=>(ct(t,(t=>n[t]))+N(t,(t=>e[t])))/2)),a=ct(i);for(let t=0;t<r;t++){const r=a-i[t];for(const i of o[t])n[i]+=r,e[i]+=r}}function nd(t){return od(t,((t,n,e,r)=>{const o=Ko(t),i=hr(o,(t=>n[dr(t,(t=>e[t]))]),(t=>r[t])),a=Q(o,(t=>tt(t,(t=>e[t]))),(t=>r[t])),l=[],s=[];let c=0;for(const t of i)c<0?(c+=a.get(t),l.push(t)):(c-=a.get(t),s.push(t));return s.reverse().concat(l)}))}function ed(t){return n=>{const e=mo(n,t);return(t,n)=>Rr(e[t],e[n])}}function rd(t){return n=>(e,r)=>t(n[e],n[r])}function od(t,n){return(e,r,o,i)=>{if(!i)throw new Error("missing channel: z");const a=new he(n(e,r,o,i).map(((t,n)=>[t,n])));return(n,e)=>t(a.get(i[n]),a.get(i[e]))}}const id={ariaLabel:"area",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class ad extends dc{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,z:a,curve:l,tension:s}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0},z:{value:Jo(n),optional:!0}},n,id),this.z=a,this.curve=lh(l,s)}filter(t){return t}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a}=e;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n,0,0).call((n=>n.selectAll().data(nc(t,[i,a,l,s],this,e)).enter().append("path").call(rc,this).call(Qs,this,e).attr("d",pr().curve(this.curve).defined((t=>t>=0)).x0((t=>i[t])).y0((t=>a[t])).x1((t=>l[t])).y1((t=>s[t]))))).node()}}function ld(t,n){return void 0===n?cd(t,{x:Ao,y:Eo}):new ad(t,n)}function sd(t,n){const{y:e=wo,...r}=mh(n);return new ad(t,Vh(Wh({...r,y1:e,y2:void 0})))}function cd(t,n){const{x:e=wo,...r}=ph(n);return new ad(t,Hh(jh({...r,x1:e,x2:void 0})))}const ud={ariaLabel:"link",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class fd extends dc{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,curve:a,tension:l}=n;super(t,{x1:{value:e,scale:"x"},y1:{value:r,scale:"y"},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,ud),this.curve=sh(a,l),Oc(this,n)}project(t,n,e){this.curve!==ch&&super.project(t,n,e)}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a}=e,{curve:c}=this;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(rc,this).attr("d",c===ch&&o.projection?function(t,n,e,r,o){const i=pe(t);return n=No(n),e=No(e),r=No(r),o=No(o),t=>i({type:"LineString",coordinates:[[n[t],e[t]],[r[t],o[t]]]})}(o.projection,i,a,l,s):t=>{const n=je(),e=c(n);return e.lineStart(),e.point(i[t],a[t]),e.point(l[t],s[t]),e.lineEnd(),n}).call(Ks,this,e).call(jc,this,e,o))).node()}}function hd(t,{x:n,x1:e,x2:r,y:o,y1:i,y2:a,...l}={}){return[e,r]=dd(n,e,r),[i,a]=dd(o,i,a),new fd(t,{...l,x1:e,x2:r,y1:i,y2:a})}function dd(t,n,e){if(void 0===t){if(void 0===n){if(void 0!==e)return[e]}else if(void 0===e)return[n]}else{if(void 0===n)return void 0===e?[t]:[t,e];if(void 0===e)return[t,n]}return[n,e]}const pd={ariaLabel:"arrow",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeMiterlimit:1,strokeWidth:1.5};class md extends dc{constructor(e,r={}){const{x1:o,y1:i,x2:a,y2:l,bend:s=0,headAngle:c=60,headLength:u=8,inset:f=0,insetStart:h=f,insetEnd:d=f,sweep:p}=r;super(e,{x1:{value:o,scale:"x"},y1:{value:i,scale:"y"},x2:{value:a,scale:"x",optional:!0},y2:{value:l,scale:"y",optional:!0}},r,pd),this.bend=!0===s?22.5:Math.max(-90,Math.min(90,s)),this.headAngle=+c,this.headLength=+u,this.insetStart=+h,this.insetEnd=+d,this.sweep=function(e=1){if("number"==typeof e)return Oo(Math.sign(e));if("function"==typeof e)return(t,n,r,o)=>Math.sign(e(t,n,r,o));switch(Bo(e,"sweep",["+x","-x","+y","-y"])){case"+x":return(n,e,r)=>t(n,r);case"-x":return(t,e,r)=>n(t,r);case"+y":return(n,e,r,o)=>t(e,o);case"-y":return(t,e,r,o)=>n(e,o)}}(p)}render(t,n,e,r,o){const{x1:i,y1:a,x2:l=i,y2:s=a,SW:c}=e,{strokeWidth:u,bend:f,headAngle:h,headLength:d,insetStart:p,insetEnd:m}=this,y=c?t=>c[t]:Oo(void 0===u?1:u),g=h*zc/2,v=d/1.5;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((n=>n.selectAll().data(t).enter().append("path").call(rc,this).attr("d",(t=>{let n=i[t],e=a[t],r=l[t],o=s[t];const c=Math.hypot(r-n,o-e);if(c<=p+m)return null;let u=Math.atan2(o-e,r-n);const h=Math.min(v*y(t),c/3),d=this.sweep(n,e,r,o)*f*zc,x=Math.hypot(c/Math.tan(d),c)/2;if(p||m)if(x<1e5){const t=Math.sign(d),[i,a]=function([t,n],[e,r],o,i){const a=e-t,l=r-n,s=Math.hypot(a,l),c=i*Math.sqrt(o*o-s*s/4)/s;return[(t+e)/2-l*c,(n+r)/2+a*c]}([n,e],[r,o],x,t);if(p&&([n,e]=yd([i,a,x],[n,e,p],-t*Math.sign(p))),m){const[n,e]=yd([i,a,x],[r,o,m],t*Math.sign(m));u+=Math.atan2(e-a,n-i)-Math.atan2(o-a,r-i),r=n,o=e}}else{const t=r-n,i=o-e,a=Math.hypot(t,i);p&&(n+=t/a*p,e+=i/a*p),m&&(r-=t/a*m,o-=i/a*m)}const w=u+d,b=w+g,k=w-g,$=r-h*Math.cos(b),M=o-h*Math.sin(b),L=r-h*Math.cos(k),A=o-h*Math.sin(k);return`M${n},${e}${x<1e5?`A${x},${x} 0,0,${d>0?1:0} `:"L"}${r},${o}${h?`M${$},${M}L${r},${o}L${L},${A}`:""}`})).call(Ks,this,e))).node()}}function yd([t,n,e],[r,o,i],a){const l=r-t,s=o-n,c=Math.hypot(l,s),u=(l*l+s*s-i*i+e*e)/(2*c),f=a*Math.sqrt(e*e-u*u);return[t+(l*u+s*f)/c,n+(s*u-l*f)/c]}function gd(t,{x:n,x1:e,x2:r,y:o,y1:i,y2:a,...l}={}){return[e,r]=dd(n,e,r),[i,a]=dd(o,i,a),new md(t,{...l,x1:e,x2:r,y1:i,y2:a})}class vd extends dc{constructor(t,n,e={},r){super(t,n,e,r);const{inset:o=0,insetTop:i=o,insetRight:a=o,insetBottom:l=o,insetLeft:s=o,rx:c,ry:u}=e;this.insetTop=Lo(i),this.insetRight=Lo(a),this.insetBottom=Lo(l),this.insetLeft=Lo(s),this.rx=lc(c,"auto"),this.ry=lc(u,"auto")}render(t,n,e,r,o){const{rx:i,ry:a}=this;return Ws("svg:g",o).call(ec,this,r,o).call(this._transform,this,n).call((o=>o.selectAll().data(t).enter().append("rect").call(rc,this).attr("x",this._x(n,e,r)).attr("width",this._width(n,e,r)).attr("y",this._y(n,e,r)).attr("height",this._height(n,e,r)).call(ic,"rx",i).call(ic,"ry",a).call(Ks,this,e))).node()}_x(t,{x:n},{marginLeft:e}){const{insetLeft:r}=this;return n?t=>n[t]+r:e+r}_y(t,{y:n},{marginTop:e}){const{insetTop:r}=this;return n?t=>n[t]+r:e+r}_width({x:t},{x:n},{marginRight:e,marginLeft:r,width:o}){const{insetLeft:i,insetRight:a}=this,l=n&&t?t.bandwidth():o-e-r;return Math.max(0,l-i-a)}_height({y:t},{y:n},{marginTop:e,marginBottom:r,height:o}){const{insetTop:i,insetBottom:a}=this,l=n&&t?t.bandwidth():o-e-r;return Math.max(0,l-i-a)}}const xd={ariaLabel:"bar"};class wd extends vd{constructor(t,n={}){const{x1:e,x2:r,y:o}=n;super(t,{x1:{value:e,scale:"x"},x2:{value:r,scale:"x"},y:{value:o,scale:"y",type:"band",optional:!0}},n,xd)}_transform(t,n,{x:e}){t.call(ac,n,{x:e},0,0)}_x({x:t},{x1:n,x2:e},{marginLeft:r}){const{insetLeft:o}=this;return os(t)?r+o:t=>Math.min(n[t],e[t])+o}_width({x:t},{x1:n,x2:e},{marginRight:r,marginLeft:o,width:i}){const{insetLeft:a,insetRight:l}=this;return os(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(e[t]-n[t])-a-l)}}class bd extends vd{constructor(t,n={}){const{x:e,y1:r,y2:o}=n;super(t,{y1:{value:r,scale:"y"},y2:{value:o,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},n,xd)}_transform(t,n,{y:e}){t.call(ac,n,{y:e},0,0)}_y({y:t},{y1:n,y2:e},{marginTop:r}){const{insetTop:o}=this;return os(t)?r+o:t=>Math.min(n[t],e[t])+o}_height({y:t},{y1:n,y2:e},{marginTop:r,marginBottom:o,height:i}){const{insetTop:a,insetBottom:l}=this;return os(t)?i-r-o-a-l:t=>Math.max(0,Math.abs(e[t]-n[t])-a-l)}}function kd(t,n={}){return Vo(n)||(n={...n,y:wo,x2:bo}),new wd(t,Vh(Xc(Wh(n))))}function $d(t,n={}){return Vo(n)||(n={...n,x:wo,y2:bo}),new bd(t,Hh(Gc(jh(n))))}const Md={ariaLabel:"cell"};class Ld extends vd{constructor(t,{x:n,y:e,...r}={}){super(t,{x:{value:n,scale:"x",type:"band",optional:!0},y:{value:e,scale:"y",type:"band",optional:!0}},r,Md)}_transform(t,n){t.call(ac,n,{},0,0)}}function Ad(t,{x:n,y:e,...r}={}){return[n,e]=Zo(n,e),new Ld(t,{...r,x:n,y:e})}function Ed(t,{x:n=wo,fill:e,stroke:r,...o}={}){return void 0===e&&void 0===Io(r)[0]&&(e=bo),new Ld(t,{...o,x:n,fill:e,stroke:r})}function zd(t,{y:n=wo,fill:e,stroke:r,...o}={}){return void 0===e&&void 0===Io(r)[0]&&(e=bo),new Ld(t,{...o,y:n,fill:e,stroke:r})}const Od={ariaLabel:"dot",fill:"none",stroke:"currentColor",strokeWidth:1.5};function Sd(t){return void 0===t.sort&&void 0===t.reverse?ea({channel:"-r"},t):t}class Nd extends dc{constructor(t,n={}){const{x:e,y:r,r:o,rotate:i,symbol:a=B,frameAnchor:l}=n,[s,c]=Wo(i,0),[u,f]=function(t){if(null==t||Pi(t))return[void 0,t];if("string"==typeof t){const n=_i.get(`${t}`.toLowerCase());if(n)return[void 0,n]}return[t,void 0]}(a),[h,d]=Wo(o,null==u?3:4.5);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:h,scale:"r",filter:Br,optional:!0},rotate:{value:s,optional:!0},symbol:{value:u,scale:"auto",optional:!0}},Sd(n),Od),this.r=d,this.rotate=c,this.symbol=f,this.frameAnchor=Oi(l);const{channels:p}=this,{symbol:m}=p;if(m){const{fill:t,stroke:n}=p;m.hint={fill:t?t.value===m.value?"color":"currentColor":this.fill??"currentColor",stroke:n?n.value===m.value?"color":"currentColor":this.stroke??"none"}}}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,r:c,rotate:u,symbol:f}=e,{r:h,rotate:d,symbol:p}=this,[m,y]=hc(this,r),g=p===B,v=c?void 0:h*h*Math.PI;return Fr(h)&&(t=[]),Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append(g?"circle":"path").call(rc,this).call(g?t=>{t.attr("cx",l?t=>l[t]:m).attr("cy",s?t=>s[t]:y).attr("r",c?t=>c[t]:h)}:t=>{t.attr("transform",ou`translate(${l?t=>l[t]:m},${s?t=>s[t]:y})${u?t=>` rotate(${u[t]})`:d?` rotate(${d})`:""}`).attr("d",c&&f?t=>{const n=je();return f[t].draw(n,c[t]*c[t]*Math.PI),n}:c?t=>{const n=je();return p.draw(n,c[t]*c[t]*Math.PI),n}:f?t=>{const n=je();return f[t].draw(n,v),n}:(()=>{const t=je();return p.draw(t,v),t})())}).call(Ks,this,e))).node()}}function Cd(t,{x:n,y:e,...r}={}){return void 0===r.frameAnchor&&([n,e]=Zo(n,e)),new Nd(t,{...r,x:n,y:e})}function Td(t,{x:n=bo,...e}={}){return new Nd(t,Jc({...e,x:n}))}function Rd(t,{y:n=bo,...e}={}){return new Nd(t,Zc({...e,y:n}))}function Id(t,n){return Cd(t,{...n,symbol:"circle"})}function Wd(t,n){return Cd(t,{...n,symbol:"hexagon"})}const jd={ariaLabel:"line",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Bd extends dc{constructor(t,n={}){const{x:e,y:r,z:o,curve:i,tension:a}=n;super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y"},z:{value:Jo(n),optional:!0}},n,jd),this.z=o,this.curve=sh(i,a),Oc(this,n)}filter(t){return t}project(t,n,e){this.curve!==ch&&super.project(t,n,e)}render(t,n,e,r,o){const{x:i,y:a}=e,{curve:l}=this;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((n=>n.selectAll().data(nc(t,[i,a],this,e)).enter().append("path").call(rc,this).call(Qs,this,e).call(Bc,this,e,o).attr("d",l===ch&&o.projection?function(t,n,e){const r=pe(t);return n=No(n),e=No(e),t=>{let o=[];const i=[o];for(const r of t)-1===r?(o=[],i.push(o)):o.push([n[r],e[r]]);return r({type:"MultiLineString",coordinates:i})}}(o.projection,i,a):mr().curve(l).defined((t=>t>=0)).x((t=>i[t])).y((t=>a[t]))))).node()}}function Fd(t,{x:n,y:e,...r}={}){return[n,e]=Zo(n,e),new Bd(t,{...r,x:n,y:e})}function Dd(t,{x:n=bo,y:e=wo,...r}={}){return new Bd(t,mh({...r,x:n,y:e}))}function qd(t,{x:n=wo,y:e=bo,...r}={}){return new Bd(t,ph({...r,x:n,y:e}))}const _d={ariaLabel:"rect"};class Pd extends dc{constructor(t,n={}){const{x1:e,y1:r,x2:o,y2:i,inset:a=0,insetTop:l=a,insetRight:s=a,insetBottom:c=a,insetLeft:u=a,rx:f,ry:h}=n;super(t,{x1:{value:e,scale:"x",type:null!=e&&null==o?"band":void 0,optional:!0},y1:{value:r,scale:"y",type:null!=r&&null==i?"band":void 0,optional:!0},x2:{value:o,scale:"x",optional:!0},y2:{value:i,scale:"y",optional:!0}},n,_d),this.insetTop=Lo(l),this.insetRight=Lo(s),this.insetBottom=Lo(c),this.insetLeft=Lo(u),this.rx=lc(f,"auto"),this.ry=lc(h,"auto")}render(t,n,e,r,o){const{x:i,y:a}=n,{x1:l,y1:s,x2:c,y2:u}=e,{marginTop:f,marginRight:h,marginBottom:d,marginLeft:p,width:m,height:y}=r,{projection:g}=o,{insetTop:v,insetRight:x,insetBottom:w,insetLeft:b,rx:k,ry:$}=this,M=(i?.bandwidth?i.bandwidth():0)-b-x,L=(a?.bandwidth?a.bandwidth():0)-v-w;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{},0,0).call((n=>n.selectAll().data(t).enter().append("rect").call(rc,this).attr("x",!l||!g&&os(i)?p+b:c?t=>Math.min(l[t],c[t])+b:t=>l[t]+b).attr("y",!s||!g&&os(a)?f+v:u?t=>Math.min(s[t],u[t])+v:t=>s[t]+v).attr("width",!l||!g&&os(i)?m-h-p-x-b:c?t=>Math.max(0,Math.abs(c[t]-l[t])+M):M).attr("height",!s||!g&&os(a)?y-f-d-v-w:u?t=>Math.max(0,Math.abs(s[t]-u[t])+L):L).call(ic,"rx",k).call(ic,"ry",$).call(Ks,this,e))).node()}}function Vd(t,n){return new Pd(t,Yc(Uc(n)))}function Hd(t,n={}){return Vo(n)||(n={...n,y:wo,x2:bo,interval:1}),new Pd(t,Vh(Uc(Wh(n))))}function Yd(t,n={}){return Vo(n)||(n={...n,x:wo,y2:bo,interval:1}),new Pd(t,Hh(Yc(jh(n))))}function Ud(t,n){n=function({x:t,y:n,color:e,size:r,fx:o,fy:i,mark:a}={}){Uo(t)||(t=Jd(t));Uo(n)||(n=Jd(n));Uo(e)||(e=Mi(e)?{color:e}:Jd(e));Uo(r)||(r=Jd(r));Uo(o)&&({value:o}=Jd(o));Uo(i)&&({value:i}=Jd(i));null!=a&&(a=`${a}`.toLowerCase());return{x:t,y:n,color:e,size:r,fx:o,fy:i,mark:a}}(n);const{x:e,y:r,color:o,size:i}=n,a=Zd(t,e),l=Zd(t,r),s=Zd(t,o),c=Zd(t,i);let u,f,h,{fx:d,fy:p,x:{value:m,reduce:y,zero:g,...v},y:{value:x,reduce:w,zero:b,...k},color:{value:$,color:M,reduce:L},size:{value:A,reduce:E},mark:z}=n;if(void 0===y&&(y=null==w&&null==m&&null==A&&null!=x?"count":null),void 0===w&&(w=null==y&&null==x&&null==A&&null!=m?"count":null),void 0!==E||null!=A||null!=L||null!=y||null!=w||null!=m&&!gi(a)||null!=x&&!gi(l)||(E="count"),void 0===g&&(g=!!Kd(y)||void 0),void 0===b&&(b=!!Kd(w)||void 0),null==m&&null==x)throw new Error("must specify x or y");if(null!=y&&null==x)throw new Error("reducing x requires y");if(null!=w&&null==m)throw new Error("reducing y requires x");switch(void 0===z&&(z=null!=A||null!=E?"dot":Kd(y)||Kd(w)||null!=L?"bar":null!=m&&null!=x?gi(a)||gi(l)||null==y&&null==w&&!Gd(a)&&!Gd(l)?"dot":"line":null!=m||null!=x?"rule":null),z){case"dot":h=Cd,f="stroke";break;case"line":h=a&&l||null!=y||null!=w?b||null!=w||a&&Gd(a)?qd:g||null!=y||l&&Gd(l)?Dd:Fd:a?Dd:qd,f="stroke",tp(s)&&(u=null);break;case"area":h=!b&&null==w&&(g||null!=y||l&&Gd(l))?sd:cd,f="fill",tp(s)&&(u=null);break;case"rule":h=a?nu:eu,f="stroke";break;case"bar":h=null!=y?gi(l)?Qd(y)&&a&&gi(a)?Ad:kd:Hd:null!=w?gi(a)?Qd(w)&&l&&gi(l)?Ad:$d:Yd:null!=L||null!=E?a&&gi(a)&&l&&gi(l)?Ad:a&&gi(a)?$d:l&&gi(l)?kd:Vd:!a||!bi(a)||l&&bi(l)?!l||!bi(l)||a&&bi(a)?Ad:$d:kd,f="fill";break;default:throw new Error(`invalid mark: ${z}`)}let O,S={fx:d,fy:p,x:a??void 0,y:l??void 0,[f]:s??M,z:u,r:c??void 0,tip:!0},N={[f]:L??void 0,r:E??void 0};if(null!=y&&null!=w)throw new Error("cannot reduce both x and y");return null!=w?(N.y=w,O=gi(a)?la:uh):null!=y?(N.x=y,O=gi(l)?sa:fh):null==L&&null==E||(a&&l?O=gi(a)&&gi(l)?ca:gi(a)?fh:gi(l)?uh:hh:a?O=gi(a)?la:uh:l&&(O=gi(l)?sa:fh)),O!==hh&&O!==uh||(S.x={value:a,...v}),O!==hh&&O!==fh||(S.y={value:l,...k}),void 0===g&&(g=a&&!(O===hh||O===uh)&&(h===kd||h===sd||h===Hd||h===eu)),void 0===b&&(b=l&&!(O===hh||O===fh)&&(h===$d||h===cd||h===Yd||h===nu)),{fx:d??null,fy:p??null,x:{value:m??null,reduce:y??null,zero:!!g,...v},y:{value:x??null,reduce:w??null,zero:!!b,...k},color:{value:$??null,reduce:L??null,...void 0!==M&&{color:M}},size:{value:A??null,reduce:E??null},mark:z,markImpl:ep[h],markOptions:S,transformImpl:ep[O],transformOptions:N,colorMode:f}}function Xd(t,n){const e=Ud(t,n),{fx:r,fy:o,x:{zero:i},y:{zero:a},markOptions:l,transformOptions:s,colorMode:c}=e,u=np[e.markImpl],f=np[e.transformImpl],h=null!=r||null!=o?Sf({strokeOpacity:.1}):null,d=[i?nu([0]):null,a?eu([0]):null],p=u(t,f?f(s,l):l);return"stroke"===c?pc(h,d,p):pc(h,p,d)}function Gd(n){let e,r;for(const o of n){if(null==o)continue;if(void 0===e){e=o;continue}const n=Math.sign(t(e,o));if(n){if(void 0!==r&&n!==r)return!1;e=o,r=n}}return!0}function Zd(t,n){const e=mo(t,n.value);return e&&(e.label=ai(n.value)),e}function Jd(t){return function(t){if(null==t)return!1;if("function"==typeof t.reduceIndex)return!0;if("function"==typeof t.reduce&&Ho(t))return!0;if(/^p\d{2}$/i.test(t))return!0;switch(`${t}`.toLowerCase()){case"first":case"last":case"count":case"distinct":case"sum":case"proportion":case"proportion-facet":case"deviation":case"min":case"min-index":case"max":case"max-index":case"mean":case"median":case"variance":case"mode":return!0}return!1}(t)?{reduce:t}:{value:t}}function Kd(t){return/^(?:distinct|count|sum|proportion)$/i.test(t)}function Qd(t){return/^(?:first|last|mode)$/i.test(t)}function tp(t){return!!t&&new nt(t).size>t.length>>1}const np={dot:Cd,line:Fd,lineX:Dd,lineY:qd,areaX:sd,areaY:cd,ruleX:nu,ruleY:eu,barX:kd,barY:$d,rect:Vd,rectX:Hd,rectY:Yd,cell:Ad,bin:hh,binX:uh,binY:fh,group:ca,groupX:la,groupY:sa},ep=Object.fromEntries(Object.entries(np).map((([t,n])=>[n,t])));function rp(t,n={}){let{x:e,x1:r,x2:o}=n;void 0===e&&void 0===r&&void 0===o&&(n={...n,x:e=bo});const i={};return null!=e&&(i.x=t),null!=r&&(i.x1=t),null!=o&&(i.x2=t),ip(i,n)}function op(t,n={}){let{y:e,y1:r,y2:o}=n;void 0===e&&void 0===r&&void 0===o&&(n={...n,y:e=bo});const i={};return null!=e&&(i.y=t),null!=r&&(i.y1=t),null!=o&&(i.y2=t),ip(i,n)}function ip(t={},n={}){const e=Jo(n),r=Object.entries(t).map((([t,e])=>{const r=ri(t,n);if(null==r)throw new Error(`missing channel: ${t}`);const[o,i]=oi(r);return{key:t,input:r,output:o,setOutput:i,map:ap(e)}}));return{...Yi(n,((t,n)=>{const o=mo(t,e),i=r.map((({input:n})=>mo(t,n))),a=r.map((({setOutput:n})=>n(new Array(t.length))));for(const t of n)for(const n of o?J(t,(t=>o[t])).values():[t])r.forEach((({map:t},e)=>t.mapIndex(n,i[e],a[e])));return{data:t,facets:n}})),...Object.fromEntries(r.map((({key:t,output:n})=>[t,n])))}}function ap(t){if(null==t)throw new Error("missing map");if("function"==typeof t.mapIndex)return t;if("function"==typeof t.map&&Ho(t))return function(t){return console.warn("deprecated map interface; implement mapIndex instead."),{mapIndex:t.map.bind(t)}}(t);if("function"==typeof t)return lp(ti(t));switch(`${t}`.toLowerCase()){case"cumsum":return sp;case"rank":return lp(((t,n)=>yr(t,(t=>n[t]))));case"quantile":return lp(((t,n)=>function(t,n){const e=gr(t,n)-1;return yr(t,n).map((t=>t/e))}(t,(t=>n[t]))))}throw new Error(`invalid map: ${t}`)}function lp(t){return{mapIndex(n,e,r){const o=t(n,e);if(o.length!==n.length)throw new Error("map function returned a mismatched length");for(let t=0,e=n.length;t<e;++t)r[n[t]]=o[t]}}}const sp={mapIndex(t,n,e){let r=0;for(const o of t)e[o]=r+=n[o]}};function cp(t={},n){return 1===arguments.length&&(n=t),rp(fp(t),n)}function up(t={},n){return 1===arguments.length&&(n=t),op(fp(t),n)}function fp(t={}){"number"==typeof t&&(t={k:t});let{k:n,reduce:e,shift:r,anchor:o,strict:i}=t;if(void 0===o&&void 0!==r&&(o=function(t){switch(`${t}`.toLowerCase()){case"centered":return"middle";case"leading":return"start";case"trailing":return"end"}throw new Error(`invalid shift: ${t}`)}(r),Al(`Warning: the shift option is deprecated; please use anchor "${o}" instead.`)),!((n=Math.floor(n))>0))throw new Error(`invalid k: ${n}`);return function(t="mean"){if("string"==typeof t){if(/^p\d{2}$/i.test(t))return hp(So(t));switch(t.toLowerCase()){case"deviation":return hp(ut);case"max":return dp(((t,n)=>N(t,(t=>n[t]))));case"mean":return mp;case"median":return hp(ot);case"min":return dp(((t,n)=>ct(t,(t=>n[t]))));case"mode":return dp(((t,n)=>et(t,(t=>n[t]))));case"sum":return pp;case"variance":return hp(rt);case"difference":return wp;case"ratio":return bp;case"first":return kp;case"last":return $p}}if("function"!=typeof t)throw new Error(`invalid reduce: ${t}`);return dp(ti(t))}(e)(n,function(t="middle",n){switch(`${t}`.toLowerCase()){case"middle":return n-1>>1;case"start":return 0;case"end":return n-1}throw new Error(`invalid anchor: ${t}`)}(o,n),i)}function hp(t){return(n,e,r)=>r?{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];let l=0;for(let t=0;t<n-1;++t)isNaN(a(t))&&++l;for(let o=0,s=r.length-n+1;o<s;++o)isNaN(a(o+n-1))&&++l,i[r[o+e]]=0===l?t(ni(r,o,o+n),a):NaN,isNaN(a(o))&&--l}}:{mapIndex(r,o,i){const a=t=>null==o[t]?NaN:+o[t];for(let o=-e;o<0;++o)i[r[o+e]]=t(ni(r,0,o+n),a);for(let o=0,l=r.length-e;o<l;++o)i[r[o+e]]=t(ni(r,o,o+n),a)}}}function dp(t){return(n,e,r)=>r?{mapIndex(r,o,i){let a=0;for(let t=0;t<n-1;++t)a+=Tr(o[r[t]]);for(let l=0,s=r.length-n+1;l<s;++l)a+=Tr(o[r[l+n-1]]),a===n&&(i[r[l+e]]=t(ni(r,l,l+n),o)),a-=Tr(o[r[l]])}}:{mapIndex(r,o,i){for(let a=-e;a<0;++a)i[r[a+e]]=t(ni(r,0,a+n),o);for(let a=0,l=r.length-e;a<l;++a)i[r[a+e]]=t(ni(r,a,a+n),o)}}}function pp(t,n,e){return e?{mapIndex(e,r,o){let i=0,a=0;for(let n=0;n<t-1;++n){const t=r[e[n]];null===t||isNaN(t)?++i:a+=+t}for(let l=0,s=e.length-t+1;l<s;++l){const s=r[e[l]],c=r[e[l+t-1]];null===c||isNaN(c)?++i:a+=+c,o[e[l+n]]=0===i?a:NaN,null===s||isNaN(s)?--i:a-=+s}}}:{mapIndex(e,r,o){let i=0;const a=e.length;for(let o=0,l=Math.min(a,t-n-1);o<l;++o)i+=+r[e[o]]||0;for(let l=-n,s=a-n;l<s;++l)i+=+r[e[l+t-1]]||0,o[e[l+n]]=i,i-=+r[e[l]]||0}}}function mp(t,n,e){if(e){const r=pp(t,n,e);return{mapIndex(e,o,i){r.mapIndex(e,o,i);for(let r=0,o=e.length-t+1;r<o;++r)i[e[r+n]]/=t}}}return{mapIndex(e,r,o){let i=0,a=0;const l=e.length;for(let o=0,s=Math.min(l,t-n-1);o<s;++o){let t=r[e[o]];null===t||isNaN(t=+t)||(i+=t,++a)}for(let s=-n,c=l-n;s<c;++s){let l=r[e[s+t-1]],c=r[e[s]];null===l||isNaN(l=+l)||(i+=l,++a),o[e[s+n]]=i/a,null===c||isNaN(c=+c)||(i-=c,--a)}}}}function yp(t,n,e,r){for(let o=e+r;e<o;++e){const r=t[n[e]];if(Tr(r))return r}}function gp(t,n,e,r){for(let o=e+r-1;o>=e;--o){const e=t[n[o]];if(Tr(e))return e}}function vp(t,n,e,r){for(let o=e+r;e<o;++e){let r=t[n[e]];if(null!==r&&!isNaN(r=+r))return r}}function xp(t,n,e,r){for(let o=e+r-1;o>=e;--o){let e=t[n[o]];if(null!==e&&!isNaN(e=+e))return e}}function wp(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i){const a=r[e[i]],l=r[e[i+t-1]];o[e[i+n]]=null===a||null===l?NaN:l-a}}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=xp(r,e,i,t)-vp(r,e,i,t)}}}function bp(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i){const a=r[e[i]],l=r[e[i+t-1]];o[e[i+n]]=null===a||null===l?NaN:l/a}}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=xp(r,e,i,t)/vp(r,e,i,t)}}}function kp(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i)o[e[i+n]]=r[e[i]]}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=yp(r,e,i,t)}}}function $p(t,n,e){return e?{mapIndex(e,r,o){for(let i=0,a=e.length-t;i<a;++i)o[e[i+n]]=r[e[i+t-1]]}}:{mapIndex(e,r,o){for(let i=-n,a=e.length-t+n+1;i<a;++i)o[e[i+n]]=gp(r,e,i,t)}}}const Mp={n:20,k:2,color:"currentColor",opacity:.2,strict:!0,anchor:"end"};function Lp(t,{x:n=bo,y:e,k:r=Mp.k,color:o=Mp.color,opacity:i=Mp.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return pc(Ai(a)?null:sd(t,ip({x1:Ep({k:-r,...f}),x2:Ep({k:r,...f})},{x1:n,x2:n,y:e,fill:a,fillOpacity:l,...f})),Ai(s)?null:Dd(t,ip({x:Ep(f)},{x:n,y:e,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))}function Ap(t,{x:n,y:e=bo,k:r=Mp.k,color:o=Mp.color,opacity:i=Mp.opacity,fill:a=o,fillOpacity:l=i,stroke:s=o,strokeOpacity:c,strokeWidth:u,...f}={}){return pc(Ai(a)?null:cd(t,ip({y1:Ep({k:-r,...f}),y2:Ep({k:r,...f})},{x:n,y1:e,y2:e,fill:a,fillOpacity:l,...f})),Ai(s)?null:qd(t,ip({y:Ep(f)},{x:n,y:e,stroke:s,strokeOpacity:c,strokeWidth:u,...f})))}function Ep({n:t=Mp.n,k:n=0,strict:e=Mp.strict,anchor:r=Mp.anchor}={}){return fp({k:t,reduce:t=>at(t)+n*(ut(t)||0),strict:e,anchor:r})}const zp={ariaLabel:"tick",fill:null,stroke:"currentColor"};class Op extends dc{constructor(t,n,e){super(t,n,e,zp),Oc(this,e)}render(t,n,e,r,o){return Ws("svg:g",o).call(ec,this,r,o).call(this._transform,this,n).call((i=>i.selectAll().data(t).enter().append("line").call(rc,this).attr("x1",this._x1(n,e,r)).attr("x2",this._x2(n,e,r)).attr("y1",this._y1(n,e,r)).attr("y2",this._y2(n,e,r)).call(Ks,this,e).call(jc,this,e,o))).node()}}class Sp extends Op{constructor(t,n={}){const{x:e,y:r,inset:o=0,insetTop:i=o,insetBottom:a=o}=n;super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y",type:"band",optional:!0}},n),this.insetTop=Lo(i),this.insetBottom=Lo(a)}_transform(t,n,{x:e}){t.call(ac,n,{x:e},Ys,0)}_x1(t,{x:n}){return t=>n[t]}_x2(t,{x:n}){return t=>n[t]}_y1({y:t},{y:n},{marginTop:e}){const{insetTop:r}=this;return n&&t?t=>n[t]+r:e+r}_y2({y:t},{y:n},{height:e,marginBottom:r}){const{insetBottom:o}=this;return n&&t?e=>n[e]+t.bandwidth()-o:e-r-o}}class Np extends Op{constructor(t,n={}){const{x:e,y:r,inset:o=0,insetRight:i=o,insetLeft:a=o}=n;super(t,{y:{value:r,scale:"y"},x:{value:e,scale:"x",type:"band",optional:!0}},n),this.insetRight=Lo(i),this.insetLeft=Lo(a)}_transform(t,n,{y:e}){t.call(ac,n,{y:e},0,Ys)}_x1({x:t},{x:n},{marginLeft:e}){const{insetLeft:r}=this;return n&&t?t=>n[t]+r:e+r}_x2({x:t},{x:n},{width:e,marginRight:r}){const{insetRight:o}=this;return n&&t?e=>n[e]+t.bandwidth()-o:e-r-o}_y1(t,{y:n}){return t=>n[t]}_y2(t,{y:n}){return t=>n[t]}}function Cp(t,{x:n=bo,...e}={}){return new Sp(t,{...e,x:n})}function Tp(t,{y:n=bo,...e}={}){return new Np(t,{...e,y:n})}function Rp(t,{x:n=bo,y:e=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=e?sa:aa;return pc(eu(t,u({x1:jp,x2:Bp},{x:n,y:e,stroke:i,strokeOpacity:a,...c})),kd(t,u({x1:"p25",x2:"p75"},{x:n,y:e,fill:r,fillOpacity:o,...c})),Cp(t,u({x:"p50"},{x:n,y:e,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),Cd(t,ip({x:Wp},{x:n,y:e,z:e,stroke:i,strokeOpacity:a,...c})))}function Ip(t,{y:n=bo,x:e=null,fill:r="#ccc",fillOpacity:o,stroke:i="currentColor",strokeOpacity:a,strokeWidth:l=2,sort:s,...c}={}){const u=null!=e?la:aa;return pc(nu(t,u({y1:jp,y2:Bp},{x:e,y:n,stroke:i,strokeOpacity:a,...c})),$d(t,u({y1:"p25",y2:"p75"},{x:e,y:n,fill:r,fillOpacity:o,...c})),Tp(t,u({y:"p50"},{x:e,y:n,stroke:i,strokeOpacity:a,strokeWidth:l,sort:s,...c})),Cd(t,ip({y:Wp},{x:e,y:n,z:e,stroke:i,strokeOpacity:a,...c})))}function Wp(t){const n=jp(t),e=Bp(t);return t.map((t=>t<n||t>e?t:NaN))}function jp(t){const n=2.5*Fp(t)-1.5*Dp(t);return ct(t,(t=>t>=n?t:NaN))}function Bp(t){const n=2.5*Dp(t)-1.5*Fp(t);return N(t,(t=>t<=n?t:NaN))}function Fp(t){return W(t,.25)}function Dp(t){return W(t,.75)}const qp={ariaLabel:"raster",stroke:null,pixelSize:1};function _p(t,n){const e=+t;if(isNaN(e))throw new Error(`invalid ${n}: ${t}`);return e}function Pp(t,n){const e=Math.floor(t);if(isNaN(e))throw new Error(`invalid ${n}: ${t}`);return e}class Vp extends dc{constructor(t,n,e={},r){let{width:o,height:i,x:a,y:l,x1:s=(null==a?0:void 0),y1:c=(null==l?0:void 0),x2:u=(null==a?o:void 0),y2:f=(null==l?i:void 0),pixelSize:h=r.pixelSize,blur:d=0,interpolate:p}=e;if(null!=o&&(o=Pp(o,"width")),null!=i&&(i=Pp(i,"height")),null!=s&&(s=_p(s,"x1")),null!=c&&(c=_p(c,"y1")),null!=u&&(u=_p(u,"x2")),null!=f&&(f=_p(f,"y2")),null==a&&(null==s||null==u))throw new Error("missing x");if(null==l&&(null==c||null==f))throw new Error("missing y");null!=t&&null!=o&&null!=i&&(void 0===a&&null!=s&&null!=u&&(a=function(t,n,e){return{transform(r){const o=r.length,i=new Float64Array(o),a=(n-t)/e,l=t+a/2;for(let t=0;t<o;++t)i[t]=t%e*a+l;return i}}}(s,u,o)),void 0===l&&null!=c&&null!=f&&(l=function(t,n,e,r){return{transform(o){const i=o.length,a=new Float64Array(i),l=(n-t)/r,s=t+l/2;for(let t=0;t<i;++t)a[t]=Math.floor(t/e)%r*l+s;return a}}}(c,f,o,i))),super(t,{x:{value:a,scale:"x",optional:!0},y:{value:l,scale:"y",optional:!0},x1:{value:null==s?null:[s],scale:"x",optional:!0,filter:null},y1:{value:null==c?null:[c],scale:"y",optional:!0,filter:null},x2:{value:null==u?null:[u],scale:"x",optional:!0,filter:null},y2:{value:null==f?null:[f],scale:"y",optional:!0,filter:null},...n},e,r),this.width=o,this.height=i,this.pixelSize=_p(h,"pixelSize"),this.blur=_p(d,"blur"),this.interpolate=null==a||null==l?null:function(t){if("function"==typeof t)return t;if(null==t)return Jp;switch(`${t}`.toLowerCase()){case"none":return Jp;case"nearest":return nm;case"barycentric":return Kp();case"random-walk":return em()}throw new Error(`invalid interpolate: ${t}`)}(p)}}class Hp extends Vp{constructor(t,n={}){const{imageRendering:e}=n;if(null==t){const{fill:t,fillOpacity:e}=n;void 0!==Wo(e)[0]&&(n=Zp("fillOpacity",n)),void 0!==Io(t)[0]&&(n=Zp("fill",n))}super(t,void 0,n,qp),this.imageRendering=lc(e,"auto")}scale(t,{color:n,...e},r){return super.scale(t,e,r)}render(t,n,e,r,o){const i=n[e.channels.fill?.scale]??(t=>t),{x:a,y:l}=e,{document:s}=o,[c,u,f,h]=Xp(e,r,o),d=f-c,p=h-u,{pixelSize:m,width:y=Math.round(Math.abs(d)/m),height:g=Math.round(Math.abs(p)/m)}=this,v=y*g;let{fill:x,fillOpacity:w}=e,b=0;if(this.interpolate){const n=y/d,e=g/p,r=Do(a,(t=>(t-c)*n),Float64Array),o=Do(l,(t=>(t-u)*e),Float64Array);x&&(x=this.interpolate(t,y,g,r,o,x)),w&&(w=this.interpolate(t,y,g,r,o,w))}else null==this.data&&t&&(b=t.fi*v);const k=s.createElement("canvas");k.width=y,k.height=g;const $=k.getContext("2d"),M=$.createImageData(y,g),L=M.data;let{r:A,g:E,b:z}=Be(this.fill)??{r:0,g:0,b:0},O=255*(this.fillOpacity??1);for(let t=0;t<v;++t){const n=t<<2;if(x){const e=i(x[t+b]);if(null==e){L[n+3]=0;continue}({r:A,g:E,b:z}=Be(e))}w&&(O=255*w[t+b]),L[n+0]=A,L[n+1]=E,L[n+2]=z,L[n+3]=O}return this.blur>0&&vr(M,this.blur),$.putImageData(M,0,0),Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((t=>t.append("image").attr("transform",`translate(${c},${u}) scale(${Math.sign(f-c)},${Math.sign(h-u)})`).attr("width",Math.abs(d)).attr("height",Math.abs(p)).attr("preserveAspectRatio","none").call(ic,"image-rendering",this.imageRendering).call(rc,this).attr("xlink:href",k.toDataURL()))).node()}}function Yp(t,n,e){arguments.length<3&&(e=n,n=null);let{x:r,y:o,[t]:i,...a}=e;return void 0===r&&void 0===o&&function(t){if(!mi(t))return!1;for(const n of t)if(null!=n)return"object"==typeof n&&"0"in n&&"1"in n}(n)&&(r=Ao,o=Eo,void 0===i&&(i=zo)),[n,{...a,x:r,y:o,[t]:i}]}function Up(){const[t,n]=Yp("fill",...arguments);return new Hp(t,null==t||void 0!==n.fill||void 0!==n.fillOpacity?n:{...n,fill:bo})}function Xp({x1:t,y1:n,x2:e,y2:r},o,{projection:i}){const{width:a,height:l,marginTop:s,marginRight:c,marginBottom:u,marginLeft:f}=o;return[t&&null==i?t[0]:f,n&&null==i?n[0]:s,e&&null==i?e[0]:a-c,r&&null==i?r[0]:l-u]}function Gp({x1:t,y1:n,x2:e,y2:r},o,i,a){const l={};return t&&(l.x1=t),n&&(l.y1=n),e&&(l.x2=e),r&&(l.y2=r),Xp(qa(l,o),i,a)}function Zp(t,n={}){const{[t]:e}=n;if("function"!=typeof e)throw new Error(`invalid ${t}: not a function`);return Ui({...n,[t]:void 0},(function(r,o,i,a,l,s){const{x:c,y:u}=a;if(!c)throw new Error("missing scale: x");if(!u)throw new Error("missing scale: y");const[f,h,d,p]=Gp(i,a,l,s),m=d-f,y=p-h,{pixelSize:g}=this,{width:v=Math.round(Math.abs(m)/g),height:x=Math.round(Math.abs(y)/g)}=n,w=new Array(v*x*(o?o.length:1)),b=m/v,k=y/x;let $=0;for(const t of o??[void 0])for(let n=.5;n<x;++n)for(let r=.5;r<v;++r,++$)w[$]=e(c.invert(f+r*b),u.invert(h+n*k),t);return{data:w,facets:o,channels:{[t]:{value:w,scale:"auto"}}}}))}function Jp(t,n,e,r,o,i){const a=new Array(n*e);for(const l of t)r[l]<0||r[l]>=n||o[l]<0||o[l]>=e||(a[Math.floor(o[l])*n+Math.floor(r[l])]=i[l]);return a}function Kp({random:t=Z(42)}={}){return(n,e,r,o,i,a)=>{const{points:l,triangles:s,hull:c}=xr.from(n,(t=>o[t]),(t=>i[t])),u=new a.constructor(e*r).fill(NaN),f=new Uint8Array(e*r),h=function(t,n){return bi(t)||vi(t)?rm:function(t){return(n,e,r,o,i,a,l,s)=>{const c=t(l,s);return c<e?n:c<e+o?r:i}}(n)}(a,t);for(let t=0;t<s.length;t+=3){const o=s[t],i=s[t+1],c=s[t+2],d=l[2*o],p=l[2*i],m=l[2*c],y=l[2*o+1],g=l[2*i+1],v=l[2*c+1],x=Math.min(d,p,m),w=Math.max(d,p,m),b=Math.min(y,g,v),k=Math.max(y,g,v),$=(g-v)*(d-m)+(y-v)*(m-p);if(!$)continue;const M=a[n[o]],L=a[n[i]],A=a[n[c]];for(let t=Math.floor(x);t<w;++t)for(let n=Math.floor(b);n<k;++n){if(t<0||t>=e||n<0||n>=r)continue;const o=t+.5,i=n+.5,a=Math.sign($),l=(g-v)*(o-m)+(i-v)*(m-p);if(l*a<0)continue;const s=(v-y)*(o-m)+(i-v)*(d-m);if(s*a<0)continue;const c=$-(l+s);if(c*a<0)continue;const x=t+e*n;u[x]=h(M,l/$,L,s/$,A,c/$,t,n),f[x]=1}}return function(t,n,e,r,o,i,a,l,s,c){e=Float64Array.from(l,(t=>e[s[t]])),r=Float64Array.from(l,(t=>r[s[t]])),o=Array.from(l,(t=>o[s[t]]));const u=e.length,f=Array.from({length:u},((t,n)=>function(t,n,e){const r=n.length,o=n.at(t-2),i=e.at(t-2),a=n.at(t-1),l=e.at(t-1),s=n[t],c=e[t],u=n.at(t+1-r),f=e.at(t+1-r),h=a-s,d=l-c,p=o-a,m=i-l,y=s-u,g=c-f,v=Math.hypot(h,d),x=Math.hypot(p,m),w=Math.hypot(y,g);return(t,n)=>{const e=t-a,r=n-l,o=t-s,i=n-c;return tm(e,r,o,i)>-1e-6&&tm(e,r,h,d)*x-tm(e,r,p,m)*v>-1e-6&&tm(o,i,y,g)*v-tm(o,i,h,d)*w<=0}}(n,e,r)));let h=0;for(let l=0;l<a;++l){const a=l+.5;for(let s=0;s<i;++s){const d=s+i*l;if(!n[d]){const n=s+.5;for(let i=0;i<u;++i){const p=(u+h+(i%2?(i+1)/2:-i/2))%u;if(f[p](n,a)){const i=Qp(e.at(p-1),r.at(p-1),e[p],r[p],n,a);t[d]=c(o.at(p-1),i,o[p],1-i,o[p],0,s,l),h=p;break}}}}}}(u,f,o,i,a,e,r,c,n,h),u}}function Qp(t,n,e,r,o,i){const a=e-t,l=r-n,s=a*(e-o)+l*(r-i),c=a*(o-t)+l*(i-n);return s>0&&c>0?s/(s+c):+(s>c)}function tm(t,n,e,r){return t*r-e*n}function nm(t,n,e,r,o,i){const a=new i.constructor(n*e),l=xr.from(t,(t=>r[t]),(t=>o[t]));let s,c;for(let r=.5,o=0;r<e;++r){c=s;for(let e=.5;e<n;++e,++o)c=l.find(e,r,c),.5===e&&(s=c),a[o]=i[t[c]]}return a}function em({random:t=Z(42),minDistance:n=.5,maxSteps:e=2}={}){return(r,o,i,a,l,s)=>{const c=new s.constructor(o*i),u=xr.from(r,(t=>a[t]),(t=>l[t]));let f,h,d;for(let p=.5,m=0;p<i;++p){h=f;for(let i=.5;i<o;++i,++m){let o,y=i,g=p;d=h=u.find(y,g,h),.5===i&&(f=h);let v=0;for(;(o=Math.hypot(a[r[d]]-y,l[r[d]]-g))>n&&v<e;){const n=2*t(i,p,v)*Math.PI;y+=Math.cos(n)*o,g+=Math.sin(n)*o,d=u.find(y,g,d),++v}c[m]=s[r[d]]}}return c}}function rm(t,n,e,r,o,i){return n*t+r*e+i*o}const om={ariaLabel:"contour",fill:"none",stroke:"currentColor",strokeMiterlimit:1,pixelSize:2};class im extends Vp{constructor(t,{smooth:n=!0,value:e,...r}={}){const o=Gs({},r,om);if(void 0===e)for(const t in o)if(null!=o[t].value){if(void 0!==e)throw new Error("ambiguous contour value");e=r[t],r[t]="value"}if(null!=e){const t={transform:t=>t.map((t=>t.value)),label:ai(e)};for(const n in o)"value"===r[n]&&(r[n]=t)}if(null==t){if(null==e)throw new Error("missing contour value");r=Zp("value",{value:e,...r}),e=null}else{let{interpolate:t}=r;void 0===e&&(e=bo),void 0===t&&(r.interpolate="nearest")}super(t,{value:{value:e,optional:!0}},function({thresholds:t,interval:n,...e}){return t=wh(t,n,ir),Ui(e,(function(n,e,r,o,i,a){const[l,s,c,u]=Gp(r,o,i,a),f=c-l,h=u-s,{pixelSize:d,width:p=Math.round(Math.abs(f)/d),height:m=Math.round(Math.abs(h)/d)}=this,y=p/f,g=m/h,v=r.value.value,x=[];if(this.interpolate){const{x:t,y:n}=Ts(r,o,a),i=Do(t,(t=>(t-l)*y),Float64Array),c=Do(n,(t=>(t-s)*g),Float64Array),u=[r.x,r.y,r.value],f=[i,c,v];for(const t of e){const n=this.filter(t,u,f);x.push(this.interpolate(n,p,m,i,c,v))}}else if(e){const t=p*m,n=e.length;for(let e=0;e<n;++e)x.push(v.slice(e*t,e*t+t))}else x.push(v);if(this.blur>0)for(const t of x)wr({data:t,width:p,height:m},this.blur);const w=function(t,n,e,r){if("function"==typeof t?.range)return t.range(t.floor(e),r);"function"==typeof t&&(t=t(n,e,r));if("number"!=typeof t)return Fo(t);const o=_n(...kr(e,r,t),t);for(;o[o.length-1]>=r;)o.pop();for(;o[1]<e;)o.shift();return o}(t,v,...function(t){return[ct(t,(t=>ct(t,lm))),N(t,(t=>N(t,lm)))]}(x));if(null===w)throw new Error(`unsupported thresholds: ${t}`);const{contour:b}=br().size([p,m]).smooth(this.smooth),k=[],$=[];for(const t of x)$.push(I(k.length,k.push(...Do(w,(n=>b(t,n))))));for(const{coordinates:t}of k)for(const n of t)for(const t of n)for(const n of t)n[0]=n[0]/y+l,n[1]=n[1]/g+s;return{data:k,facets:$,channels:Da(this.contourChannels,k)}}))}(r),om);const i={geometry:{value:bo}};for(const t in this.channels){const n=this.channels[t],{scale:e}=n;"x"!==e&&"y"!==e&&"value"!==t&&(i[t]=n,delete this.channels[t])}this.contourChannels=i,this.smooth=!!n}filter(t,{x:n,y:e,value:r,...o},i){return super.filter(t,o,i)}render(t,n,e,r,o){const{geometry:i}=e,a=pe();return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((n=>{n.selectAll().data(t).enter().append("path").call(rc,this).attr("d",(t=>a(i[t]))).call(Ks,this,e)})).node()}}function am(){return new im(...Yp("value",...arguments))}function lm(t){return isFinite(t)?t:NaN}function sm(t,n){return fm(kc,t,n)}function cm(t,n={}){return fm($c,t,n)}function um(t,n={}){return fm(Mc,t,n)}function fm(t,n,e={}){const{x:r,y:o,maxRadius:i}=e,a=t({px:r,py:o,maxRadius:i}),l=[];null!=r&&l.push(nu(n,pm("x",{...a,inset:-6},e))),null!=o&&l.push(eu(n,pm("y",{...a,inset:-6},e))),null!=r&&l.push(uu(n,mm("x",{...a,dy:9,frameAnchor:"bottom",lineAnchor:"top"},e))),null!=o&&l.push(uu(n,mm("y",{...a,dx:-9,frameAnchor:"left",textAnchor:"end"},e)));for(const t of l)t.ariaLabel=`crosshair ${t.ariaLabel}`;return pc(...l)}function hm(t,{channels:n,...e},{facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:s,transform:c,initializer:u}){return{...e,facet:r,facetAnchor:o,fx:i,fy:a,[t]:l,channels:{...n,...s},transform:c,initializer:dm(t,u)}}function dm(t,n){return null==n?n:function(e,r,{x:o,y:i,px:a,py:l,...s},...c){const{channels:{x:u,y:f,...h}={},...d}=n.call(this,e,r,{...s,x:a,y:l},...c);return{channels:{...h,...u&&{px:u,..."x"===t&&{x:u}},...f&&{py:f,..."y"===t&&{y:f}}},...d}}}function pm(t,n,e){const{color:r="currentColor",opacity:o=.2,ruleStroke:i=r,ruleStrokeOpacity:a=o,ruleStrokeWidth:l}=e;return{...hm(t,n,e),stroke:i,strokeOpacity:a,strokeWidth:l}}function mm(t,n,e){const{color:r="currentColor",textFill:o=r,textFillOpacity:i,textStroke:a="var(--plot-background)",textStrokeOpacity:l,textStrokeWidth:s=5}=e;return{...hm(t,n,ym(t,e)),fill:o,fillOpacity:i,stroke:a,strokeOpacity:l,strokeWidth:s}}function ym(t,n){return Ui(n,((n,e,r)=>({channels:{text:{value:Za(r,t)?.value}}})))}const gm={ariaLabel:"delaunay link",fill:"none",stroke:"currentColor",strokeMiterlimit:1},vm={ariaLabel:"delaunay mesh",fill:null,stroke:"currentColor",strokeOpacity:.2},xm={ariaLabel:"hull",fill:"none",stroke:"currentColor",strokeWidth:1.5,strokeMiterlimit:1},wm={ariaLabel:"voronoi",fill:"none",stroke:"currentColor",strokeMiterlimit:1},bm={ariaLabel:"voronoi mesh",fill:null,stroke:"currentColor",strokeOpacity:.2};class km extends dc{constructor(t,n={}){const{x:e,y:r,z:o,curve:i,tension:a}=n;super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},n,gm),this.curve=lh(i,a),Oc(this,n)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,{curve:u}=this,[f,h]=hc(this,r),d=l?t=>l[t]:Oo(f),p=s?t=>s[t]:Oo(h),m=this;function y(t){let n=-1;const r=[],i={};for(const t in e)i[t]=[];const a=[],l=[],s=[],c=[];function f(o,u){o=t[o],u=t[u],r.push(++n),a[n]=d(o),s[n]=p(o),l[n]=d(u),c[n]=p(u);for(const t in e)i[t].push(e[t][u])}const{halfedges:h,hull:y,triangles:g}=xr.from(t,d,p);for(let t=0;t<h.length;++t){const n=h[t];n>t&&f(g[t],g[n])}for(let t=0;t<y.length;++t)f(y[t],y[(t+1)%y.length]);Ne(this).selectAll().data(r).enter().append("path").call(rc,m).attr("d",(t=>{const n=je(),e=u(n);return e.lineStart(),e.point(a[t],s[t]),e.point(l[t],c[t]),e.lineEnd(),n})).call(Ks,m,i).call(jc,m,i,o)}return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(J(t,(t=>c[t])).values()).enter().append("g").each(y):n=>n.datum(t).each(y)).node()}}class $m extends dc{constructor(t,n={},e,r=(({z:t})=>t)){const{x:o,y:i}=n;super(t,{x:{value:o,scale:"x",optional:!0},y:{value:i,scale:"y",optional:!0},z:{value:r(n),optional:!0}},n,e)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,[u,f]=hc(this,r),h=l?t=>l[t]:Oo(u),d=s?t=>s[t]:Oo(f),p=this;function m(t){const n=xr.from(t,h,d);Ne(this).append("path").datum(t[0]).call(rc,p).attr("d",p._render(n,r)).call(Ks,p,e)}return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(J(t,(t=>c[t])).values()).enter().append("g").each(m):n=>n.datum(t).each(m)).node()}}class Mm extends $m{constructor(t,n={}){super(t,n,vm),this.fill="none"}_render(t){return t.render()}}class Lm extends $m{constructor(t,n={}){super(t,n,xm,Jo)}_render(t){return t.renderHull()}}class Am extends dc{constructor(t,n={}){const{x:e,y:r,z:o}=n;super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},z:{value:o,optional:!0}},n,wm)}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,z:c}=e,[u,f]=hc(this,r),h=l?t=>l[t]:Oo(u),d=s?t=>s[t]:Oo(f),p=this;function m(t){const n=zm(xr.from(t,h,d),r);Ne(this).selectAll().data(t).enter().append("path").call(rc,p).attr("d",((t,e)=>n.renderCell(e))).call(Ks,p,e)}return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i,y:s&&a}).call(c?n=>n.selectAll().data(J(t,(t=>c[t])).values()).enter().append("g").each(m):n=>n.datum(t).each(m)).node()}}class Em extends $m{constructor(t,n){super(t,n,bm),this.fill="none"}_render(t,n){return zm(t,n).render()}}function zm(t,n){const{width:e,height:r,marginTop:o,marginRight:i,marginBottom:a,marginLeft:l}=n;return t.voronoi([l,o,e-i,r-a])}function Om(t,n,{x:e,y:r,...o}={}){return[e,r]=Zo(e,r),new t(n,{...o,x:e,y:r})}function Sm(t,n){return Om(km,t,n)}function Nm(t,n){return Om(Mm,t,n)}function Cm(t,n){return Om(Lm,t,n)}function Tm(t,n){return Om(Am,t,n)}function Rm(t,n){return Om(Em,t,n)}const Im={ariaLabel:"density",fill:"none",stroke:"currentColor",strokeMiterlimit:1};class Wm extends dc{constructor(t,{x:n,y:e,z:r,weight:o,fill:i,stroke:a,...l}={}){const s=Fm(i)&&(i="currentColor",!0),c=Fm(a)&&(a="currentColor",!0);super(t,{x:{value:n,scale:"x",optional:!0},y:{value:e,scale:"y",optional:!0},z:{value:Jo({z:r,fill:i,stroke:a}),optional:!0},weight:{value:o,optional:!0}},function(t,n,e){const r=100;let{bandwidth:o,thresholds:i}=t;return o=void 0===o?20:+o,i=void 0===i?20:"function"==typeof i?.[Symbol.iterator]?No(i):+i,Ui(t,(function(t,a,l,s,c,u){const f=l.weight?No(l.weight.value):null,h=l.z?.value,{z:d}=this,[p,m]=hc(this,c),{width:y,height:g}=c,{x:v,y:x}=Ts(l,s,u),w=Object.fromEntries(Object.entries(l).filter((([t])=>!Bm.has(t))).map((([t,n])=>[t,{...n,value:[]}]))),b=n&&[],k=e&&[],$=$r().x(v?t=>v[t]:p).y(x?t=>x[t]:m).weight(f?t=>f[t]:1).size([y,g]).bandwidth(o),M=[];for(const t of a){const n=[];M.push(n);for(const e of h?tc(t,h,d):[t]){const t=$.contours(e);n.push([e,t])}}let L=i;if(!(L instanceof fo)){let t=0;for(const n of M)for(const[,e]of n){const n=e.max;n>t&&(t=n)}L=Float64Array.from({length:i-1},((n,e)=>t*r*(e+1)/i))}const A=[],E=[];for(const t of M){const n=[];A.push(n);for(const[e,o]of t)for(const t of L){n.push(E.length),E.push(o(t/r)),b&&b.push(t),k&&k.push(t);for(const t in w)w[t].value.push(l[t].value[e[0]])}}return b&&b.push(0),k&&k.push(0),{data:t,facets:A,channels:{...w,...b&&{fill:{value:b,scale:"color"}},...k&&{stroke:{value:k,scale:"color"}},contours:{value:E}}}}))}({...l,fill:i,stroke:a},s,c),Im),s&&(this.fill=void 0),c&&(this.stroke=void 0),this.z=r}filter(t){return t}render(t,n,e,r,o){const{contours:i}=e,a=pe();return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{}).call((n=>n.selectAll().data(t).enter().append("path").call(rc,this).call(Ks,this,e).attr("d",(t=>a(i[t]))))).node()}}function jm(t,{x:n,y:e,...r}={}){return[n,e]=Zo(n,e),new Wm(t,{...r,x:n,y:e})}const Bm=new Set(["x","y","z","weight"]);function Fm(t){return/^density$/i.test(t)}function Dm(t,{x1:n,x2:e,y1:r,y2:o,x:i=(void 0===n&&void 0===e?wo:void 0),y:a=(void 0===r&&void 0===o?bo:void 0),fill:l,positiveFill:s="#3ca951",negativeFill:c="#4269d0",fillOpacity:u=1,positiveFillOpacity:f=u,negativeFillOpacity:h=u,stroke:d,strokeOpacity:p,z:m=Io(d)[0],clip:y,tip:g,render:v,...x}={}){return[n,e]=qm(i,n,e),[r,o]=qm(a,r,o),n===e&&r===o&&(r=_m(0)),({tip:g}=gc({tip:g},"x")),pc(Ai(s)?null:Object.assign(ld(t,{x1:n,x2:e,y1:r,y2:o,z:m,fill:s,fillOpacity:f,render:mc(v,Pm(!0)),clip:y,...x}),{ariaLabel:"positive difference"}),Ai(c)?null:Object.assign(ld(t,{x1:n,x2:e,y1:r,y2:o,z:m,fill:c,fillOpacity:h,render:mc(v,Pm(!1)),clip:y,...x}),{ariaLabel:"negative difference"}),Fd(t,{x:e,y:o,z:m,stroke:d,strokeOpacity:p,tip:g,clip:!0,...x}))}function qm(t,n,e){return void 0===n&&void 0===e?n=e=_m(t):void 0===n?(e=_m(e),n=void 0===t?e:_m(t)):void 0===e?(n=_m(n),e=void 0===t?n:_m(t)):(n=_m(n),e=_m(e)),[n,e]}function _m(t){let n;const{value:e,label:r=ai(e)}=pi(t);return{transform:t=>n||(n=mo(t,e)),label:r}}function Pm(t){return(n,e,r,o,i,a)=>{const{x1:l,x2:s}=r,{height:c}=o,u=new Float32Array(l.length),f=new Float32Array(s.length);(t===Pl(e.y)<0?u:f).fill(c);const h=a(n,e,{...r,x2:l,y2:f},o,i),d=a(n,e,{...r,x1:s,y1:u},o,i),p=h.querySelector("g")??h,m=d.querySelector("g")??d;for(let t=0;p.firstChild;t+=2){const n=Xs(),e=Ws("svg:clipPath",i).attr("id",n).node();e.appendChild(p.firstChild),m.childNodes[t].setAttribute("clip-path",`url(#${n})`),m.insertBefore(e,m.childNodes[t])}return d}}const Vm={ariaLabel:"geo",fill:"none",stroke:"currentColor",strokeWidth:1,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class Hm extends dc{constructor(t,n={}){const[e,r]=Wo(n.r,3);super(t,{geometry:{value:n.geometry,scale:"projection"},r:{value:e,scale:"r",filter:Br,optional:!0}},Sd(n),Vm),this.r=r}render(t,n,e,r,o){const{geometry:i,r:a}=e,l=pe(o.projection??function({x:t,y:n}){if(t||n)return t??=t=>t,n??=t=>t,de({point(e,r){this.stream.point(t(e),n(r))}})}(n)),{r:s}=this;return Fr(s)?t=[]:void 0!==s&&l.pointRadius(s),Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((n=>{n.selectAll().data(t).enter().append("path").call(rc,this).attr("d",a?t=>l.pointRadius(a[t])(i[t]):t=>l(i[t])).call(Ks,this,e)})).node()}}function Ym(t,{geometry:n=bo,...e}={}){switch(t?.type){case"FeatureCollection":t=t.features;break;case"GeometryCollection":t=t.geometries;break;case"Feature":case"LineString":case"MultiLineString":case"MultiPoint":case"MultiPolygon":case"Point":case"Polygon":case"Sphere":t=[t]}return new Hm(t,{geometry:n,...e})}function Um({strokeWidth:t=1.5,...n}={}){return Ym({type:"Sphere"},{strokeWidth:t,...n})}function Xm({strokeOpacity:t=.1,...n}={}){return Ym(Mr(),{strokeOpacity:t,...n})}const Gm=.5,Zm=0;function Jm(t={fill:"count"},{binWidth:n,...e}={}){const{z:r}=e;return n=void 0===n?20:Lo(n),fa(t=va(t,e),"fill")&&(e.channels={...e.channels,fill:{value:[]}}),void 0===e.symbol&&(e.symbol="hexagon"),void 0!==e.r||fa(t,"r")||(e.r=n/2),Ui(e,((e,o,i,a,l,s)=>{let{x:c,y:u,z:f,fill:h,stroke:d,symbol:p}=i;if(void 0===c)throw new Error("missing channel: x");if(void 0===u)throw new Error("missing channel: y");({x:c,y:u}=Ts(i,a,s)),f=f?f.value:mo(e,r),h=h?.value,d=d?.value,p=p?.value;const m=$a(t,{z:f,fill:h,stroke:d,symbol:p}),y=f&&[],g=h&&[],v=d&&[],x=p&&[],w=[],b=[],k=[];let $=-1;for(const n of t)n.initialize(e);for(const r of o){const o=[];for(const n of t)n.scope("facet",r);for(const[i,a]of ma(r,m))for(const{index:r,extent:l}of Km(e,a,c,u,n)){o.push(++$),b.push(l.x),k.push(l.y),f&&y.push(m===f?i:f[r[0]]),h&&g.push(m===h?i:h[r[0]]),d&&v.push(m===d?i:d[r[0]]),p&&x.push(m===p?i:p[r[0]]);for(const n of t)n.reduce(r,l)}w.push(o)}const M=i.x.scale,L=i.y.scale;return{data:e,facets:w,channels:{x:{value:b,source:a[M]?{value:Do(b,a[M].invert),scale:M}:null},y:{value:k,source:a[L]?{value:Do(k,a[L].invert),scale:L}:null},...f&&{z:{value:y}},...h&&{fill:{value:g,scale:"auto"}},...d&&{stroke:{value:v,scale:"auto"}},...p&&{symbol:{value:x,scale:"auto"}},...Object.fromEntries(t.map((({name:t,output:e})=>[t,{scale:"auto",label:e.label,radius:"r"===t?n/2:void 0,value:e.transform()}])))}}}))}function Km(t,n,e,r,o){const i=o*(1.5/Di),a=new Map;for(const l of n){let n=e[l],s=r[l];if(isNaN(n)||isNaN(s))continue;let c=Math.round(s=(s-Zm)/i),u=Math.round(n=(n-Gm)/o-(1&c)/2),f=s-c;if(3*Math.abs(f)>1){let t=n-u,e=u+(n<u?-1:1)/2,r=c+(s<c?-1:1),o=n-e,i=s-r;t*t+f*f>o*o+i*i&&(u=e+(1&c?1:-1)/2,c=r)}const h=`${u},${c}`;let d=a.get(h);void 0===d&&(d={index:[],extent:{data:t,x:(u+(1&c)/2)*o+Gm,y:c*i+Zm}},a.set(h,d)),d.index.push(l)}return a.values()}const Qm={ariaLabel:"hexgrid",fill:"none",stroke:"currentColor",strokeOpacity:.1};function ty(t){return new ny(t)}class ny extends dc{constructor({binWidth:t=20,clip:n=!0,...e}={}){super(vo,void 0,{clip:n,...e},Qm),this.binWidth=Lo(t)}render(t,n,e,r,o){const{binWidth:i}=this,{marginTop:a,marginRight:l,marginBottom:s,marginLeft:c,width:u,height:f}=r,h=c-Gm,d=u-l-Gm,p=a-Zm,m=f-s-Zm,y=i/2,g=y*qi,v=g/2,x=2*y,w=1.5*g,b=Math.floor(h/x),k=Math.ceil(d/x),$=Math.floor((p+v)/w),M=Math.ceil((m-v)/w)+1,L=`m0,${ey(-g)}l${ey(y)},${ey(v)}v${ey(g)}l${ey(-y)},${ey(v)}`;let A=L;for(let t=$;t<M;++t)for(let n=b;n<k;++n)A+=`M${ey(n*x+(1&t)*y)},${ey(t*w)}${L}`;return Ws("svg:g",o).datum(0).call(ec,this,r,o).call(ac,this,{},Ys+Gm,Ys+Zm).call((t=>t.append("path").call(rc,this).call(Ks,this,e).attr("d",A))).node()}}function ey(t){return Math.round(1e3*t)/1e3}const ry={ariaLabel:"image",fill:null,stroke:null};class oy extends dc{constructor(t,n={}){let{x:e,y:r,r:o,width:i,height:a,rotate:l,src:s,preserveAspectRatio:c,crossOrigin:u,frameAnchor:f,imageRendering:h}=n;null==o&&(o=void 0),void 0===o&&void 0===i&&void 0===a?i=a=16:void 0===i&&void 0!==a?i=a:void 0===a&&void 0!==i&&(a=i);const[d,p]="string"==typeof(m=s)&&(function(t){return/^\.*\//.test(t)}(m)||function(t){return/^(blob|data|file|http|https):/i.test(t)}(m))?[void 0,m]:[m,void 0];var m;const[y,g]=Wo(o),[v,x]=Wo(i,void 0!==g?2*g:void 0),[w,b]=Wo(a,void 0!==g?2*g:void 0),[k,$]=Wo(l,0);super(t,{x:{value:e,scale:"x",optional:!0},y:{value:r,scale:"y",optional:!0},r:{value:y,scale:"r",filter:Br,optional:!0},width:{value:v,filter:Br,optional:!0},height:{value:w,filter:Br,optional:!0},rotate:{value:k,optional:!0},src:{value:d,optional:!0}},Sd(n),ry),this.src=p,this.width=x,this.rotate=$,this.height=b,this.r=g,this.preserveAspectRatio=lc(c,"xMidYMid"),this.crossOrigin=Mo(u),this.frameAnchor=Oi(f),this.imageRendering=lc(h,"auto")}render(t,n,e,r,o){const{x:i,y:a}=n,{x:l,y:s,width:c,height:u,r:f,rotate:h,src:d}=e,{r:p,width:m,height:y,rotate:g}=this,[v,x]=hc(this,r);return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,{x:l&&i,y:s&&a}).call((n=>n.selectAll().data(t).enter().append("image").call(rc,this).attr("x",iy(l,c,f,v,m,p)).attr("y",iy(s,u,f,x,y,p)).attr("width",c?t=>c[t]:void 0!==m?m:f?t=>2*f[t]:2*p).attr("height",u?t=>u[t]:void 0!==y?y:f?t=>2*f[t]:2*p).attr("transform",h?t=>`rotate(${h[t]})`:g?`rotate(${g})`:null).attr("transform-origin",h||g?ou`${l?t=>l[t]:v}px ${s?t=>s[t]:x}px`:null).call(ic,"href",d?t=>d[t]:this.src).call(ic,"preserveAspectRatio",this.preserveAspectRatio).call(ic,"crossorigin",this.crossOrigin).call(ic,"image-rendering",this.imageRendering).call(ic,"clip-path",f?t=>`circle(${f[t]}px)`:void 0!==p?`circle(${p}px)`:null).call(Ks,this,e))).node()}}function iy(t,n,e,r,o,i){return n&&t?e=>t[e]-n[e]/2:n?t=>r-n[t]/2:t&&void 0!==o?n=>t[n]-o/2:void 0!==o?r-o/2:e&&t?n=>t[n]-e[n]:e?t=>r-e[t]:t?n=>t[n]-i:r-i}function ay(t,{x:n,y:e,...r}={}){return void 0===r.frameAnchor&&([n,e]=Zo(n,e)),new oy(t,{...r,x:n,y:e})}function ly(t,n,e){var r=0===t||1===t?0:Math.exp(cy(n+e)-cy(n)-cy(e)+n*Math.log(t)+e*Math.log(1-t));return!(t<0||t>1)&&(t<(n+1)/(n+e+2)?r*sy(t,n,e)/n:1-r*sy(1-t,e,n)/e)}function sy(t,n,e){var r,o,i,a,l=1e-30,s=1,c=n+e,u=n+1,f=n-1,h=1,d=1-c*t/u;for(Math.abs(d)<l&&(d=l),a=d=1/d;s<=100&&(d=1+(o=s*(e-s)*t/((f+(r=2*s))*(n+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=(d=1/d)*h,d=1+(o=-(n+s)*(c+s)*t/((n+r)*(u+r)))*d,Math.abs(d)<l&&(d=l),h=1+o/h,Math.abs(h)<l&&(h=l),a*=i=(d=1/d)*h,!(Math.abs(i-1)<3e-7));s++);return a}function cy(t){var n,e,r,o=0,i=[76.18009172947146,-86.5053203294167,24.01409824083091,-1.231739572450155,.001208650973866179,-5395239384953e-18],a=1.000000000190015;for(r=(e=n=t)+5.5,r-=(n+.5)*Math.log(r);o<6;o++)a+=i[o]/++e;return Math.log(2.506628274631*a/n)-r}function uy(t,n){var e=function(t,n,e){var r,o,i,a,l,s,c,u,f,h,d=n-1,p=e-1,m=0;if(t<=0)return 0;if(t>=1)return 1;for(n>=1&&e>=1?(i=t<.5?t:1-t,s=(2.30753+.27061*(a=Math.sqrt(-2*Math.log(i))))/(1+a*(.99229+.04481*a))-a,t<.5&&(s=-s),c=(s*s-3)/6,u=2/(1/(2*n-1)+1/(2*e-1)),f=s*Math.sqrt(c+u)/u-(1/(2*e-1)-1/(2*n-1))*(c+5/6-2/(3*u)),s=n/(n+e*Math.exp(2*f))):(r=Math.log(n/(n+e)),o=Math.log(e/(n+e)),s=t<(a=Math.exp(n*r)/n)/(f=a+(l=Math.exp(e*o)/e))?Math.pow(n*f*t,1/n):1-Math.pow(e*f*(1-t),1/e)),h=-cy(n)-cy(e)+cy(n+e);m<10;m++){if(0===s||1===s)return s;if((s-=a=(l=(ly(s,n,e)-t)/(a=Math.exp(d*Math.log(s)+p*Math.log(1-s)+h)))/(1-.5*Math.min(1,l*(d/s-p/(1-s)))))<=0&&(s=.5*(s+a)),s>=1&&(s=.5*(s+a+1)),Math.abs(a)<1e-8*s&&m>0)break}return s}(2*Math.min(t,1-t),.5*n,.5);return e=Math.sqrt(n*(1-e)/e),t>.5?e:-e}const fy={ariaLabel:"linear-regression",fill:"currentColor",fillOpacity:.1,stroke:"currentColor",strokeWidth:1.5,strokeLinecap:"round",strokeLinejoin:"round",strokeMiterlimit:1};class hy extends dc{constructor(t,n={}){const{x:e,y:r,z:o,ci:i=.95,precision:a=4}=n;if(super(t,{x:{value:e,scale:"x"},y:{value:r,scale:"y"},z:{value:Jo(n),optional:!0}},n,fy),this.z=o,this.ci=+i,this.precision=+a,!(0<=this.ci&&this.ci<1))throw new Error(`invalid ci; not in [0, 1): ${i}`);if(!(this.precision>0))throw new Error(`invalid precision: ${a}`)}render(t,n,e,r,o){const{x:i,y:a,z:l}=e,{ci:s}=this;return Ws("svg:g",o).call(ec,this,r,o).call(ac,this,n).call((n=>n.selectAll().data(l?tc(t,l,this.z):[t]).enter().call((t=>t.append("path").attr("fill","none").call(rc,this).call(Qs,this,{...e,fill:null,fillOpacity:null}).attr("d",(t=>this._renderLine(t,i,a))).call(s&&!Ei(this.fill)?t=>t.select(dy).attr("stroke","none").call(rc,this).call(Qs,this,{...e,stroke:null,strokeOpacity:null,strokeWidth:null}).attr("d",(t=>this._renderBand(t,i,a))):()=>{}))))).node()}}function dy(){return this.parentNode.insertBefore(this.ownerDocument.createElementNS(Te.svg,"path"),this)}class py extends hy{constructor(t,n){super(t,n)}_renderBand(t,n,e){const{ci:r,precision:o}=this,[i,a]=qn(t,(t=>e[t])),l=vy(t,e,n),s=xy(t,e,n,(1-r)/2,l);return pr().y((t=>t)).x0((t=>s(t,-1))).x1((t=>s(t,1)))(I(i,a-o/2,o).concat(a))}_renderLine(t,n,e){const[r,o]=qn(t,(t=>e[t])),i=vy(t,e,n);return`M${i(r)},${r}L${i(o)},${o}`}}class my extends hy{constructor(t,n){super(t,n)}_renderBand(t,n,e){const{ci:r,precision:o}=this,[i,a]=qn(t,(t=>n[t])),l=vy(t,n,e),s=xy(t,n,e,(1-r)/2,l);return pr().x((t=>t)).y0((t=>s(t,-1))).y1((t=>s(t,1)))(I(i,a-o/2,o).concat(a))}_renderLine(t,n,e){const[r,o]=qn(t,(t=>n[t])),i=vy(t,n,e);return`M${r},${i(r)}L${o},${i(o)}`}}function yy(t,{y:n=wo,x:e=bo,stroke:r,fill:o=(Ai(r)?"currentColor":r),...i}={}){return new py(t,mh({...i,x:e,y:n,fill:o,stroke:r}))}function gy(t,{x:n=wo,y:e=bo,stroke:r,fill:o=(Ai(r)?"currentColor":r),...i}={}){return new my(t,ph({...i,x:n,y:e,fill:o,stroke:r}))}function vy(t,n,e){let r=0,o=0,i=0,a=0;for(const l of t){const t=n[l],s=e[l];r+=t,o+=s,i+=t*s,a+=t*t}const l=t.length,s=(l*i-r*o)/(l*a-r*r),c=(o-s*r)/l;return t=>s*t+c}function xy(t,n,e,r,o){const i=tt(t,(t=>n[t]))/t.length;let a=0,l=0;for(const r of t)a+=(n[r]-i)**2,l+=(e[r]-o(n[r]))**2;const s=Math.sqrt(l/(t.length-2)),c=uy(r,t.length-2);return(n,e)=>{const r=o(n),l=s*Math.sqrt(1/t.length+(n-i)**2/a);return r+e*c*l}}function wy({path:t=bo,delimiter:n,frameAnchor:e,treeLayout:r=Ar,treeSort:o,treeSeparation:i,treeAnchor:a,treeFilter:l,...s}={}){a=ky(a),o=Ly(o),null!=l&&(l=Ny(l)),void 0===e&&(e=a.frameAnchor);const c=Ey(n),u=Vy(s,Ny),[f,h]=oi(),[d,p]=oi();return{x:f,y:d,frameAnchor:e,...Yi(s,((n,e)=>{const s=c(mo(n,t)),f=h([]),d=p([]);let m=-1;const y=[],g=[],v=Lr().path((t=>s[t])),x=r();x.nodeSize&&x.nodeSize([1,1]),x.separation&&void 0!==i&&x.separation(i??ko);for(const t of u)t[Py]=t[qy]([]);for(const t of e){const e=[],r=v(t.filter((t=>null!=s[t]))).each((t=>t.data=n[t.data]));null!=o&&r.sort(o),x(r);for(const t of r.descendants())if(null==l||l(t)){e.push(++m),y[m]=t.data,a.position(t,m,f,d);for(const n of u)n[Py][m]=n[_y](t)}g.push(e)}return{data:y,facets:g}})),...Object.fromEntries(u)}}function by({path:t=bo,delimiter:n,curve:e="bump-x",stroke:r="#555",strokeWidth:o=1.5,strokeOpacity:i=.5,treeLayout:a=Ar,treeSort:l,treeSeparation:s,treeAnchor:c,treeFilter:u,...f}={}){c=ky(c),l=Ly(l),null!=u&&(u=Cy(u)),f={curve:e,stroke:r,strokeWidth:o,strokeOpacity:i,...f};const h=Ey(n),d=Vy(f,Cy),[p,m]=oi(),[y,g]=oi(),[v,x]=oi(),[w,b]=oi();return{x1:p,x2:y,y1:v,y2:w,...Yi(f,((n,e)=>{const r=h(mo(n,t)),o=m([]),i=g([]),f=x([]),p=b([]);let y=-1;const v=[],w=[],k=Lr().path((t=>r[t])),$=a();$.nodeSize&&$.nodeSize([1,1]),$.separation&&void 0!==s&&$.separation(s??ko);for(const t of d)t[Py]=t[qy]([]);for(const t of e){const e=[],a=k(t.filter((t=>null!=r[t]))).each((t=>t.data=n[t.data]));null!=l&&a.sort(l),$(a);for(const{source:t,target:n}of a.links())if(null==u||u(n,t)){e.push(++y),v[y]=n.data,c.position(t,y,o,f),c.position(n,y,i,p);for(const e of d)e[Py][y]=e[_y](n,t)}w.push(e)}return{data:v,facets:w}})),...Object.fromEntries(d)}}function ky(t="left"){switch(`${t}`.trim().toLowerCase()){case"left":return $y;case"right":return My}throw new Error(`invalid tree anchor: ${t}`)}const $y={frameAnchor:"left",dx:6,position({x:t,y:n},e,r,o){r[e]=n,o[e]=-t}},My={frameAnchor:"right",dx:-6,position({x:t,y:n},e,r,o){r[e]=-n,o[e]=-t}};function Ly(t){return null==t||"function"==typeof t?t:`${t}`.trim().toLowerCase().startsWith("node:")?Ay(Ny(t)):Ay(function(t){return n=>n.data?.[t]}(t))}function Ay(t){return(n,e)=>Rr(t(n),t(e))}function Ey(t="/"){if("/"===(t=`${t}`))return t=>t;if(1!==t.length)throw new Error("delimiter must be exactly one character");const n=t.charCodeAt(0);return t=>t.map((t=>function(t,n){if(n===zy)throw new Error("delimiter cannot be backslash");let e=!1;for(let r=0,o=t.length;r<o;++r){switch(t.charCodeAt(r)){case zy:if(!e){e=!0;continue}break;case n:e?(t=t.slice(0,r-1)+t.slice(r),--r,--o):t=t.slice(0,r)+"/"+t.slice(r+1);break;case Oy:e?(t=t.slice(0,r)+"\\\\"+t.slice(r),r+=2,o+=2):(t=t.slice(0,r)+"\\"+t.slice(r),++r,++o)}e=!1}return t}(t,n)))}const zy=92,Oy=47;function Sy(t){return Ho(t)&&"function"==typeof t.node}function Ny(t){if(Sy(t))return t.node;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")){switch(t){case"node:name":return Ry;case"node:path":return Ty;case"node:internal":return jy;case"node:external":return By;case"node:depth":return Iy;case"node:height":return Wy}throw new Error(`invalid node value: ${t}`)}}function Cy(t){if(Sy(t))return t.node;if(Ho(n=t)&&"function"==typeof n.link)return t.link;var n;if((t=`${t}`.trim().toLowerCase()).startsWith("node:")||t.startsWith("parent:")){switch(t){case"parent:name":return Fy(Ry);case"parent:path":return Fy(Ty);case"parent:depth":return Fy(Iy);case"parent:height":return Fy(Wy);case"node:name":return Ry;case"node:path":return Ty;case"node:internal":return jy;case"node:external":return By;case"node:depth":return Iy;case"node:height":return Wy}throw new Error(`invalid link value: ${t}`)}}function Ty(t){return t.id}function Ry(t){return function(t){let n=t.length;for(;--n>0&&!Dy(t,n););return function(t){let n=!1;for(let e=0,r=t.length;e<r;++e){switch(t.charCodeAt(e)){case zy:if(!n){n=!0;continue}case Oy:n&&(t=t.slice(0,e-1)+t.slice(e),--e,--r)}n=!1}return t}(t.slice(n+1))}(t.id)}function Iy(t){return t.depth}function Wy(t){return t.height}function jy(t){return!!t.children}function By(t){return!t.children}function Fy(t){return(n,e)=>null==e?void 0:t(e)}function Dy(t,n){if("/"===t[n]){let e=0;for(;n>0&&"\\"===t[--n];)++e;if(0==(1&e))return!0}return!1}const qy=2,_y=3,Py=4;function Vy(t,n){const e=[];for(const r in t){const o=t[r],i=n(o);void 0!==i&&e.push([r,...oi(o),i])}return e}function Hy(t,{fill:n,stroke:e,strokeWidth:r,strokeOpacity:o,strokeLinejoin:i,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:c,marker:u,markerStart:f=u,markerEnd:h=u,dot:d=Ai(f)&&Ai(h),text:p="node:name",textStroke:m="var(--plot-background)",title:y="node:path",dx:g,dy:v,textAnchor:x,treeLayout:w=Ar,textLayout:b=(w===Ar||w===Er?"mirrored":"normal"),tip:k,...$}={}){if(void 0===g&&(g=ky($.treeAnchor).dx),void 0!==x)throw new Error("textAnchor is not a configurable tree option");function M(e){return uu(t,wy({treeLayout:w,text:p,fill:void 0===n?"currentColor":n,stroke:m,dx:g,dy:v,title:y,...e,...$}))}return b=Bo(b,"textLayout",["mirrored","normal"]),pc(hd(t,by({treeLayout:w,markerStart:f,markerEnd:h,stroke:void 0!==e?e:void 0===n?"node:internal":n,strokeWidth:r,strokeOpacity:o,strokeLinejoin:i,strokeLinecap:a,strokeMiterlimit:l,strokeDasharray:s,strokeDashoffset:c,...$})),d?Cd(t,wy({treeLayout:w,fill:void 0===n?"node:internal":n,title:y,tip:k,...$})):null,null!=p?"mirrored"===b?[M({textAnchor:"start",treeFilter:"node:external"}),M({textAnchor:"end",treeFilter:"node:internal",dx:-g})]:M():null)}function Yy(t,n){return Hy(t,{...n,treeLayout:Er})}function Uy({geometry:t=bo,...n}={}){return Ui({...n,x:null,y:null},((n,e,r,o,i,{projection:a})=>{const l=mo(n,t),s=l.length,c=new Float64Array(s),u=new Float64Array(s),f=pe(a);for(let t=0;t<s;++t)[c[t],u[t]]=f.centroid(l[t]);return{data:n,facets:e,channels:{x:{value:c,scale:null==a?"x":null,source:null},y:{value:u,scale:null==a?"y":null,source:null}}}}))}function Xy({geometry:t=bo,...n}={}){let e;return{...n,x:{transform:n=>Float64Array.from(e=mo(mo(n,t),zr),(([t])=>t))},y:{transform:()=>Float64Array.from(e,(([,t])=>t))}}}const Gy=({marginLeft:t})=>[1,t],Zy=({width:t,marginRight:n})=>[-1,t-n],Jy=({width:t,marginLeft:n,marginRight:e})=>[0,(n+t-e)/2],Ky=({marginTop:t})=>[1,t],Qy=({height:t,marginBottom:n})=>[-1,t-n],tg=({height:t,marginTop:n,marginBottom:e})=>[0,(n+t-e)/2];function ng(t){return"string"==typeof t?{anchor:t}:t}function eg(t={},n={}){1===arguments.length&&([t,n]=og(t));let{anchor:e="left",padding:r=1,r:o=n.r}=ng(t);switch(`${e}`.toLowerCase()){case"left":e=Gy;break;case"right":e=Zy;break;case"middle":e=Jy;break;default:throw new Error(`unknown dodge anchor: ${e}`)}return ig("x","y",e,Lo(r),o,n)}function rg(t={},n={}){1===arguments.length&&([t,n]=og(t));let{anchor:e="bottom",padding:r=1,r:o=n.r}=ng(t);switch(`${e}`.toLowerCase()){case"top":e=Ky;break;case"bottom":e=Qy;break;case"middle":e=tg;break;default:throw new Error(`unknown dodge anchor: ${e}`)}return ig("y","x",e,Lo(r),o,n)}function og(t){const{anchor:n,padding:e,...r}=t,{r:o}=r;return[{anchor:n,padding:e,r:o},r]}function ig(t,n,e,r,o,i){if(null!=o&&"number"!=typeof o){let{channels:t,sort:n,reverse:e}=i;t=Si(t),void 0===t?.r&&(i={...i,channels:{...t,r:{value:o,scale:"r"}}}),void 0===n&&void 0===e&&(i.sort={channel:"-r"})}return Ui(i,(function(i,a,l,s,c,u){let{[n]:f,r:h}=l;if(!l[n])throw new Error(`missing channel: ${n}`);({[n]:f}=Ts(l,s,u));const d=h?void 0:void 0!==o?Lo(o):void 0!==this.r?this.r:3;h&&(h=mo(h.value,s[h.scale]||bo,Float64Array));let[p,m]=e(c);const y=p?lg:ag,g=new Float64Array(f.length),v=h?t=>h[t]:()=>d;for(let t of a){const n=Cr();t=t.filter(h?t=>jr(f[t])&&Br(h[t]):t=>jr(f[t]));const e=new Float64Array(2*t.length+2);for(const o of t){const t=v(o),i=p?t+r:0,a=f[o]-t,l=f[o]+t;let s=2;n.queryInterval(a-r,l+r,(([,,t])=>{const n=g[t]-i,a=f[o]-f[t],l=r+(h?h[o]+h[t]:2*d),c=Math.sqrt(l*l-a*a);e[s++]=n-c,e[s++]=n+c}));let c=e.slice(0,s);p&&(c=c.filter((t=>t>=0)));t:for(const t of c.sort(y)){for(let n=0;n<s;n+=2)if(e[n]+1e-6<t&&t<e[n+1]-1e-6)continue t;g[o]=t+i;break}n.insert([a,l,o])}}p||(p=1);for(const t of a)for(const n of t)g[n]=g[n]*p+m;return{data:i,facets:a,channels:{[t]:{value:g,source:null},[n]:{value:f,source:l[n]},...h&&{r:{value:h,source:l.r}}}}}))}function ag(t,n){return Math.abs(t)-Math.abs(n)}function lg(t,n){return t-n}function sg(t,n){return 1===arguments.length&&({basis:t,...n}=t),rp(ug(t),n)}function cg(t,n){return 1===arguments.length&&({basis:t,...n}=t),op(ug(t),n)}function ug(t){if(void 0===t)return pg;if("function"==typeof t)return fg(ti(t));if(/^p\d{2}$/i.test(t))return hg(So(t));switch(`${t}`.toLowerCase()){case"deviation":return yg;case"first":return pg;case"last":return mg;case"max":return gg;case"mean":return vg;case"median":return xg;case"min":return wg;case"sum":return bg;case"extent":return dg}throw new Error(`invalid basis: ${t}`)}function fg(t){return{mapIndex(n,e,r){const o=+t(n,e);for(const t of n)r[t]=null===e[t]?NaN:e[t]/o}}}function hg(t){return fg(((n,e)=>t(n,(t=>e[t]))))}const dg={mapIndex(t,n,e){const[r,o]=qn(t,(t=>n[t])),i=o-r;for(const o of t)e[o]=null===n[o]?NaN:(n[o]-r)/i}},pg=fg(((t,n)=>{for(let e=0;e<t.length;++e){const r=n[t[e]];if(Tr(r))return r}})),mg=fg(((t,n)=>{for(let e=t.length-1;e>=0;--e){const r=n[t[e]];if(Tr(r))return r}})),yg={mapIndex(t,n,e){const r=at(t,(t=>n[t])),o=ut(t,(t=>n[t]));for(const i of t)e[i]=null===n[i]?NaN:o?(n[i]-r)/o:0}},gg=hg(N),vg=hg(at),xg=hg(ot),wg=hg(ct),bg=hg(tt);function kg(t,n){return function(t,n,e={}){let r,o=1;if("number"==typeof n)o=n,r=(t,n)=>+t+n;else{if("string"==typeof n){const t=n.startsWith("-")?-1:1;[n,o]=ro(n.replace(/^[+-]/,"")),o*=t}n=ui(n),r=(t,e)=>n.offset(t,e)}const i=`${t}2`,a=ip({[`${t}1`]:t=>t.map((t=>r(t,o))),[i]:t=>t},e),l=a[i].transform;return a[i].transform=()=>{const t=l(),[n,e]=qn(t);return t.domain=o<0?[n,r(e,o)]:[r(n,o),e],t},a}("x",t,n)}function $g(t,n={}){if("string"==typeof t)switch(t.toLowerCase()){case"first":return Lg(n);case"last":return Ag(n)}if("function"==typeof t)return Ig(null,t,n);let e,r;for(e in t){if(void 0!==r)throw new Error("ambiguous selector; multiple inputs");r=Mg(t[e])}if(void 0===r)throw new Error(`invalid selector: ${t}`);return Ig(e,r,n)}function Mg(t){if("function"==typeof t)return t;switch(`${t}`.toLowerCase()){case"min":return Tg;case"max":return Rg}throw new Error(`unknown selector: ${t}`)}function Lg(t){return Ig(null,Ng,t)}function Ag(t){return Ig(null,Cg,t)}function Eg(t){return Ig("x",Tg,t)}function zg(t){return Ig("y",Tg,t)}function Og(t){return Ig("x",Rg,t)}function Sg(t){return Ig("y",Rg,t)}function*Ng(t){yield t[0]}function*Cg(t){yield t[t.length-1]}function*Tg(t,n){yield Or(t,(t=>n[t]))}function*Rg(t,n){yield dr(t,(t=>n[t]))}function Ig(t,n,e){if(null!=t){if(null==e[t])throw new Error(`missing channel: ${t}`);t=e[t]}const r=Jo(e);return Yi(e,((e,o)=>{const i=mo(e,r),a=mo(e,t),l=[];for(const t of o){const e=[];for(const r of i?J(t,(t=>i[t])).values():[t])for(const t of n(r,a))e.push(t);l.push(e)}return{data:e,facets:l}}))}dc.prototype.plot=function({marks:t=[],...n}={}){return _f({...n,marks:[...t,this]})};export{ad as Area,md as Arrow,wd as BarX,bd as BarY,Ld as Cell,im as Contour,Wm as Density,Nd as Dot,Of as Frame,Hm as Geo,ny as Hexgrid,oy as Image,Bd as Line,fd as Link,dc as Mark,Hp as Raster,Pd as Rect,Qc as RuleX,tu as RuleY,lu as Text,Sp as TickX,Np as TickY,Tf as Tip,Wu as Vector,ld as area,sd as areaX,cd as areaY,gd as arrow,Xd as auto,Ud as autoSpec,Zu as axisFx,Xu as axisFy,Gu as axisX,Uu as axisY,kd as barX,$d as barY,hh as bin,uh as binX,fh as binY,Ep as bollinger,Lp as bollingerX,Ap as bollingerY,Rp as boxX,Ip as boxY,Ad as cell,Ed as cellX,zd as cellY,Uy as centroid,Id as circle,Yy as cluster,oi as column,am as contour,sm as crosshair,cm as crosshairX,um as crosshairY,Sm as delaunayLink,Nm as delaunayMesh,jm as density,Dm as differenceY,eg as dodgeX,rg as dodgeY,Cd as dot,Td as dotX,Rd as dotY,Ji as filter,Ba as find,Vs as formatIsoDate,_s as formatMonth,qs as formatNumber,Ps as formatWeekday,Sf as frame,Ym as geo,Xy as geoCentroid,Xm as graticule,ef as gridFx,tf as gridFy,nf as gridX,Qu as gridY,ca as group,la as groupX,sa as groupY,aa as groupZ,Wd as hexagon,Jm as hexbin,ty as hexgrid,Cm as hull,bo as identity,ay as image,wo as indexOf,Ui as initializer,nm as interpolateNearest,Jp as interpolateNone,Kp as interpolatorBarycentric,em as interpolatorRandomWalk,$f as legend,Fd as line,Dd as lineX,qd as lineY,yy as linearRegressionX,gy as linearRegressionY,hd as link,ip as map,rp as mapX,op as mapY,pc as marks,ug as normalize,sg as normalizeX,cg as normalizeY,fi as numberInterval,_f as plot,kc as pointer,$c as pointerX,Mc as pointerY,Up as raster,Vd as rect,Hd as rectX,Yd as rectY,Qi as reverse,nu as ruleX,eu as ruleY,ls as scale,$g as select,Lg as selectFirst,Ag as selectLast,Og as selectMaxX,Sg as selectMaxY,Eg as selectMinX,zg as selectMinY,kg as shiftX,na as shuffle,ea as sort,Um as sphere,Du as spike,Bh as stackX,Fh as stackX1,Dh as stackX2,qh as stackY,_h as stackY1,Ph as stackY2,uu as text,fu as textX,hu as textY,Cp as tickX,Tp as tickY,oo as timeInterval,Rf as tip,Yi as transform,Hy as tree,by as treeLink,wy as treeNode,io as utcInterval,mo as valueof,ju as vector,Bu as vectorX,Fu as vectorY,Tm as voronoi,Rm as voronoiMesh,fp as window,cp as windowX,up as windowY};export default null;
